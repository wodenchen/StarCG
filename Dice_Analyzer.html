<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éª°å¯¶è¶¨å‹¢åˆ†æå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
            font-size: 18px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            color: #ffd700;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card h2 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 10px;
        }

        /* è¼¸å…¥å€åŸŸ */
        .input-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
        }

        .dice-input {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dice-input label {
            font-weight: bold;
            color: #ffd700;
        }

        .dice-input input {
            width: 70px;
            height: 55px;
            font-size: 1.7rem;
            text-align: center;
            border: 2px solid #ffd700;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
        }

        .dice-input input:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .btn {
            padding: 14px 28px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            color: #1a1a2e;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff4757, #ff3838);
            color: #fff;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 71, 87, 0.4);
        }

        /* ç•¶å‰çµæœé¡¯ç¤º */
        .current-result {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .dice-display {
            width: 60px;
            height: 60px;
            background: #fff;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: #1a1a2e;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .result-type {
            font-size: 1.8rem;
            font-weight: bold;
            padding: 10px 30px;
            border-radius: 10px;
        }

        .result-big {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: #fff;
        }

        .result-small {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: #fff;
        }

        .result-triple {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            color: #1a1a2e;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* æ­·å²è¨˜éŒ„è¡¨æ ¼ */
        .history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.05rem;
        }

        .history-table th,
        .history-table td {
            padding: 10px 6px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-table th {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
        }

        .history-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .history-container {
            max-height: 350px;
            overflow-y: auto;
        }

        .badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.95rem;
            font-weight: bold;
        }

        .badge-big { background: #e74c3c; }
        .badge-small { background: #3498db; }
        .badge-triple { background: #ffd700; color: #1a1a2e; }

        /* çµ±è¨ˆå€åŸŸ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 18px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #aaa;
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .stat-card .percentage {
            font-size: 1rem;
            color: #888;
        }

        /* è¶¨å‹¢åˆ†æ */
        .trend-section {
            margin-bottom: 20px;
        }

        .trend-title {
            font-size: 1.15rem;
            margin-bottom: 10px;
            color: #ffd700;
        }

        .trend-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
        }

        .trend-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px 5px;
            text-align: center;
        }

        .trend-item .number {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .trend-item .count {
            font-size: 0.95rem;
            color: #888;
        }

        .trend-item .status {
            font-size: 0.85rem;
            padding: 3px 8px;
            border-radius: 10px;
            margin-top: 5px;
            display: inline-block;
        }

        .hot { background: #e74c3c; }
        .warm { background: #f39c12; }
        .cold { background: #3498db; }

        /* æŠ•æ³¨å»ºè­° */
        .strategy-section {
            margin-top: 20px;
        }

        .strategy-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .strategy-btn {
            flex: 1;
            padding: 18px;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .strategy-btn.conservative {
            background: rgba(52, 152, 219, 0.3);
            color: #3498db;
        }

        .strategy-btn.aggressive {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }

        .strategy-btn.active {
            border-color: currentColor;
            transform: scale(1.02);
        }

        .bet-suggestion {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            font-size: 1.05rem;
        }

        .bet-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bet-item:last-child {
            border-bottom: none;
        }

        .bet-item .bet-type {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .bet-item .bet-amount {
            color: #ffd700;
            font-weight: bold;
            font-size: 1.15rem;
        }

        .bet-item .bet-odds {
            color: #888;
            font-size: 0.9rem;
        }

        .total-bet {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid rgba(255, 215, 0, 0.3);
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .total-bet .amount {
            color: #ffd700;
        }

        .confidence-meter {
            margin-top: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
        }

        .confidence-meter label {
            display: block;
            margin-bottom: 8px;
            color: #888;
        }

        .meter-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .meter-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s;
        }

        .meter-low { background: linear-gradient(90deg, #3498db, #2ecc71); }
        .meter-medium { background: linear-gradient(90deg, #f39c12, #e74c3c); }
        .meter-high { background: linear-gradient(90deg, #e74c3c, #8e44ad); }

        /* è·¯å–®é¡¯ç¤º */
        .roadmap {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 15px;
        }

        .roadmap-cell {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .roadmap-big { background: #e74c3c; }
        .roadmap-small { background: #3498db; }
        .roadmap-triple { background: #ffd700; color: #1a1a2e; }

        /* è³ ç‡èªªæ˜ */
        .odds-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
            padding: 18px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .odds-item {
            text-align: center;
        }

        .odds-item .type {
            font-size: 1.05rem;
            color: #888;
        }

        .odds-item .odds {
            font-size: 1.35rem;
            font-weight: bold;
            color: #ffd700;
        }

        .warning-text {
            color: #f39c12;
            font-size: 0.85rem;
            margin-top: 10px;
            padding: 10px;
            background: rgba(243, 156, 18, 0.1);
            border-radius: 8px;
            border-left: 3px solid #f39c12;
        }

        .strategy-desc {
            font-size: 0.75rem;
            font-weight: normal;
            margin-top: 5px;
            opacity: 0.8;
        }

        .strategy-explain {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 1rem;
            line-height: 1.7;
            display: none;
        }

        .strategy-explain.show {
            display: block;
        }

        .strategy-explain .title {
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .strategy-explain ul {
            margin: 0;
            padding-left: 20px;
            color: #ccc;
        }

        .strategy-explain li {
            margin-bottom: 4px;
        }

        .confidence-detail {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 18px;
            margin-top: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .confidence-detail .detail-title {
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .confidence-detail .detail-content {
            font-size: 1rem;
            color: #ccc;
        }

        .confidence-detail .detail-table {
            width: 100%;
            margin: 10px 0;
        }

        .confidence-detail .detail-table td {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .confidence-detail .detail-table .val {
            text-align: right;
            color: #2ecc71;
            font-weight: bold;
        }

        .confidence-levels {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .confidence-levels .level {
            padding: 6px 14px;
            border-radius: 15px;
            font-size: 0.95rem;
        }

        .confidence-levels .low {
            background: rgba(52, 152, 219, 0.3);
            color: #3498db;
        }

        .confidence-levels .medium {
            background: rgba(243, 156, 18, 0.3);
            color: #f39c12;
        }

        .confidence-levels .high {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ² éª°å¯¶è¶¨å‹¢åˆ†æå™¨ ğŸ²</h1>

        <div class="main-grid">
            <!-- å·¦å´ï¼šè¼¸å…¥èˆ‡è¨˜éŒ„ -->
            <div>
                <div class="card">
                    <h2>ğŸ“ è¼¸å…¥é–‹ççµæœ</h2>
                    <div class="input-section">
                        <div class="dice-input">
                            <label>æœŸæ•¸:</label>
                            <input type="text" id="roundNum" placeholder="å¦‚:001" style="width: 80px;">
                        </div>
                        <div class="dice-input">
                            <label>éª°1:</label>
                            <input type="number" id="dice1" min="1" max="6" placeholder="1-6">
                        </div>
                        <div class="dice-input">
                            <label>éª°2:</label>
                            <input type="number" id="dice2" min="1" max="6" placeholder="1-6">
                        </div>
                        <div class="dice-input">
                            <label>éª°3:</label>
                            <input type="number" id="dice3" min="1" max="6" placeholder="1-6">
                        </div>
                        <button class="btn btn-primary" onclick="addRecord()">æ–°å¢è¨˜éŒ„</button>
                        <button class="btn btn-danger" onclick="clearRecords()">æ¸…é™¤å…¨éƒ¨</button>
                    </div>

                    <div class="current-result" id="currentResult" style="display: none;">
                        <div style="text-align: center; margin-right: 15px;">
                            <div style="color: #888; font-size: 0.8rem;">æœ€æ–°æœŸæ•¸</div>
                            <div style="color: #ffd700; font-size: 1.5rem; font-weight: bold;" id="displayRound">-</div>
                        </div>
                        <div class="dice-display" id="display1">-</div>
                        <div class="dice-display" id="display2">-</div>
                        <div class="dice-display" id="display3">-</div>
                        <span>=</span>
                        <div class="dice-display" id="displaySum">-</div>
                        <div class="result-type" id="resultType">-</div>
                    </div>

                    <div class="odds-info">
                        <div class="odds-item">
                            <div class="type">å¤§/å°</div>
                            <div class="odds">1 è³  2</div>
                        </div>
                        <div class="odds-item">
                            <div class="type">è±¹å­</div>
                            <div class="odds">1 è³  30</div>
                        </div>
                        <div class="odds-item">
                            <div class="type">æŒ‡å®šè±¹å­</div>
                            <div class="odds">1 è³  150</div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>ğŸ›¤ï¸ è·¯å–® (å¤§å°èµ°å‹¢)</h2>
                    <div class="roadmap" id="roadmap"></div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>ğŸ“œ æ­·å²è¨˜éŒ„ (æœ€å¤š100ç­†)</h2>
                    <div class="history-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>æœŸæ•¸</th>
                                    <th>éª°1</th>
                                    <th>éª°2</th>
                                    <th>éª°3</th>
                                    <th>ç¸½å’Œ</th>
                                    <th>çµæœ</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="historyBody">
                            </tbody>
                        </table>
                    </div>
                    <p style="text-align: center; color: #888; margin-top: 10px;" id="recordCount">ç›®å‰ 0 ç­†è¨˜éŒ„</p>
                </div>
            </div>

            <!-- å³å´ï¼šçµ±è¨ˆèˆ‡ç­–ç•¥ -->
            <div>
                <div class="card">
                    <h2>ğŸ“Š çµ±è¨ˆåˆ†æ (è¿‘10æœŸ) <span id="analysisRange" style="font-size: 0.8rem; color: #888; font-weight: normal;"></span></h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>å¤§</h3>
                            <div class="value" style="color: #e74c3c;" id="bigCount">0</div>
                            <div class="percentage" id="bigPercent">0%</div>
                            <div class="percentage" id="bigCountAll" style="font-size: 0.75rem; margin-top: 5px;">å…¨0æœŸ: 0</div>
                        </div>
                        <div class="stat-card">
                            <h3>å°</h3>
                            <div class="value" style="color: #3498db;" id="smallCount">0</div>
                            <div class="percentage" id="smallPercent">0%</div>
                            <div class="percentage" id="smallCountAll" style="font-size: 0.75rem; margin-top: 5px;">å…¨0æœŸ: 0</div>
                        </div>
                        <div class="stat-card">
                            <h3>è±¹å­</h3>
                            <div class="value" style="color: #ffd700;" id="tripleCount">0</div>
                            <div class="percentage" id="triplePercent">0%</div>
                            <div class="percentage" id="tripleCountAll" style="font-size: 0.75rem; margin-top: 5px;">å…¨0æœŸ: 0</div>
                        </div>
                    </div>

                    <div class="trend-section">
                        <div class="trend-title">ğŸ”¢ å„é»æ•¸å‡ºç¾æ¬¡æ•¸ - è¿‘10æœŸ (å†·/æº«/ç†±)</div>
                        <div class="trend-grid" id="numberTrend"></div>
                    </div>

                    <div class="trend-section">
                        <div class="trend-title">ğŸ¯ ç¸½å’Œåˆ†å¸ƒ - è¿‘10æœŸ (4-17)</div>
                        <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px;" id="sumTrend"></div>
                    </div>

                    <div class="trend-section">
                        <div class="trend-title">ğŸ“ˆ é€£çºŒè¶¨å‹¢</div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>ç•¶å‰é€£çºŒ</h3>
                                <div class="value" id="currentStreak">-</div>
                                <div class="percentage" id="streakType">-</div>
                            </div>
                            <div class="stat-card">
                                <h3>æœ€é•·é€£å¤§</h3>
                                <div class="value" style="color: #e74c3c;" id="maxBigStreak">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>æœ€é•·é€£å°</h3>
                                <div class="value" style="color: #3498db;" id="maxSmallStreak">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>ğŸ’° æŠ•æ³¨å»ºè­° <span id="nextRoundHint" style="font-size: 0.9rem; color: #ffd700;"></span></h2>
                    <p style="color: #888; margin-bottom: 15px;">1æ³¨ = $5,000 | å–®æœŸæœ€é«˜60æ³¨ ($300,000)</p>
                    
                    <div class="strategy-toggle">
                        <button class="strategy-btn conservative active" onclick="setStrategy('conservative')">
                            ğŸ›¡ï¸ ä¿å®ˆç­–ç•¥
                            <div class="strategy-desc">ç©©å¥ç‚ºä¸»ãƒ»åªæŠ¼å¤§å°ãƒ»é«˜é–€æª»è§¸ç™¼</div>
                        </button>
                        <button class="strategy-btn aggressive" onclick="setStrategy('aggressive')">
                            âš”ï¸ æ¿€é€²ç­–ç•¥
                            <div class="strategy-desc">è¿½æ±‚é«˜è³ ãƒ»æŠ¼è±¹å­ãƒ»ä½é–€æª»è§¸ç™¼</div>
                        </button>
                    </div>

                    <div class="strategy-explain" id="strategyExplain"></div>

                    <div class="bet-suggestion" id="betSuggestion">
                        <p style="text-align: center; color: #888;">è«‹å…ˆè¼¸å…¥è‡³å°‘3ç­†é–‹çè¨˜éŒ„</p>
                    </div>

                    <div class="confidence-meter" onclick="toggleConfidenceDetail()" style="cursor: pointer;">
                        <label>ç­–ç•¥ä¿¡å¿ƒæŒ‡æ•¸ <span style="font-size: 0.8rem; color: #ffd700;">â“˜ é»æ“ŠæŸ¥çœ‹è©³æƒ…</span></label>
                        <div class="meter-bar">
                            <div class="meter-fill meter-low" id="confidenceFill" style="width: 0%"></div>
                        </div>
                        <p style="text-align: right; color: #888; margin-top: 5px;" id="confidenceText">0%</p>
                    </div>

                    <div class="confidence-detail" id="confidenceDetail" style="display: none;">
                        <div class="detail-title">ğŸ“Š ä¿¡å¿ƒæŒ‡æ•¸è¨ˆç®—æ–¹å¼</div>
                        <div class="detail-content">
                            <p><strong>åŸºç¤å€¼ï¼š30%</strong></p>
                            <table class="detail-table">
                                <tr><td>é€£çºŒ6+æœŸåŒçµæœ</td><td class="val">+30%</td></tr>
                                <tr><td>é€£çºŒ4-5æœŸåŒçµæœ</td><td class="val">+20%</td></tr>
                                <tr><td>é€£çºŒ3æœŸåŒçµæœ</td><td class="val">+12%</td></tr>
                                <tr><td>è¿‘10æœŸå¤§å°æ¯”ä¾‹åé›¢>20%</td><td class="val">+18%</td></tr>
                                <tr><td>è¿‘10æœŸå¤§å°æ¯”ä¾‹åé›¢>10%</td><td class="val">+8%</td></tr>
                                <tr><td>è¿‘5æœŸå‡ºç¾4æ¬¡ä»¥ä¸ŠåŒçµæœ</td><td class="val">+10%</td></tr>
                                <tr><td>è¶…é20æœŸæœªå‡ºè±¹å­</td><td class="val">+12%</td></tr>
                                <tr><td>è¶…é12æœŸæœªå‡ºè±¹å­</td><td class="val">+6%</td></tr>
                            </table>
                            <p style="margin-top: 10px; color: #888;">ä¸Šé™ 90%ï¼ˆéª°å­ç‚ºéš¨æ©ŸéŠæˆ²ï¼Œä¸å­˜åœ¨100%ç¢ºå®šæ€§ï¼‰</p>
                            <div class="confidence-levels">
                                <span class="level low">< 40% è§€æœ›</span>
                                <span class="level medium">40-70% å¯æŠ•æ³¨</span>
                                <span class="level high">> 70% è¨Šè™Ÿæ˜ç¢º</span>
                            </div>
                        </div>
                    </div>

                    <div class="warning-text">
                        âš ï¸ æŠ•æ³¨å»ºè­°åƒ…ä¾›åƒè€ƒï¼Œéª°å¯¶ç‚ºéš¨æ©ŸéŠæˆ²ï¼Œéå¾€çµæœä¸ä»£è¡¨æœªä¾†ã€‚è«‹ç†æ€§æŠ•æ³¨ï¼Œé‡åŠ›è€Œç‚ºã€‚
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¸¸é‡
        const MAX_RECORDS = 100;
        const ANALYSIS_WINDOW = 10; // åˆ†æè¦–çª—ï¼šå‰10æœŸ
        const BET_UNIT = 5000;
        const MAX_BETS = 60;

        // ç‹€æ…‹
        let records = [];
        let currentStrategy = 'conservative';

        // å¾ localStorage è¼‰å…¥
        function loadRecords() {
            const saved = localStorage.getItem('sicBoRecords');
            if (saved) {
                records = JSON.parse(saved);
                updateDisplay();
            }
        }

        // å„²å­˜åˆ° localStorage
        function saveRecords() {
            localStorage.setItem('sicBoRecords', JSON.stringify(records));
        }

        // åˆ¤æ–·çµæœé¡å‹
        function getResultType(d1, d2, d3) {
            const sum = d1 + d2 + d3;
            if (d1 === d2 && d2 === d3) {
                return { type: 'triple', sum, tripleNumber: d1 };
            }
            return { type: sum >= 12 ? 'big' : 'small', sum };
        }

        // æ–°å¢è¨˜éŒ„
        function addRecord() {
            const roundNum = document.getElementById('roundNum').value.trim();
            const d1 = parseInt(document.getElementById('dice1').value);
            const d2 = parseInt(document.getElementById('dice2').value);
            const d3 = parseInt(document.getElementById('dice3').value);

            // é©—è­‰
            if (!roundNum) {
                alert('è«‹è¼¸å…¥æœŸæ•¸');
                return;
            }

            if (isNaN(d1) || isNaN(d2) || isNaN(d3) ||
                d1 < 1 || d1 > 6 || d2 < 1 || d2 > 6 || d3 < 1 || d3 > 6) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„éª°å­é»æ•¸ (1-6)');
                return;
            }

            const result = getResultType(d1, d2, d3);
            records.unshift({
                round: roundNum,
                dice: [d1, d2, d3],
                ...result,
                timestamp: Date.now()
            });

            // é™åˆ¶è¨˜éŒ„æ•¸é‡
            if (records.length > MAX_RECORDS) {
                records = records.slice(0, MAX_RECORDS);
            }

            saveRecords();
            updateDisplay();

            // æ¸…ç©ºè¼¸å…¥ï¼ˆæœŸæ•¸è‡ªå‹•éå¢æˆ–ä¿ç•™ï¼‰
            const nextRound = autoIncrementRound(roundNum);
            document.getElementById('roundNum').value = nextRound;
            document.getElementById('dice1').value = '';
            document.getElementById('dice2').value = '';
            document.getElementById('dice3').value = '';
            document.getElementById('dice1').focus();
        }

        // è‡ªå‹•éå¢æœŸæ•¸
        function autoIncrementRound(currentRound) {
            // å˜—è©¦è§£ææ•¸å­—éƒ¨åˆ†ä¸¦éå¢
            const match = currentRound.match(/^(.*?)(\d+)$/);
            if (match) {
                const prefix = match[1];
                const num = parseInt(match[2]);
                const padLength = match[2].length;
                return prefix + String(num + 1).padStart(padLength, '0');
            }
            return currentRound;
        }

        // åˆªé™¤å–®ç­†è¨˜éŒ„
        function deleteRecord(index) {
            records.splice(index, 1);
            saveRecords();
            updateDisplay();
        }

        // æ¸…é™¤æ‰€æœ‰è¨˜éŒ„
        function clearRecords() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è¨˜éŒ„å—ï¼Ÿ')) {
                records = [];
                saveRecords();
                updateDisplay();
            }
        }

        // æ›´æ–°é¡¯ç¤º
        function updateDisplay() {
            updateCurrentResult();
            updateHistory();
            updateStats();
            updateTrends();
            updateRoadmap();
            updateBetSuggestion();
        }

        // æ›´æ–°ç•¶å‰çµæœé¡¯ç¤º
        function updateCurrentResult() {
            const container = document.getElementById('currentResult');
            if (records.length === 0) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'flex';
            const latest = records[0];

            document.getElementById('displayRound').textContent = latest.round || '-';
            document.getElementById('display1').textContent = latest.dice[0];
            document.getElementById('display2').textContent = latest.dice[1];
            document.getElementById('display3').textContent = latest.dice[2];
            document.getElementById('displaySum').textContent = latest.sum;

            const typeEl = document.getElementById('resultType');
            typeEl.className = 'result-type';

            if (latest.type === 'triple') {
                typeEl.textContent = `è±¹å­ ${latest.tripleNumber}`;
                typeEl.classList.add('result-triple');
            } else if (latest.type === 'big') {
                typeEl.textContent = 'å¤§';
                typeEl.classList.add('result-big');
            } else {
                typeEl.textContent = 'å°';
                typeEl.classList.add('result-small');
            }
        }

        // æ›´æ–°æ­·å²è¨˜éŒ„è¡¨æ ¼
        function updateHistory() {
            const tbody = document.getElementById('historyBody');
            tbody.innerHTML = records.map((r, i) => {
                let badge = '';
                if (r.type === 'triple') {
                    badge = `<span class="badge badge-triple">è±¹${r.tripleNumber}</span>`;
                } else if (r.type === 'big') {
                    badge = '<span class="badge badge-big">å¤§</span>';
                } else {
                    badge = '<span class="badge badge-small">å°</span>';
                }

                return `
                    <tr${i === 0 ? ' style="background: rgba(255, 215, 0, 0.1);"' : ''}>
                        <td style="color: #ffd700; font-weight: bold;">${r.round || '-'}</td>
                        <td>${r.dice[0]}</td>
                        <td>${r.dice[1]}</td>
                        <td>${r.dice[2]}</td>
                        <td>${r.sum}</td>
                        <td>${badge}</td>
                        <td><button onclick="deleteRecord(${i})" style="background:none;border:none;color:#ff4757;cursor:pointer;">âœ•</button></td>
                    </tr>
                `;
            }).join('');

            document.getElementById('recordCount').textContent = `ç›®å‰ ${records.length} ç­†è¨˜éŒ„`;
        }

        // æ›´æ–°çµ±è¨ˆ
        function updateStats() {
            // å–å‰10æœŸä½œç‚ºä¸»è¦åˆ†æç¯„åœ
            const recent10 = records.slice(0, ANALYSIS_WINDOW);
            const r10Total = recent10.length;
            const r10Big = recent10.filter(r => r.type === 'big').length;
            const r10Small = recent10.filter(r => r.type === 'small').length;
            const r10Triple = recent10.filter(r => r.type === 'triple').length;

            // å…¨éƒ¨è¨˜éŒ„çµ±è¨ˆ
            const total = records.length;
            const bigCount = records.filter(r => r.type === 'big').length;
            const smallCount = records.filter(r => r.type === 'small').length;
            const tripleCount = records.filter(r => r.type === 'triple').length;

            // é¡¯ç¤ºè¿‘10æœŸçµ±è¨ˆï¼ˆä¸»è¦ï¼‰
            document.getElementById('bigCount').textContent = r10Big;
            document.getElementById('smallCount').textContent = r10Small;
            document.getElementById('tripleCount').textContent = r10Triple;

            document.getElementById('bigPercent').textContent = r10Total ? `${(r10Big / r10Total * 100).toFixed(0)}%` : '0%';
            document.getElementById('smallPercent').textContent = r10Total ? `${(r10Small / r10Total * 100).toFixed(0)}%` : '0%';
            document.getElementById('triplePercent').textContent = r10Total ? `${(r10Triple / r10Total * 100).toFixed(0)}%` : '0%';

            // é¡¯ç¤ºå…¨éƒ¨çµ±è¨ˆï¼ˆæ¬¡è¦ï¼‰
            document.getElementById('bigCountAll').textContent = `å…¨${total}æœŸ: ${bigCount}`;
            document.getElementById('smallCountAll').textContent = `å…¨${total}æœŸ: ${smallCount}`;
            document.getElementById('tripleCountAll').textContent = `å…¨${total}æœŸ: ${tripleCount}`;

            // æ›´æ–°åˆ†æç¯„åœé¡¯ç¤º
            if (records.length > 0) {
                const newest = records[0].round || '?';
                const analysisEnd = records[Math.min(ANALYSIS_WINDOW - 1, records.length - 1)].round || '?';
                document.getElementById('analysisRange').textContent = 
                    `(åˆ†æ: ç¬¬${analysisEnd}æœŸ ~ ç¬¬${newest}æœŸï¼Œå…±${r10Total}æœŸ)`;
            } else {
                document.getElementById('analysisRange').textContent = '';
            }

            // é€£çºŒè¶¨å‹¢
            updateStreaks();
        }

        // æ›´æ–°é€£çºŒè¶¨å‹¢
        function updateStreaks() {
            if (records.length === 0) {
                document.getElementById('currentStreak').textContent = '-';
                document.getElementById('streakType').textContent = '-';
                document.getElementById('maxBigStreak').textContent = '0';
                document.getElementById('maxSmallStreak').textContent = '0';
                return;
            }

            let currentStreak = 1;
            let currentType = records[0].type === 'triple' ? 'triple' : records[0].type;
            let maxBig = 0, maxSmall = 0;
            let tempBig = 0, tempSmall = 0;

            for (let i = 0; i < records.length; i++) {
                const type = records[i].type === 'triple' ? 'triple' : records[i].type;
                
                if (type === 'big') {
                    tempBig++;
                    tempSmall = 0;
                } else if (type === 'small') {
                    tempSmall++;
                    tempBig = 0;
                } else {
                    tempBig = 0;
                    tempSmall = 0;
                }

                maxBig = Math.max(maxBig, tempBig);
                maxSmall = Math.max(maxSmall, tempSmall);

                if (i > 0) {
                    const prevType = records[i - 1].type === 'triple' ? 'triple' : records[i - 1].type;
                    if (type === currentType && i < 5) {
                        currentStreak++;
                    }
                }
            }

            // è¨ˆç®—ç•¶å‰é€£çºŒï¼ˆå¾æœ€æ–°é–‹å§‹ï¼‰
            currentStreak = 1;
            currentType = records[0].type === 'triple' ? 'triple' : records[0].type;
            for (let i = 1; i < records.length; i++) {
                const type = records[i].type === 'triple' ? 'triple' : records[i].type;
                if (type === currentType) {
                    currentStreak++;
                } else {
                    break;
                }
            }

            document.getElementById('currentStreak').textContent = currentStreak;
            document.getElementById('streakType').textContent = 
                currentType === 'big' ? 'é€£å¤§' : 
                currentType === 'small' ? 'é€£å°' : 'è±¹å­';
            document.getElementById('maxBigStreak').textContent = maxBig;
            document.getElementById('maxSmallStreak').textContent = maxSmall;
        }

        // æ›´æ–°è¶¨å‹¢åˆ†æï¼ˆåŸºæ–¼è¿‘10æœŸï¼‰
        function updateTrends() {
            const recent10 = records.slice(0, ANALYSIS_WINDOW);
            
            // å„é»æ•¸çµ±è¨ˆ (1-6) - åŸºæ–¼è¿‘10æœŸ
            const numberCounts = [0, 0, 0, 0, 0, 0];
            recent10.forEach(r => {
                r.dice.forEach(d => numberCounts[d - 1]++);
            });

            const totalDice = recent10.length * 3;
            const avgCount = totalDice / 6;

            const numberTrendEl = document.getElementById('numberTrend');
            numberTrendEl.innerHTML = numberCounts.map((count, i) => {
                let status = 'warm';
                let statusText = 'æº«';
                if (totalDice > 0) {
                    const ratio = count / avgCount;
                    if (ratio >= 1.4) { status = 'hot'; statusText = 'ç†±'; }
                    else if (ratio <= 0.6) { status = 'cold'; statusText = 'å†·'; }
                }
                return `
                    <div class="trend-item">
                        <div class="number">${i + 1}</div>
                        <div class="count">${count}æ¬¡</div>
                        <span class="status ${status}">${statusText}</span>
                    </div>
                `;
            }).join('');

            // ç¸½å’Œåˆ†å¸ƒ (4-17ï¼Œæ’é™¤è±¹å­3å’Œ18) - åŸºæ–¼è¿‘10æœŸ
            const sumCounts = {};
            for (let i = 4; i <= 17; i++) sumCounts[i] = 0;
            recent10.forEach(r => {
                if (r.type !== 'triple' && sumCounts[r.sum] !== undefined) {
                    sumCounts[r.sum]++;
                }
            });

            const nonTripleCount = recent10.filter(r => r.type !== 'triple').length;
            const avgSum = nonTripleCount / 14;

            const sumTrendEl = document.getElementById('sumTrend');
            sumTrendEl.innerHTML = Object.entries(sumCounts).map(([sum, count]) => {
                let status = 'warm';
                let statusText = 'æº«';
                if (nonTripleCount > 0) {
                    const ratio = count / avgSum;
                    if (ratio >= 1.8) { status = 'hot'; statusText = 'ç†±'; }
                    else if (ratio <= 0.3 || count === 0) { status = 'cold'; statusText = 'å†·'; }
                }
                const isBig = parseInt(sum) >= 12;
                return `
                    <div class="trend-item" style="border-left: 3px solid ${isBig ? '#e74c3c' : '#3498db'}">
                        <div class="number" style="font-size: 1rem;">${sum}</div>
                        <div class="count">${count}</div>
                        <span class="status ${status}">${statusText}</span>
                    </div>
                `;
            }).join('');
        }

        // æ›´æ–°è·¯å–®
        function updateRoadmap() {
            const roadmapEl = document.getElementById('roadmap');
            roadmapEl.innerHTML = [...records].reverse().map(r => {
                let cls = 'roadmap-';
                let text = '';
                if (r.type === 'triple') {
                    cls += 'triple';
                    text = r.tripleNumber;
                } else if (r.type === 'big') {
                    cls += 'big';
                    text = 'å¤§';
                } else {
                    cls += 'small';
                    text = 'å°';
                }
                const tooltip = `ç¬¬${r.round || '?'}æœŸ: ${r.dice.join(',')}=${r.sum}`;
                return `<div class="roadmap-cell ${cls}" title="${tooltip}">${text}</div>`;
            }).join('');
        }

        // è¨­å®šç­–ç•¥
        function setStrategy(strategy) {
            currentStrategy = strategy;
            document.querySelectorAll('.strategy-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.strategy-btn.${strategy}`).classList.add('active');
            updateStrategyExplain();
            updateBetSuggestion();
        }

        // æ›´æ–°ç­–ç•¥èªªæ˜
        function updateStrategyExplain() {
            const explainEl = document.getElementById('strategyExplain');
            
            if (currentStrategy === 'conservative') {
                explainEl.innerHTML = `
                    <div class="title">ğŸ›¡ï¸ ä¿å®ˆç­–ç•¥åŸå‰‡</div>
                    <ul>
                        <li><strong>åªæŠ¼å¤§å°</strong>ï¼šä¸æŠ¼è±¹å­ï¼Œé¿å…ä½æ©Ÿç‡é«˜é¢¨éšª</li>
                        <li><strong>è¨Šè™Ÿç©åˆ†åˆ¶</strong>ï¼šéœ€ç´¯ç© 2 åˆ†ä»¥ä¸Šæ‰å‡ºå»ºè­°
                            <ul style="font-size: 0.9em; margin-top: 5px;">
                                <li>é€£çºŒ3æœŸ +1åˆ†ï¼Œ4æœŸ +2åˆ†ï¼Œ5æœŸä»¥ä¸Š +3åˆ†</li>
                                <li>æ¯”ä¾‹åé›¢25%~30% +1åˆ†ï¼Œ30%~35% +2åˆ†ï¼Œ35%ä»¥ä¸Š +3åˆ†</li>
                                <li>è¿‘5æœŸæ¥µç«¯ï¼ˆ4æ¬¡ä»¥ä¸ŠåŒçµæœï¼‰+1åˆ†</li>
                            </ul>
                        </li>
                        <li><strong>ç©©å¥ä¸‹æ³¨</strong>ï¼šè¨Šè™Ÿè¶Šå¼·ï¼Œä¸‹æ³¨è¶Šå¤šï¼ˆ3~10æ³¨ï¼‰</li>
                    </ul>
                `;
            } else {
                explainEl.innerHTML = `
                    <div class="title">âš”ï¸ æ¿€é€²ç­–ç•¥åŸå‰‡</div>
                    <ul>
                        <li><strong>è¿½æ±‚é«˜è³ ç‡</strong>ï¼šæœƒæŠ¼è±¹å­(1:30)ã€æŒ‡å®šè±¹å­(1:150)</li>
                        <li><strong>ä½é–€æª»è§¸ç™¼</strong>ï¼šé€£çºŒ3æœŸå³è§¸ç™¼åè½‰å»ºè­°</li>
                        <li><strong>å¤šå…ƒæŠ•æ³¨</strong>ï¼šåŒæ™‚æŠ¼å¤§å° + è±¹å­ï¼Œåˆ†æ•£é¢¨éšª</li>
                        <li><strong>è¿½ç†±è™Ÿ</strong>ï¼šæ ¹æ“šç†±è™ŸæŠ¼æŒ‡å®šè±¹å­</li>
                        <li><strong>ç©æ¥µä¸‹æ³¨</strong>ï¼šå–®é …å»ºè­° 5~20 æ³¨</li>
                    </ul>
                `;
            }
            explainEl.classList.add('show');
        }

        // åˆ‡æ›ä¿¡å¿ƒæŒ‡æ•¸è©³æƒ…é¡¯ç¤º
        function toggleConfidenceDetail() {
            const detailEl = document.getElementById('confidenceDetail');
            if (detailEl.style.display === 'none') {
                detailEl.style.display = 'block';
            } else {
                detailEl.style.display = 'none';
            }
        }

        // æ›´æ–°æŠ•æ³¨å»ºè­°
        function updateBetSuggestion() {
            const container = document.getElementById('betSuggestion');
            const nextRoundHint = document.getElementById('nextRoundHint');
            
            // é¡¯ç¤ºä¸‹ä¸€æœŸé æ¸¬æç¤º
            if (records.length > 0) {
                const latestRound = records[0].round || '?';
                const nextRound = autoIncrementRound(latestRound);
                nextRoundHint.textContent = `(åŸºæ–¼ç¬¬${latestRound}æœŸï¼Œå»ºè­°ç¬¬${nextRound}æœŸ)`;
            } else {
                nextRoundHint.textContent = '';
            }
            
            if (records.length < 3) {
                container.innerHTML = '<p style="text-align: center; color: #888;">è«‹å…ˆè¼¸å…¥è‡³å°‘3ç­†é–‹çè¨˜éŒ„</p>';
                document.getElementById('confidenceFill').style.width = '0%';
                document.getElementById('confidenceText').textContent = '0%';
                return;
            }

            const analysis = analyzeForBetting();
            const suggestions = generateSuggestions(analysis);
            
            let html = '';
            let totalBets = 0;

            suggestions.forEach(s => {
                totalBets += s.bets;
                html += `
                    <div class="bet-item">
                        <div>
                            <div class="bet-type">${s.type}</div>
                            <div class="bet-odds">${s.reason || ''}</div>
                        </div>
                        <div style="text-align: right;">
                            <div class="bet-amount">${s.bets}æ³¨ ($${(s.bets * BET_UNIT).toLocaleString()})</div>
                            <div class="bet-odds">è³ ç‡ 1:${s.odds} â†’ $${(s.bets * BET_UNIT * s.odds).toLocaleString()}</div>
                        </div>
                    </div>
                `;
            });

            if (suggestions.length === 0) {
                html = '<p style="text-align: center; color: #888;">ç›®å‰ç„¡æ˜ç¢ºæŠ•æ³¨å»ºè­°ï¼Œå»ºè­°è§€æœ›</p>';
            } else {
                html += `
                    <div class="total-bet">
                        <span>ç¸½æŠ•æ³¨</span>
                        <span class="amount">${totalBets}æ³¨ ($${(totalBets * BET_UNIT).toLocaleString()})</span>
                    </div>
                `;
            }

            html += `<div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                <strong>åˆ†æç†ç”±ï¼š</strong><br>
                <span style="color: #888; font-size: 0.9rem;">${analysis.reason}</span>
            </div>`;

            container.innerHTML = html;

            // æ›´æ–°ä¿¡å¿ƒæŒ‡æ•¸
            const confidence = analysis.confidence;
            const fillEl = document.getElementById('confidenceFill');
            fillEl.style.width = `${confidence}%`;
            fillEl.className = 'meter-fill ' + 
                (confidence < 40 ? 'meter-low' : confidence < 70 ? 'meter-medium' : 'meter-high');
            document.getElementById('confidenceText').textContent = `${confidence}%`;
        }

        // åˆ†ææ•¸æ“šç”¨æ–¼æŠ•æ³¨ï¼ˆä¸»è¦åŸºæ–¼å‰10æœŸï¼‰
        function analyzeForBetting() {
            // å–å‰10æœŸä½œç‚ºä¸»è¦åˆ†ææ•¸æ“š
            const recent10 = records.slice(0, ANALYSIS_WINDOW);
            const total = recent10.length;
            const bigCount = recent10.filter(r => r.type === 'big').length;
            const smallCount = recent10.filter(r => r.type === 'small').length;
            const tripleCount = recent10.filter(r => r.type === 'triple').length;

            // è¨ˆç®—ç•¶å‰é€£çºŒï¼ˆå¾æœ€æ–°æœŸé–‹å§‹ï¼‰
            let currentStreak = 1;
            let currentType = records[0].type;
            for (let i = 1; i < records.length; i++) {
                if (records[i].type === currentType) {
                    currentStreak++;
                } else {
                    break;
                }
            }

            // è¨ˆç®—è¿‘10æœŸå„é»æ•¸å‡ºç¾é »ç‡
            const numberCounts = [0, 0, 0, 0, 0, 0];
            recent10.forEach(r => r.dice.forEach(d => numberCounts[d - 1]++));
            const totalDice = total * 3;
            const avgNumber = totalDice / 6;

            // æ‰¾å‡ºå†·è™Ÿå’Œç†±è™Ÿï¼ˆåŸºæ–¼è¿‘10æœŸï¼‰
            const coldNumbers = [];
            const hotNumbers = [];
            if (total >= 5) {
                numberCounts.forEach((count, i) => {
                    if (count < avgNumber * 0.5) coldNumbers.push(i + 1);
                    if (count > avgNumber * 1.5) hotNumbers.push(i + 1);
                });
            }

            // å¤§å°æ¯”ä¾‹åé›¢åº¦ï¼ˆåŸºæ–¼è¿‘10æœŸï¼‰
            const nonTriple = total - tripleCount;
            const bigRatio = nonTriple > 0 ? bigCount / nonTriple : 0.5;
            const deviation = Math.abs(bigRatio - 0.5);

            // è¨ˆç®—è¿‘5æœŸè¶¨å‹¢
            const recent5 = records.slice(0, 5);
            const recentBig = recent5.filter(r => r.type === 'big').length;
            const recentSmall = recent5.filter(r => r.type === 'small').length;

            // è±¹å­é–“éš”ï¼ˆå¾æœ€æ–°æœŸé–‹å§‹ç®—ï¼‰
            let tripleGap = 0;
            for (let i = 0; i < records.length; i++) {
                if (records[i].type === 'triple') break;
                tripleGap++;
            }

            let confidence = 30;
            let reasons = [];

            // é€£çºŒè¶¨å‹¢åˆ†æï¼ˆæ¬Šé‡æœ€é«˜ï¼‰
            if (currentStreak >= 6) {
                confidence += 30;
                reasons.push(`ğŸ”¥ é€£çºŒ${currentStreak}æ¬¡${currentType === 'big' ? 'å¤§' : currentType === 'small' ? 'å°' : 'è±¹å­'}ï¼Œå¼·çƒˆåè½‰è¨Šè™Ÿ`);
            } else if (currentStreak >= 4) {
                confidence += 20;
                reasons.push(`é€£çºŒ${currentStreak}æ¬¡${currentType === 'big' ? 'å¤§' : currentType === 'small' ? 'å°' : 'è±¹å­'}ï¼Œåè½‰æ©Ÿç‡æé«˜`);
            } else if (currentStreak >= 3) {
                confidence += 12;
                reasons.push(`é€£çºŒ${currentStreak}æ¬¡${currentType === 'big' ? 'å¤§' : currentType === 'small' ? 'å°' : 'è±¹å­'}`);
            }

            // è¿‘10æœŸæ¯”ä¾‹åé›¢åˆ†æ
            if (total >= 5 && deviation > 0.2) {
                confidence += 18;
                reasons.push(`è¿‘${total}æœŸå¤§å°æ¯”ä¾‹å¤±è¡¡ (å¤§${(bigRatio * 100).toFixed(0)}%)`);
            } else if (total >= 5 && deviation > 0.1) {
                confidence += 8;
                reasons.push(`è¿‘${total}æœŸå¤§ä½”${(bigRatio * 100).toFixed(0)}%`);
            }

            // è¿‘5æœŸæ¥µç«¯æƒ…æ³
            if (recentBig >= 4) {
                confidence += 10;
                reasons.push(`è¿‘5æœŸå¤§å‡º${recentBig}æ¬¡`);
            } else if (recentSmall >= 4) {
                confidence += 10;
                reasons.push(`è¿‘5æœŸå°å‡º${recentSmall}æ¬¡`);
            }

            // è±¹å­åˆ†æ
            if (tripleGap >= 20) {
                confidence += 12;
                reasons.push(`å·²${tripleGap}æœŸæœªå‡ºè±¹å­`);
            } else if (tripleGap >= 12) {
                confidence += 6;
                reasons.push(`${tripleGap}æœŸæœªè¦‹è±¹å­`);
            }

            // å†·ç†±è™Ÿåˆ†æ
            if (coldNumbers.length > 0) {
                reasons.push(`è¿‘${total}æœŸå†·è™Ÿ: ${coldNumbers.join(', ')}`);
            }
            if (hotNumbers.length > 0) {
                reasons.push(`è¿‘${total}æœŸç†±è™Ÿ: ${hotNumbers.join(', ')}`);
            }

            confidence = Math.min(confidence, 90);

            return {
                total,
                bigCount,
                smallCount,
                tripleCount,
                bigRatio,
                currentStreak,
                currentType,
                tripleGap,
                coldNumbers,
                hotNumbers,
                recentBig,
                recentSmall,
                confidence,
                reason: reasons.join('ï¼›') || 'æ•¸æ“šæ¨£æœ¬è¼ƒå°ï¼Œå»ºè­°è§€æœ›'
            };
        }

        // ç”ŸæˆæŠ•æ³¨å»ºè­°ï¼ˆä¿å®ˆ vs æ¿€é€²ç­–ç•¥æœ¬è³ªä¸åŒï¼‰
        function generateSuggestions(analysis) {
            const suggestions = [];
            const isConservative = currentStrategy === 'conservative';

            if (isConservative) {
                // ========== ä¿å®ˆç­–ç•¥ ==========
                // åŸå‰‡ï¼šåªæŠ¼å¤§å°ã€ç©©å¥ç²åˆ©ã€å¤šè¨Šè™Ÿé©—è­‰
                
                // è¨ˆç®—è¨Šè™Ÿå¼·åº¦
                let signalScore = 0;
                let targetBet = null; // 'big' or 'small'
                
                // è¨Šè™Ÿ1ï¼šé€£çºŒè¶¨å‹¢
                if (analysis.currentStreak >= 3 && analysis.currentType !== 'triple') {
                    signalScore += analysis.currentStreak >= 5 ? 3 : analysis.currentStreak >= 4 ? 2 : 1;
                    targetBet = analysis.currentType === 'big' ? 'small' : 'big';
                }
                
                // è¨Šè™Ÿ2ï¼šæ¯”ä¾‹å¤±è¡¡
                const deviation = Math.abs(analysis.bigRatio - 0.5);
                if (analysis.total >= 5 && deviation >= 0.25) {
                    signalScore += deviation >= 0.35 ? 3 : deviation >= 0.3 ? 2 : 1;
                    const underdogBet = analysis.bigRatio > 0.5 ? 'small' : 'big';
                    if (!targetBet) targetBet = underdogBet;
                }
                
                // è¨Šè™Ÿ3ï¼šè¿‘5æœŸæ¥µç«¯
                if (analysis.recentBig >= 4 || analysis.recentSmall >= 4) {
                    signalScore += 1;
                    const extremeBet = analysis.recentBig >= 4 ? 'small' : 'big';
                    if (!targetBet) targetBet = extremeBet;
                }
                
                // æ ¹æ“šè¨Šè™Ÿå¼·åº¦æ±ºå®šä¸‹æ³¨
                if (signalScore >= 2 && targetBet) {
                    let bets;
                    let reasons = [];
                    
                    if (analysis.currentStreak >= 3 && analysis.currentType !== 'triple') {
                        reasons.push(`é€£${analysis.currentStreak}æœŸ${analysis.currentType === 'big' ? 'å¤§' : 'å°'}`);
                    }
                    if (deviation >= 0.25) {
                        reasons.push(`å¤§å°æ¯”ä¾‹${(analysis.bigRatio * 100).toFixed(0)}%:${((1-analysis.bigRatio) * 100).toFixed(0)}%`);
                    }
                    if (analysis.recentBig >= 4) {
                        reasons.push(`è¿‘5æœŸå¤§${analysis.recentBig}æ¬¡`);
                    } else if (analysis.recentSmall >= 4) {
                        reasons.push(`è¿‘5æœŸå°${analysis.recentSmall}æ¬¡`);
                    }
                    
                    // è¨Šè™Ÿè¶Šå¼·ï¼Œä¸‹æ³¨è¶Šå¤š
                    if (signalScore >= 5) {
                        bets = 10;
                    } else if (signalScore >= 4) {
                        bets = 8;
                    } else if (signalScore >= 3) {
                        bets = 5;
                    } else {
                        bets = 3;
                    }
                    
                    suggestions.push({
                        type: `æŠ¼${targetBet === 'big' ? 'å¤§' : 'å°'}`,
                        reason: reasons.join('ï¼Œ'),
                        bets,
                        odds: 2
                    });
                }

                // ä¿å®ˆç­–ç•¥ä¸æŠ¼è±¹å­ï¼ˆè³ ç‡é«˜ä½†æ©Ÿç‡å¤ªä½ï¼‰
                
            } else {
                // ========== æ¿€é€²ç­–ç•¥ ==========
                // åŸå‰‡ï¼šè¿½æ±‚é«˜è³ ç‡ã€ä½é–€æª»è§¸ç™¼ã€å¤šå…ƒä¸‹æ³¨ã€å¯æ‰¿å—é¢¨éšª
                
                // 1. é€£çºŒè¶¨å‹¢åè½‰ï¼ˆé–€æª»è¼ƒä½ï¼šé€£çºŒ3æœŸå³è§¸ç™¼ï¼‰
                if (analysis.currentStreak >= 3 && analysis.currentType !== 'triple') {
                    const oppositeBet = analysis.currentType === 'big' ? 'å°' : 'å¤§';
                    let bets;
                    if (analysis.currentStreak >= 6) {
                        bets = 20;
                    } else if (analysis.currentStreak >= 5) {
                        bets = 15;
                    } else if (analysis.currentStreak >= 4) {
                        bets = 10;
                    } else {
                        bets = 6;
                    }
                    suggestions.push({
                        type: `æŠ¼${oppositeBet}`,
                        reason: `é€£${analysis.currentStreak}æœŸ${analysis.currentType === 'big' ? 'å¤§' : 'å°'}ï¼Œåè½‰æ©Ÿæœƒ`,
                        bets,
                        odds: 2
                    });
                }

                // 2. æ¯”ä¾‹å¤±è¡¡å›æ­¸ï¼ˆé–€æª»è¼ƒä½ï¼šåé›¢>20%ï¼‰
                if (analysis.total >= 5 && Math.abs(analysis.bigRatio - 0.5) > 0.2 && analysis.currentStreak < 3) {
                    const underdog = analysis.bigRatio > 0.5 ? 'å°' : 'å¤§';
                    suggestions.push({
                        type: `æŠ¼${underdog}`,
                        reason: `è¿‘${analysis.total}æœŸå¤§ä½”${(analysis.bigRatio * 100).toFixed(0)}%ï¼Œè¿½å›æ­¸`,
                        bets: 8,
                        odds: 2
                    });
                }

                // 3. è¿‘5æœŸæ¥µç«¯æƒ…æ³
                if (analysis.recentBig >= 4 && analysis.currentStreak < 3) {
                    const hasReverse = suggestions.some(s => s.type === 'æŠ¼å°');
                    if (!hasReverse) {
                        suggestions.push({
                            type: 'æŠ¼å°',
                            reason: `è¿‘5æœŸå¤§å‡º${analysis.recentBig}æ¬¡`,
                            bets: 5,
                            odds: 2
                        });
                    }
                } else if (analysis.recentSmall >= 4 && analysis.currentStreak < 3) {
                    const hasReverse = suggestions.some(s => s.type === 'æŠ¼å¤§');
                    if (!hasReverse) {
                        suggestions.push({
                            type: 'æŠ¼å¤§',
                            reason: `è¿‘5æœŸå°å‡º${analysis.recentSmall}æ¬¡`,
                            bets: 5,
                            odds: 2
                        });
                    }
                }

                // 4. è±¹å­æŠ•æ³¨ï¼ˆæ¿€é€²ç­–ç•¥ç¨æœ‰ï¼‰
                if (analysis.tripleGap >= 12) {
                    suggestions.push({
                        type: 'ä»»æ„è±¹å­',
                        reason: `å·²${analysis.tripleGap}æœŸæœªå‡ºè±¹å­`,
                        bets: analysis.tripleGap >= 20 ? 3 : 2,
                        odds: 30
                    });
                }

                // 5. æŒ‡å®šè±¹å­ï¼ˆæ¿€é€²ç­–ç•¥ç¨æœ‰ï¼Œè¿½ç†±è™Ÿï¼‰
                if (analysis.tripleGap >= 18 && analysis.hotNumbers.length > 0) {
                    suggestions.push({
                        type: `æŒ‡å®šè±¹å­ ${analysis.hotNumbers[0]}`,
                        reason: `ç†±è™Ÿ${analysis.hotNumbers[0]}ï¼Œæé«˜è³ `,
                        bets: 1,
                        odds: 150
                    });
                }
            }

            // é™åˆ¶ç¸½æ³¨æ•¸
            let totalBets = suggestions.reduce((sum, s) => sum + s.bets, 0);
            if (totalBets > MAX_BETS) {
                const ratio = MAX_BETS / totalBets;
                suggestions.forEach(s => {
                    s.bets = Math.max(1, Math.floor(s.bets * ratio));
                });
            }

            return suggestions;
        }

        // Enter éµå¿«é€Ÿè¼¸å…¥
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const active = document.activeElement;
                if (active.id === 'roundNum') {
                    document.getElementById('dice1').focus();
                } else if (active.id === 'dice1') {
                    document.getElementById('dice2').focus();
                } else if (active.id === 'dice2') {
                    document.getElementById('dice3').focus();
                } else if (active.id === 'dice3') {
                    addRecord();
                }
            }
        });

        // éª°å­è¼¸å…¥è‡ªå‹•è·³ä¸‹ä¸€æ ¼
        function setupAutoJump() {
            const dice1 = document.getElementById('dice1');
            const dice2 = document.getElementById('dice2');
            const dice3 = document.getElementById('dice3');

            dice1.addEventListener('input', (e) => {
                const val = e.target.value;
                if (val >= 1 && val <= 6) {
                    dice2.focus();
                    dice2.select();
                }
            });

            dice2.addEventListener('input', (e) => {
                const val = e.target.value;
                if (val >= 1 && val <= 6) {
                    dice3.focus();
                    dice3.select();
                }
            });

            dice3.addEventListener('input', (e) => {
                const val = e.target.value;
                if (val >= 1 && val <= 6) {
                    // ç¬¬ä¸‰é¡†è¼¸å…¥å®Œè‡ªå‹•é€å‡º
                    setTimeout(() => addRecord(), 100);
                }
            });
        }

        // åˆå§‹åŒ–
        loadRecords();
        updateDisplay();
        setupAutoJump();
        updateStrategyExplain();
    </script>
</body>
</html>
