<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜Ÿè© éª°å¯¶è¶¨å‹¢åˆ†æå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html {
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', -apple-system, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
            font-size: 16px;
            line-height: 1.5;
        }
        
        /* ===== çµ±ä¸€å­—é«”å¤§å°ç³»çµ± ===== */
        .text-xs { font-size: 0.75rem; }   /* 12px - æ¥µå°ï¼šæ¨™ç±¤ã€æç¤º */
        .text-sm { font-size: 0.875rem; }  /* 14px - å°ï¼šæ¬¡è¦è³‡è¨Š */
        .text-base { font-size: 1rem; }    /* 16px - åŸºæº–ï¼šæ­£æ–‡ */
        .text-lg { font-size: 1.125rem; }  /* 18px - å¤§ï¼šé‡è¦è³‡è¨Š */
        .text-xl { font-size: 1.25rem; }   /* 20px - ç‰¹å¤§ï¼šæ¨™é¡Œ */
        .text-2xl { font-size: 1.5rem; }   /* 24px - å€å¡Šæ¨™é¡Œ */

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            color: #ffd700;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card h2 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 10px;
        }

        /* è¼¸å…¥å€åŸŸ */
        .input-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
        }

        .dice-input {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dice-input label {
            font-weight: bold;
            color: #ffd700;
        }

        .dice-input input {
            width: 70px;
            height: 55px;
            font-size: 1.7rem;
            text-align: center;
            border: 2px solid #ffd700;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            appearance: textfield;
            -webkit-appearance: textfield;
            -moz-appearance: textfield;
        }
        
        .dice-input input::-webkit-outer-spin-button,
        .dice-input input::-webkit-inner-spin-button {
            appearance: none;
            -webkit-appearance: none;
            margin: 0;
        }

        .dice-input input:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .btn {
            padding: 14px 28px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            touch-action: manipulation;
            appearance: none;
            -webkit-appearance: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            color: #1a1a2e;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff4757, #ff3838);
            color: #fff;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px 18px;
            font-size: 0.95rem;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* ç•¶å‰çµæœé¡¯ç¤º */
        .current-result {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .dice-display {
            width: 60px;
            height: 60px;
            background: #fff;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: #1a1a2e;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .result-type {
            font-size: 1.8rem;
            font-weight: bold;
            padding: 10px 30px;
            border-radius: 10px;
        }

        .result-big { background: linear-gradient(135deg, #e74c3c, #c0392b); color: #fff; }
        .result-small { background: linear-gradient(135deg, #3498db, #2980b9); color: #fff; }
        .result-triple { background: linear-gradient(135deg, #ffd700, #ff8c00); color: #1a1a2e; animation: pulse 1s infinite; }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* æ­·å²è¨˜éŒ„è¡¨æ ¼ */
        .history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.05rem;
        }

        .history-table th,
        .history-table td {
            padding: 10px 6px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-table th {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
        }

        .history-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .history-container {
            max-height: 350px;
            overflow-y: auto;
        }

        .badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.95rem;
            font-weight: bold;
        }

        .badge-big { background: #e74c3c; }
        .badge-small { background: #3498db; }
        .badge-triple { background: #ffd700; color: #1a1a2e; }

        /* çµ±è¨ˆå€åŸŸ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 18px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 0.9375rem;
            margin-bottom: 10px;
            color: #aaa;
            font-weight: normal;
        }

        .stat-card .value {
            font-size: 2.25rem;
            font-weight: bold;
        }

        .stat-card .percentage {
            font-size: 0.9375rem;
            color: #888;
        }

        /* è¶¨å‹¢åˆ†æ */
        .trend-section {
            margin-bottom: 20px;
        }

        .trend-title {
            font-size: 1.15rem;
            margin-bottom: 10px;
            color: #ffd700;
        }

        .trend-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
        }

        .trend-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px 5px;
            text-align: center;
        }

        .trend-item .number {
            font-size: 1.375rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .trend-item .count {
            font-size: 0.875rem;
            color: #888;
        }

        .trend-item .status {
            font-size: 0.8125rem;
            padding: 4px 10px;
            border-radius: 10px;
            margin-top: 5px;
            display: inline-block;
        }

        .hot { background: #e74c3c; }
        .warm { background: #f39c12; }
        .cold { background: #3498db; }

        /* æŠ•æ³¨å»ºè­° */
        .strategy-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .strategy-btn {
            flex: 1;
            padding: 18px;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .strategy-btn.conservative { background: rgba(52, 152, 219, 0.3); color: #3498db; }
        .strategy-btn.aggressive { background: rgba(231, 76, 60, 0.3); color: #e74c3c; }
        .strategy-btn.active { border-color: currentColor; transform: scale(1.02); }

        .strategy-desc {
            font-size: 0.8rem;
            font-weight: normal;
            margin-top: 5px;
            opacity: 0.8;
        }

        .strategy-explain {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 1rem;
            line-height: 1.7;
            display: none;
        }

        .strategy-explain.show { display: block; }
        .strategy-explain .title { color: #ffd700; font-weight: bold; margin-bottom: 8px; }
        .strategy-explain ul { margin: 0; padding-left: 20px; color: #ccc; }
        .strategy-explain li { margin-bottom: 4px; }

        .bet-suggestion {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            font-size: 1.05rem;
        }

        .bet-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bet-item:last-child { border-bottom: none; }
        .bet-item .bet-type { font-weight: bold; font-size: 1.125rem; }
        .bet-item .bet-amount { color: #ffd700; font-weight: bold; font-size: 1.125rem; }
        .bet-item .bet-odds { color: #888; font-size: 0.875rem; }

        .total-bet {
            margin-top: 18px;
            padding-top: 18px;
            border-top: 2px solid rgba(255, 215, 0, 0.3);
            display: flex;
            justify-content: space-between;
            font-size: 1.125rem;
            font-weight: bold;
        }

        .total-bet .amount { color: #ffd700; }

        .confidence-meter {
            margin-top: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
        }

        .confidence-meter label { display: block; margin-bottom: 8px; color: #888; }
        .meter-bar { height: 20px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; overflow: hidden; }
        .meter-fill { height: 100%; border-radius: 10px; transition: width 0.5s; }
        .meter-low { background: linear-gradient(90deg, #3498db, #2ecc71); }
        .meter-medium { background: linear-gradient(90deg, #f39c12, #e74c3c); }
        .meter-high { background: linear-gradient(90deg, #e74c3c, #8e44ad); }

        .confidence-detail {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 18px;
            margin-top: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .confidence-detail .detail-title { color: #ffd700; font-weight: bold; margin-bottom: 12px; font-size: 1.1rem; }
        .confidence-detail .detail-content { font-size: 1rem; color: #ccc; }
        .confidence-detail .detail-table { width: 100%; margin: 10px 0; }
        .confidence-detail .detail-table td { padding: 8px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .confidence-detail .detail-table .val { text-align: right; color: #2ecc71; font-weight: bold; }

        .confidence-levels { display: flex; gap: 12px; margin-top: 15px; flex-wrap: wrap; }
        .confidence-levels .level { padding: 6px 14px; border-radius: 15px; font-size: 0.95rem; }
        .confidence-levels .low { background: rgba(52, 152, 219, 0.3); color: #3498db; }
        .confidence-levels .medium { background: rgba(243, 156, 18, 0.3); color: #f39c12; }
        .confidence-levels .high { background: rgba(231, 76, 60, 0.3); color: #e74c3c; }

        /* è·¯å–®é¡¯ç¤º */
        .roadmap { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 15px; }
        .roadmap-cell {
            width: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
        }
        .roadmap-main {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.875rem;
            font-weight: bold;
            color: #fff;
            cursor: pointer;
        }
        .roadmap-dice {
            display: flex;
            gap: 2px;
            justify-content: center;
        }
        .roadmap-dice-dot {
            width: 11px;
            height: 11px;
            border-radius: 50%;
            font-size: 0.55rem;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-weight: bold;
            cursor: help;
        }
        .dice-hot { background: #e74c3c; }
        .dice-warm { background: #f39c12; }
        .dice-cold { background: #3498db; }

        .roadmap-big { background: #e74c3c; }
        .roadmap-small { background: #3498db; }
        .roadmap-triple { background: #ffd700; color: #1a1a2e; }

        /* è³ ç‡èªªæ˜ */
        .odds-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
            padding: 18px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .odds-item { text-align: center; }
        .odds-item .type { font-size: 1.05rem; color: #888; }
        .odds-item .odds { font-size: 1.35rem; font-weight: bold; color: #ffd700; }

        .warning-text {
            color: #f39c12;
            font-size: 0.9rem;
            margin-top: 10px;
            padding: 10px;
            background: rgba(243, 156, 18, 0.1);
            border-radius: 8px;
            border-left: 3px solid #f39c12;
        }

        /* åŒ¯å…¥åŒ¯å‡º */
        .import-export {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .import-area {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .import-area textarea {
            width: 100%;
            height: 120px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #ffd700;
            border-radius: 8px;
            color: #fff;
            padding: 10px;
            font-family: monospace;
            font-size: 0.95rem;
            resize: vertical;
        }

        .import-area .hint {
            color: #888;
            font-size: 0.85rem;
            margin-top: 8px;
        }

        /* ============================================================ */
        /* æ‰‹æ©Ÿç‰ˆéŸ¿æ‡‰å¼è¨­è¨ˆ */
        /* ============================================================ */
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 16px;
            }
            
            h1 {
                font-size: 1.6rem;
                margin-bottom: 15px;
            }
            
            .card {
                padding: 12px;
                border-radius: 10px;
            }
            
            .card h2 {
                font-size: 1.2rem;
                margin-bottom: 10px;
            }
            
            /* è¼¸å…¥å€åŸŸæ‰‹æ©Ÿç‰ˆ */
            .input-section {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .dice-input {
                display: flex;
                justify-content: space-between;
                width: 100%;
            }
            
            .dice-input label {
                min-width: 50px;
            }
            
            .dice-input input {
                flex: 1;
                width: auto;
                height: 50px;
                font-size: 1.4rem;
            }
            
            .dice-input input[type="text"] {
                max-width: none;
            }
            
            .btn {
                width: 100%;
                padding: 14px 20px;
                font-size: 1.1rem;
            }
            
            /* ç•¶å‰çµæœæ‰‹æ©Ÿç‰ˆ */
            .current-result {
                padding: 12px;
                gap: 10px;
            }
            
            .dice-display {
                width: 48px;
                height: 48px;
                font-size: 1.5rem;
            }
            
            .result-type {
                font-size: 1.3rem;
                padding: 8px 16px;
            }
            
            /* è³ ç‡èªªæ˜æ‰‹æ©Ÿç‰ˆ */
            .odds-info {
                grid-template-columns: 1fr;
                gap: 8px;
                padding: 12px;
            }
            
            .odds-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .odds-item .type {
                font-size: 1rem;
            }
            
            .odds-item .odds {
                font-size: 1.1rem;
            }
            
            /* è·¯å–®æ‰‹æ©Ÿç‰ˆ */
            .roadmap {
                gap: 5px;
            }
            
            .roadmap-cell {
                width: 34px;
            }
            
            .roadmap-main {
                width: 26px;
                height: 26px;
                font-size: 0.75rem;
            }
            
            .roadmap-dice-dot {
                width: 8px;
                height: 8px;
            }
            
            /* çµ±è¨ˆå€å¡Šæ‰‹æ©Ÿç‰ˆ */
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
            
            .stat-card {
                padding: 10px 5px;
            }
            
            .stat-card h3 {
                font-size: 0.75rem;
            }
            
            .stat-card .value {
                font-size: 1.4rem;
            }
            
            .stat-card .percentage {
                font-size: 0.75rem;
            }
            
            /* è¶¨å‹¢å€å¡Šæ‰‹æ©Ÿç‰ˆ */
            .trend-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }
            
            .trend-item {
                padding: 8px 5px;
                font-size: 0.85rem;
            }
            
            .trend-item .number {
                font-size: 1.2rem;
            }
            
            /* ç­–ç•¥åˆ‡æ›æ‰‹æ©Ÿç‰ˆ */
            .strategy-toggle {
                flex-direction: column;
                gap: 10px;
            }
            
            .strategy-btn {
                padding: 12px;
                font-size: 1rem;
            }
            
            .strategy-desc {
                font-size: 0.8rem;
            }
            
            /* ç­–ç•¥èªªæ˜æ‰‹æ©Ÿç‰ˆ */
            .strategy-explain {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            .strategy-explain ul {
                padding-left: 15px;
            }
            
            /* æŠ•æ³¨å»ºè­°æ‰‹æ©Ÿç‰ˆ */
            .bet-suggestion {
                padding: 12px;
            }
            
            .suggestion-item {
                padding: 12px;
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .suggestion-item .bet-type {
                font-size: 1.1rem;
            }
            
            .suggestion-item .bet-amount {
                font-size: 1.2rem;
            }
            
            /* ä¿¡å¿ƒæŒ‡æ•¸æ‰‹æ©Ÿç‰ˆ */
            .confidence-meter {
                padding: 12px;
            }
            
            .confidence-levels {
                flex-direction: column;
                gap: 8px;
            }
            
            .confidence-detail {
                font-size: 0.85rem;
                padding: 12px;
            }
            
            /* æ­·å²è¡¨æ ¼æ‰‹æ©Ÿç‰ˆ */
            .history-table {
                font-size: 0.85rem;
            }
            
            .history-table th,
            .history-table td {
                padding: 8px 4px;
            }
            
            .history-table .btn {
                width: auto;
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            
            /* åŒ¯å…¥åŒ¯å‡ºæ‰‹æ©Ÿç‰ˆ */
            .import-export {
                flex-direction: column;
            }
            
            .import-area textarea {
                height: 100px;
                font-size: 0.9rem;
            }
            
            /* é¾å‹¢åœ–ä¾‹æ‰‹æ©Ÿç‰ˆ */
            .dragon-legend {
                font-size: 0.8rem;
                line-height: 1.6;
            }
        }
        
        /* æ›´å°è¢å¹•ï¼ˆiPhone SE ç­‰ï¼‰*/
        @media (max-width: 375px) {
            body {
                padding: 8px;
                font-size: 14px;
            }
            
            h1 {
                font-size: 1.4rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .stat-card .value {
                font-size: 1.2rem;
            }
            
            .dice-display {
                width: 42px;
                height: 42px;
                font-size: 1.3rem;
            }
            
            .roadmap-cell {
                width: 30px;
            }
            
            .roadmap-main {
                width: 22px;
                height: 22px;
                font-size: 0.7rem;
            }
            
            .roadmap-dice-dot {
                width: 7px;
                height: 7px;
            }
            
            .trend-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ² æ˜Ÿè© éª°å¯¶è¶¨å‹¢åˆ†æå™¨ ğŸ²</h1>

        <div class="main-grid">
            <!-- å·¦å´ï¼šè¼¸å…¥èˆ‡è¨˜éŒ„ -->
            <div>
                <div class="card">
                    <h2>ğŸ“ è¼¸å…¥é–‹ççµæœ</h2>
                    <div class="input-section">
                        <div class="dice-input">
                            <label>æœŸæ•¸:</label>
                            <input type="text" id="roundNum" placeholder="å¦‚:001" style="width: 80px;">
                        </div>
                        <div class="dice-input">
                            <label>éª°1:</label>
                            <input type="number" id="dice1" min="1" max="6" placeholder="1-6" inputmode="numeric" pattern="[1-6]">
                        </div>
                        <div class="dice-input">
                            <label>éª°2:</label>
                            <input type="number" id="dice2" min="1" max="6" placeholder="1-6" inputmode="numeric" pattern="[1-6]">
                        </div>
                        <div class="dice-input">
                            <label>éª°3:</label>
                            <input type="number" id="dice3" min="1" max="6" placeholder="1-6" inputmode="numeric" pattern="[1-6]">
                        </div>
                        <button class="btn btn-primary" onclick="addRecord()">æ–°å¢è¨˜éŒ„</button>
                        <button class="btn btn-danger" onclick="clearRecords()">æ¸…é™¤å…¨éƒ¨</button>
                    </div>

                    <div class="current-result" id="currentResult" style="display: none;">
                        <div style="text-align: center; margin-right: 15px;">
                            <div style="color: #888; font-size: 0.8rem;">æœ€æ–°æœŸæ•¸</div>
                            <div style="color: #ffd700; font-size: 1.5rem; font-weight: bold;" id="displayRound">-</div>
                        </div>
                        <div class="dice-display" id="display1">-</div>
                        <div class="dice-display" id="display2">-</div>
                        <div class="dice-display" id="display3">-</div>
                        <span>=</span>
                        <div class="dice-display" id="displaySum">-</div>
                        <div class="result-type" id="resultType">-</div>
                    </div>

                    <div class="odds-info">
                        <div class="odds-item"><div class="type">å¤§/å°</div><div class="odds">1 è³  2</div></div>
                        <div class="odds-item"><div class="type">è±¹å­</div><div class="odds">1 è³  30</div></div>
                        <div class="odds-item"><div class="type">æŒ‡å®šè±¹å­</div><div class="odds">1 è³  150</div></div>
                    </div>

                    <div class="import-export">
                        <button class="btn btn-secondary" onclick="exportData()">ğŸ“¤ åŒ¯å‡ºè³‡æ–™</button>
                        <button class="btn btn-secondary" onclick="toggleImport()">ğŸ“¥ åŒ¯å…¥è³‡æ–™</button>
                    </div>

                    <div class="import-area" id="importArea">
                        <textarea id="importText" placeholder="æ ¼å¼ï¼šæ¯è¡Œä¸€ç­†ï¼ŒæœŸæ•¸ éª°1 éª°2 éª°3ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰&#10;ä¾‹å¦‚ï¼š&#10;001 4 5 6&#10;002 2 2 2&#10;003 1 3 5"></textarea>
                        <div class="hint">æ”¯æ´æ ¼å¼ï¼šã€ŒæœŸæ•¸ éª°1 éª°2 éª°3ã€ï¼Œæ¯è¡Œä¸€ç­†ï¼Œç©ºæ ¼æˆ–é€—è™Ÿåˆ†éš”</div>
                        <button class="btn btn-primary" style="margin-top: 10px;" onclick="importData()">ç¢ºèªåŒ¯å…¥</button>
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>ğŸ›¤ï¸ è·¯å–® (å¤§å°èµ°å‹¢ + éª°å­å†·ç†±)</h2>
                    <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 10px; font-size: 0.8125rem; color: #aaa;">
                        <span>çµæœï¼š<span style="color: #e74c3c;">â—å¤§</span> <span style="color: #3498db;">â—å°</span> <span style="color: #ffd700;">â—è±¹</span></span>
                        <span>éª°å­ï¼š<span style="color: #e74c3c;">â—ç†±</span> <span style="color: #f39c12;">â—æº«</span> <span style="color: #3498db;">â—å†·</span></span>
                    </div>
                    <div class="roadmap" id="roadmap"></div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>ğŸ“œ æ­·å²è¨˜éŒ„ (æœ€å¤š100ç­†)</h2>
                    <div class="history-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>æœŸæ•¸</th>
                                    <th>éª°1</th>
                                    <th>éª°2</th>
                                    <th>éª°3</th>
                                    <th>ç¸½å’Œ</th>
                                    <th>çµæœ</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="historyBody"></tbody>
                        </table>
                    </div>
                    <p style="text-align: center; color: #888; margin-top: 10px;" id="recordCount">ç›®å‰ 0 ç­†è¨˜éŒ„</p>
                </div>
            </div>

            <!-- å³å´ï¼šçµ±è¨ˆèˆ‡ç­–ç•¥ -->
            <div>
                <div class="card">
                    <h2>ğŸ“Š çµ±è¨ˆåˆ†æ <span id="analysisRange" style="font-size: 0.8rem; color: #888; font-weight: normal;"></span></h2>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>å¤§</h3>
                            <div class="value" style="color: #e74c3c;" id="bigCount">0</div>
                            <div class="percentage" id="bigPercent">0%</div>
                            <div class="percentage" id="bigCountAll" style="font-size: 0.8rem; margin-top: 5px;">å…¨0æœŸ: 0</div>
                        </div>
                        <div class="stat-card">
                            <h3>å°</h3>
                            <div class="value" style="color: #3498db;" id="smallCount">0</div>
                            <div class="percentage" id="smallPercent">0%</div>
                            <div class="percentage" id="smallCountAll" style="font-size: 0.8rem; margin-top: 5px;">å…¨0æœŸ: 0</div>
                        </div>
                        <div class="stat-card">
                            <h3>è±¹å­</h3>
                            <div class="value" style="color: #ffd700;" id="tripleCount">0</div>
                            <div class="percentage" id="triplePercent">0%</div>
                            <div class="percentage" id="tripleCountAll" style="font-size: 0.8rem; margin-top: 5px;">å…¨0æœŸ: 0</div>
                        </div>
                    </div>

                    <div class="trend-section">
                        <div class="trend-title">ğŸ¯ è·¯å‹åˆ†æï¼ˆæ ¸å¿ƒç­–ç•¥ä¾æ“šï¼‰</div>
                        <div class="stats-grid">
                            <div class="stat-card" style="flex: 2;">
                                <h3>ç•¶å‰è·¯å‹</h3>
                                <div class="value" id="patternType" style="font-size: 1.3rem;">-</div>
                                <div class="percentage" id="patternDesc">ç­‰å¾…æ›´å¤šæ•¸æ“š</div>
                            </div>
                            <div class="stat-card">
                                <h3>è·¯å‹ä¿¡å¿ƒ</h3>
                                <div class="value" id="patternConfidence" style="color: #ffd700;">-</div>
                            </div>
                            <div class="stat-card">
                                <h3>é æ¸¬ä¸‹æœŸ</h3>
                                <div class="value" id="patternPredict">-</div>
                            </div>
                        </div>
                        <div class="pattern-legend" style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px; font-size: 0.85rem; color: #888;">
                            <span style="color: #9b59b6;">ğŸ”€ å–®è·³</span>ï¼šå¤§å°å¤§å°äº¤æ›¿ ï½œ
                            <span style="color: #3498db;">ğŸ”„ é›™è·³</span>ï¼šå¤§å¤§å°å°æˆå° ï½œ
                            <span style="color: #2ecc71;">ğŸ‰ é•·é¾</span>ï¼šé€£çºŒåŒå‘ ï½œ
                            <span style="color: #888;">ğŸ“Š äº‚è·¯</span>ï¼šç„¡è¦å¾‹
                        </div>
                    </div>

                    <div class="trend-section">
                        <div class="trend-title">ğŸ‰ é¾å‹¢åˆ†æï¼ˆå¤§/å°ï¼Œè±¹å­è¦–ç‚ºä¸­æ–·ï¼‰</div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>ç•¶å‰é¾æ³</h3>
                                <div class="value" id="currentStreak">-</div>
                                <div class="percentage" id="streakType">-</div>
                                <div class="percentage" id="dragonStatus" style="margin-top: 5px; font-weight: bold;">-</div>
                            </div>
                            <div class="stat-card">
                                <h3>æœ€é•·å¤§é¾</h3>
                                <div class="value" style="color: #e74c3c;" id="maxBigStreak">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>æœ€é•·å°é¾</h3>
                                <div class="value" style="color: #3498db;" id="maxSmallStreak">0</div>
                            </div>
                        </div>
                        <div class="dragon-legend" style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px; font-size: 0.85rem; color: #888;">
                            <span style="color: #2ecc71;">ğŸ‰ é•·é¾</span>ï¼šé€£3æœŸä»¥ä¸Š ï½œ
                            <span style="color: #e74c3c;">âš”ï¸ æ–·é¾</span>ï¼šé€£7æœŸä»¥ä¸Š ï½œ
                            <span style="color: #f39c12;">ğŸ”„ å›é¾</span>ï¼šæ–·é¾å¾Œå¸¸è·³å›
                        </div>
                    </div>
                </div>

                <!-- å„éª°å­ç¨ç«‹åˆ†æ -->
                <div class="card" style="margin-top: 20px;">
                    <h2 onclick="toggleDiceDetail()" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center;">ğŸ² å„éª°å­å†·ç†±åˆ†æ <span style="font-size: 0.75rem; color: #888; font-weight: normal;">â“˜ é»æ“ŠæŸ¥çœ‹è©³æƒ…</span></h2>
                    
                    <div id="diceAnalysisDetail" class="confidence-detail" style="display: none; margin-bottom: 15px;">
                        <div class="detail-title">ğŸ² å†·æº«ç†±å®šç¾©èªªæ˜</div>
                        <div class="detail-content">
                            <p><strong>ä¸‰é¡†éª°å­ç¨ç«‹çµ±è¨ˆ</strong>ï¼šåˆ†åˆ¥è¨˜éŒ„éª°å­1ã€2ã€3å„é»æ•¸å‡ºç¾æ¬¡æ•¸</p>
                            <table class="detail-table">
                                <tr><th colspan="2" style="color: #e74c3c; text-align: left;">ğŸ”¥ ç†±è™Ÿï¼ˆå‡ºç¾é »ç‡é«˜ï¼‰</th></tr>
                                <tr><td>å®šç¾©</td><td class="val">å‡ºç¾æ¬¡æ•¸ â‰¥ å¹³å‡å€¼ Ã— 1.5</td></tr>
                                <tr><td>æ„ç¾©</td><td class="val">è©²é»æ•¸è¿‘æœŸå‡ºç¾é »ç¹</td></tr>
                                <tr><th colspan="2" style="color: #f39c12; text-align: left; padding-top: 8px;">ğŸŒ¡ï¸ æº«è™Ÿï¼ˆå‡ºç¾é »ç‡æ­£å¸¸ï¼‰</th></tr>
                                <tr><td>å®šç¾©</td><td class="val">å‡ºç¾æ¬¡æ•¸ä»‹æ–¼å†·ç†±ä¹‹é–“</td></tr>
                                <tr><td>æ„ç¾©</td><td class="val">è©²é»æ•¸å‡ºç¾é »ç‡æ¥è¿‘ç†è«–å€¼</td></tr>
                                <tr><th colspan="2" style="color: #3498db; text-align: left; padding-top: 8px;">â„ï¸ å†·è™Ÿï¼ˆå‡ºç¾é »ç‡ä½ï¼‰</th></tr>
                                <tr><td>å®šç¾©</td><td class="val">å‡ºç¾æ¬¡æ•¸ â‰¤ å¹³å‡å€¼ Ã— 0.5</td></tr>
                                <tr><td>æ„ç¾©</td><td class="val">è©²é»æ•¸è¿‘æœŸè¼ƒå°‘å‡ºç¾</td></tr>
                                <tr><th colspan="2" style="color: #ffd700; text-align: left; padding-top: 8px;">âš–ï¸ æ¬Šé‡è¨ˆç®—</th></tr>
                                <tr><td>å‰10æœŸ</td><td class="val">æ¬Šé‡ Ã—2ï¼ˆé‡é»åƒè€ƒï¼‰</td></tr>
                                <tr><td>10æœŸä»¥å¾Œ</td><td class="val">æ¬Šé‡ Ã—1ï¼ˆä¸€èˆ¬åƒè€ƒï¼‰</td></tr>
                            </table>
                            <div style="margin-top: 12px; padding: 10px; background: rgba(155, 89, 182, 0.1); border-radius: 8px; border-left: 3px solid #9b59b6;">
                                <strong style="color: #9b59b6;">ğŸ² è±¹å­å¨›æ¨‚åƒè€ƒ</strong>
                                <p style="font-size: 0.85em; margin-top: 5px;">ç•¶ä¸‰é¡†éª°å­æœ‰<strong>å…±åŒå†·/æº«/ç†±è™Ÿ</strong>æ™‚ï¼Œå¯ä½œç‚ºè±¹å­æŠ•æ³¨çš„é¸è™Ÿåƒè€ƒï¼š</p>
                                <ul style="font-size: 0.85em; margin: 5px 0 0 15px; color: #ccc;">
                                    <li><span style="color:#e74c3c;">ğŸ”¥ å…±åŒç†±è™Ÿ</span>ï¼šä¸‰é¡†éƒ½å¸¸é–‹æ­¤é»ï¼Œã€Œèªªä¸å®šæœƒå°ä¸Šã€</li>
                                    <li><span style="color:#3498db;">â„ï¸ å…±åŒå†·è™Ÿ</span>ï¼šä¸‰é¡†éƒ½å°‘é–‹æ­¤é»ï¼Œã€Œè©²å›ä¾†äº†å§ã€</li>
                                </ul>
                                <p style="font-size: 0.8em; margin-top: 8px; color: #f39c12;">âš ï¸ æ³¨æ„ï¼šè±¹å­æ©Ÿç‡å›ºå®š2.78%ï¼Œæ­¤åˆ†æç´”å±¬å¨›æ¨‚åƒè€ƒï¼Œéç§‘å­¸é æ¸¬ã€‚</p>
                            </div>
                            <p style="margin-top: 10px; color: #888; font-size: 0.85rem;">â€» ç†è«–ä¸Šæ¯é»æ•¸å‡ºç¾æ©Ÿç‡ç‚º 1/6 â‰ˆ 16.67%</p>
                        </div>
                    </div>
                    
                    <div id="individualDiceAnalysis" style="margin-top: 10px;">
                        <p style="color: #888; text-align: center;">éœ€è¦è‡³å°‘5ç­†è¨˜éŒ„</p>
                    </div>
                    <div id="tripleOpportunity" style="margin-top: 15px; display: none;"></div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2 onclick="toggleStrategyDetail()" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 5px;">
                        <span>ğŸ’° æ™ºèƒ½æŠ•æ³¨å»ºè­° <span id="nextRoundHint" style="font-size: 0.85rem; color: #ffd700;"></span></span>
                        <span style="font-size: 0.75rem; color: #888; font-weight: normal;">â“˜ é»æ“ŠæŸ¥çœ‹ç­–ç•¥è©³è§£</span>
                    </h2>
                    
                    <!-- ç­–ç•¥è©³è§£ï¼ˆé»æ“Šæ¨™é¡Œå±•é–‹ï¼‰ -->
                    <div class="confidence-detail" id="strategyDetail" style="display: none; margin-bottom: 15px;">
                        <div class="detail-title">ğŸ“Š å°ˆæ¥­æŠ•æ³¨ç­–ç•¥è©³è§£</div>
                        <div class="detail-content">
                            <p><strong>éª°å¯¶å°ˆå®¶ç­–ç•¥</strong>ï¼šåŸºæ–¼å¯¦æˆ°ç¶“é©—å„ªåŒ–ï¼Œé¢¨éšªæ§åˆ¶å„ªå…ˆ</p>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(155, 89, 182, 0.15); border-radius: 8px; border-left: 3px solid #9b59b6;">
                                <strong style="color: #9b59b6;">ğŸ¯ å„ªå…ˆç´š1ï¼šè·¯å‹åˆ†æï¼ˆæ ¸å¿ƒç­–ç•¥ï¼‰</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li><strong>åˆ†æç¯„åœ</strong>ï¼šè¿‘20æœŸï¼ˆå‰10æœŸæ¬Šé‡Ã—2ï¼Œæ›´è²¼è¿‘ç•¶å‰è¶¨å‹¢ï¼‰</li>
                                    <li><strong>å–®è·³è·¯</strong>ï¼šåŠ æ¬Šäº¤æ›¿ç‡â‰¥65%æ‰è§¸ç™¼</li>
                                    <li><strong>é›™è·³è·¯</strong>ï¼šåŠ æ¬Šæˆå°ç‡â‰¥55%ï¼Œéœ€6æœŸä»¥ä¸Šæ•¸æ“š</li>
                                    <li>è·¯å‹æ˜¯éª°å¯¶æœ€å¯é çš„è¦å¾‹ä¹‹ä¸€ï¼Œå„ªå…ˆæ¡ç”¨</li>
                                </ul>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(46, 204, 113, 0.15); border-radius: 8px; border-left: 3px solid #2ecc71;">
                                <strong style="color: #2ecc71;">ğŸ‰ å„ªå…ˆç´š2ï¼šé¾å‹¢ç­–ç•¥ï¼ˆå°ˆæ¥­æ ¸å¿ƒï¼‰</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li><strong>è·Ÿé¾</strong>ï¼š3-5æœŸæ˜¯é»ƒé‡‘æœŸï¼Œè¶…é5æœŸé¢¨éšªå¢åŠ ï¼ˆä¿¡å¿ƒåº¦éæ¸›ï¼‰</li>
                                    <li><strong>æ–·é¾</strong>ï¼š<span style="color:#e74c3c;">é€£7æœŸä»¥ä¸Šæ‰è§¸ç™¼</span>ï¼Œå›ºå®š2-3æ³¨ï¼ˆé«˜é¢¨éšªé€†å‹¢æ“ä½œï¼‰</li>
                                    <li><strong>å›é¾</strong>ï¼šé•·é¾ï¼ˆ6æœŸ+ï¼‰å‰›æ–·å¾ŒæŠ¼å›ï¼Œç´„60%å›å½ˆç‡</li>
                                    <li style="color:#f39c12;">âš ï¸ æ–·é¾æ˜¯æœ€å±éšªçš„æ“ä½œï¼Œåˆ‡å‹¿è¿½åŠ </li>
                                </ul>
                                <div style="margin-top: 10px; padding: 8px; background: rgba(231, 76, 60, 0.2); border-radius: 6px;">
                                    <strong style="color: #e74c3c; font-size: 0.85em;">ğŸ›¡ï¸ æ–·é¾é™åˆ¶æ¢ä»¶</strong>
                                    <ul style="font-size: 0.8em; color: #aaa; margin: 5px 0 0 10px;">
                                        <li>é€£çºŒå¤±æ•—2æ¬¡ä»¥ä¸Š â†’ å†·å»æœŸï¼ˆå¤±æ•—æ¬¡æ•¸Ã—2æœŸï¼‰</li>
                                        <li>è±¹å­å‡ºç¾å¾Œè‡³å°‘1æœŸå…§ç¦ç”¨</li>
                                        <li><strong>ç¦æ­¢åŠ ç¢¼</strong>ï¼šå›ºå®šæœ€å¤§2æ³¨</li>
                                    </ul>
                                </div>
                                <div style="margin-top: 10px; padding: 8px; background: rgba(241, 196, 15, 0.2); border-radius: 6px;">
                                    <strong style="color: #f1c40f; font-size: 0.85em;">âš ï¸ è·Ÿé¾æœ€å¤§å®¹å¿é•·åº¦</strong>
                                    <ul style="font-size: 0.8em; color: #aaa; margin: 5px 0 0 10px;">
                                        <li>é€£çºŒ6æœŸä»¥ä¸Šï¼šé–‹å§‹é™ç´šæ¸›æ³¨</li>
                                        <li>é€£çºŒ8æœŸä»¥ä¸Šï¼š<strong>å¼·åˆ¶è§€æœ›</strong>ï¼Œé¿å…æ¥µç«¯è·¯å‹è¿½å–®</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(52, 152, 219, 0.15); border-radius: 8px; border-left: 3px solid #3498db;">
                                <strong style="color: #3498db;">ğŸ“Š å„ªå…ˆç´š3ï¼šæ¯”ä¾‹å›æ­¸ï¼ˆå¤šæ¢ä»¶é™åˆ¶ï¼‰</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li>éœ€åé›¢ç­‰ç´šâ‰¥3 ä¸” 10æœŸä»¥ä¸Šæ•¸æ“š</li>
                                    <li><strong>ä¸å¯å­˜åœ¨é•·é¾</strong>ï¼ˆé€£çºŒ<4æœŸï¼‰æ‰è§¸ç™¼</li>
                                    <li>å›æ­¸æ™‚æ©Ÿé›£ä»¥é æ¸¬ï¼Œ<span style="color:#f39c12;">åƒ…ä½œç‚ºè¼”åŠ©åŠ æŒ</span></li>
                                </ul>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(155, 89, 182, 0.15); border-radius: 8px; border-left: 3px solid #9b59b6;">
                                <strong style="color: #9b59b6;">ğŸ° è±¹å­å¨›æ¨‚æç¤ºï¼ˆå®Œå…¨ç¨ç«‹ï¼‰</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li>ä¸‰éª°å…±åŒè™Ÿç¢¼ï¼šğŸ”¥ç†±è™Ÿï¼ˆéƒ½å¸¸é–‹ï¼‰æˆ– â„ï¸å†·è™Ÿï¼ˆéƒ½å°‘é–‹ï¼‰</li>
                                    <li>15æœŸä»¥ä¸Šæœªå‡ºæ‰é¡¯ç¤ºï¼Œå…©éª°å…±åŒéœ€20æœŸ</li>
                                    <li><span style="color:#e74c3c;">âš ï¸ è±¹å­æ©Ÿç‡å›ºå®š2.78%ï¼Œæ­·å²ä¸å½±éŸ¿æœªä¾†</span></li>
                                </ul>
                                <div style="margin-top: 10px; padding: 8px; background: rgba(231, 76, 60, 0.2); border-radius: 6px;">
                                    <strong style="color: #e74c3c; font-size: 0.85em;">âš ï¸ åš´æ ¼é™åˆ¶</strong>
                                    <ul style="font-size: 0.8em; color: #aaa; margin: 5px 0 0 10px;">
                                        <li><strong>ä¸èˆ‡å¤§å°ç­–ç•¥ç–ŠåŠ </strong>ï¼šç¨ç«‹è¨ˆç®—ï¼Œä¸å½±éŸ¿ä¸»å»ºè­°</li>
                                        <li><strong>ä¸æé«˜ä¿¡å¿ƒåº¦</strong>ï¼šè¨Šè™Ÿå¼·åº¦å›ºå®šç‚º0</li>
                                        <li><strong>å›ºå®š1æ³¨ï¼Œç¦æ­¢åŠ ç¢¼</strong></li>
                                        <li>ç´”å¨›æ¨‚æç¤ºï¼Œéç§‘å­¸é æ¸¬</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(243, 156, 18, 0.15); border-radius: 8px; border-left: 3px solid #f39c12;">
                                <strong style="color: #f39c12;">ğŸ“ˆ å„ªå…ˆç´š5-6ï¼šè¶¨å‹¢èˆ‡æ¥µç«¯</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li><strong>è¶¨å‹¢å»¶çºŒ</strong>ï¼šé€£2æœŸï¼Œä¿¡è™Ÿè¼ƒå¼±ï¼Œæœ€å°æ³¨è§€å¯Ÿ</li>
                                    <li><strong>çŸ­æœŸæ¥µç«¯</strong>ï¼šè¿‘5æœŸæŸæ–¹4æ¬¡ä»¥ä¸Šï¼Œå¯èƒ½åè½‰</li>
                                </ul>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(136, 136, 136, 0.15); border-radius: 8px; border-left: 3px solid #888;">
                                <strong style="color: #888;">ğŸ’¡ å„ªå…ˆç´š7ï¼šäº‚è·¯åˆ†æï¼ˆæ”¹é€²ç‰ˆï¼‰</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #aaa;">
                                    <li>åˆ†æè¿‘5æœŸè®ŠåŒ–ç¯€å¥ï¼ˆè®ŠåŒ–ç‡ï¼‰</li>
                                    <li>é«˜è®ŠåŒ–ç‡å‚¾å‘è·³ï¼Œä½è®ŠåŒ–ç‡é †å‹¢</li>
                                    <li>å›ºå®šæœ€å°æ³¨ï¼Œä¿¡è™Ÿå¼±æ™‚å¯§å¯å°‘æŠ¼</li>
                                </ul>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(231, 76, 60, 0.2); border-radius: 8px; border-left: 3px solid #e74c3c;">
                                <strong style="color: #e74c3c;">ğŸ›‘ æ­¢ææ©Ÿåˆ¶ï¼ˆé‡è¦ï¼‰</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li>è¿‘æœŸå‹ç‡<30%æ™‚ï¼Œå¼·åˆ¶æ¸›æ³¨ä¸¦è­¦å‘Š</li>
                                    <li>é€£çºŒè™§ææ™‚å»ºè­°æš«åœæˆ–è§€æœ›</li>
                                    <li><strong>è³‡é‡‘ç®¡ç†æ¯”é æ¸¬æ›´é‡è¦</strong></li>
                                </ul>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(231, 76, 60, 0.15); border-radius: 8px; border-left: 3px solid #e74c3c;">
                                <strong style="color: #e74c3c;">âš ï¸ ç­–ç•¥èª¿æ•´æ ¸å¿ƒåŸå‰‡</strong>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li><strong>æœ€å°æ¨£æœ¬æ•¸é™åˆ¶</strong>ï¼šç­–ç•¥é ˆç´¯ç© <strong>â‰¥20æœŸ</strong> æ•¸æ“šæ‰å•Ÿå‹•ç¸¾æ•ˆå›é¥‹</li>
                                    <li><strong>ç¦æ­¢å› çŸ­æœŸå‹ç‡ä¸Šå‡è€ŒåŠ ç¢¼</strong>ï¼šå‹ç‡å¥½åªèƒ½å›åˆ°åŸºæº–æ³¨ç¢¼ï¼Œä¸åŠ ç¢¼</li>
                                    <li><strong>å‹ç‡èª¿æ•´åƒ…ç”¨æ–¼é¢¨éšªæ§åˆ¶</strong>ï¼šé™ä½é¢¨éšªæˆ–åœç”¨ç­–ç•¥</li>
                                    <li><strong>çµ±è¨ˆæ¶µè“‹æ‰€æœ‰ä¸‹æ³¨æœŸ</strong>ï¼šä¸æ’é™¤ä¸åˆ©çµæœï¼Œè±¹å­é€šæ®ºè¨ˆå…¥æ•—ç¸¾</li>
                                </ul>
                            </div>
                            
                            <div style="margin: 15px 0; padding: 12px; background: rgba(155, 89, 182, 0.2); border-radius: 8px; border-left: 3px solid #9b59b6;">
                                <strong style="color: #9b59b6;">ğŸ”„ ç­–ç•¥è‡ªé©æ‡‰ç³»çµ±</strong>
                                <p style="font-size: 0.85em; color: #ccc; margin: 8px 0;">ç´¯ç©20æœŸå¾Œï¼Œæ ¹æ“šå‹ç‡èª¿æ•´ï¼ˆè¿‘æœŸæ¬Šé‡60%ï¼‰ï¼š</p>
                                <ul style="font-size: 0.85em; margin: 8px 0 0 15px; color: #ccc;">
                                    <li><strong>å‹ç‡â‰¥55%</strong>ğŸ”¥ï¼šå°å¹…æ”¾å¯¬é–€æª»ï¼Œç¶­æŒåŸºæº–æ³¨ç¢¼ï¼ˆä¸åŠ ç¢¼ï¼‰</li>
                                    <li><strong>å‹ç‡45-55%</strong>ï¼šç¶­æŒåŸè¨­å®šï¼ŒåŸºæº–æ³¨ç¢¼</li>
                                    <li><strong>å‹ç‡35-45%</strong>â„ï¸ï¼šæ”¶ç·Šé–€æª»5%ï¼Œæ³¨ç¢¼Ã—0.7</li>
                                    <li><strong>å‹ç‡<35%</strong>ğŸš«ï¼šæ”¶ç·Šé–€æª»10%ï¼Œæ³¨ç¢¼Ã—0.5ï¼Œæš«åœç­–ç•¥</li>
                                </ul>
                                <p style="font-size: 0.8em; color: #aaa; margin-top: 10px;">
                                    ğŸ“Š ä¾‹ï¼šã€Œè·Ÿé¾ã€å‹ç‡60% â†’ å°å¹…æ”¾å¯¬é–€æª»ï¼Œ<strong>ç¶­æŒåŸºæº–æ³¨ç¢¼</strong>ï¼ˆéåŠ ç¢¼ï¼‰<br>
                                    ğŸ“Š ä¾‹ï¼šã€Œæ–·é¾ã€å‹ç‡30% â†’ é–€æª»æé«˜ã€æ¸›æ³¨ã€ç­–ç•¥æš«åœ
                                </p>
                            </div>
                            
                            <table class="detail-table" style="margin-top: 15px;">
                                <tr><th colspan="2" style="color: #2ecc71; text-align: left;">ğŸ“ˆ æ•´é«”å‹ç‡èª¿æ•´ï¼ˆç–ŠåŠ ç­–ç•¥èª¿æ•´ï¼‰</th></tr>
                                <tr><td>ç´¯è¨ˆå‹ç‡ â‰¥60%</td><td class="val">ç¶­æŒåŸºæº–ï¼ˆä¸åŠ ç¢¼ï¼‰</td></tr>
                                <tr><td>ç´¯è¨ˆå‹ç‡ 50-60%</td><td class="val">ç¶­æŒæ­£å¸¸</td></tr>
                                <tr><td>ç´¯è¨ˆå‹ç‡ 40-50%</td><td class="val">åŸºç¤æ³¨ç¢¼ -1</td></tr>
                                <tr><td>ç´¯è¨ˆå‹ç‡ <40%</td><td class="val">åŸºç¤æ³¨ç¢¼ -2 + è­¦å‘Š</td></tr>
                                <tr><td>è¿‘æœŸé€£è™§70%+</td><td class="val">å¼·åˆ¶æ¸›æ³¨ + æš«åœå»ºè­°</td></tr>
                            </table>
                            
                            <div style="margin-top: 15px; padding: 10px; background: rgba(52, 152, 219, 0.1); border-radius: 6px;">
                                <strong style="color: #3498db; font-size: 0.9em;">ğŸ’¡ è¨­è¨ˆåŸç†</strong>
                                <p style="font-size: 0.8em; color: #aaa; margin-top: 5px;">
                                    æ¯ç¨®ç­–ç•¥çš„å‹ç‡<strong>ç¨ç«‹è¿½è¹¤</strong>ï¼Œè¿‘æœŸè¡¨ç¾æ¬Šé‡60%ã€‚<br>
                                    âš ï¸ <strong>æ ¸å¿ƒç†å¿µ</strong>ï¼šå‹ç‡ä¸Šå‡â‰ åŠ ç¢¼ä¾æ“šã€‚å¥½çš„è¡¨ç¾åªèƒ½è®“ä½ ã€Œå›åˆ°æ­£å¸¸ã€ï¼Œä¸æœƒè®“ä½ ã€Œè¶…é¡ä¸‹æ³¨ã€ã€‚<br>
                                    å»ºè­°æ—é¡¯ç¤º ğŸ”¥ï¼ˆè¡¨ç¾è‰¯å¥½ï¼‰æˆ– â„ï¸ï¼ˆè¡¨ç¾ä¸ä½³ï¼‰åœ–ç¤ºï¼Œå”åŠ©åˆ¤æ–·ã€‚
                                </p>
                            </div>
                            
                            <div style="margin-top: 10px; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 6px;">
                                <strong style="color: #e74c3c; font-size: 0.9em;">âš ï¸ å‹ç‡è¨ˆç®—èªªæ˜</strong>
                                <p style="font-size: 0.8em; color: #aaa; margin-top: 5px;">
                                    å¤§/å°å»ºè­°é‡åˆ°<strong>è±¹å­è¦–ç‚ºè¼¸</strong>ï¼ˆè±¹å­é€šæ®ºï¼‰ï¼Œç¢ºä¿å‹ç‡çµ±è¨ˆçœŸå¯¦åæ˜ å¯¦éš›ç›ˆè™§ã€‚
                                </p>
                            </div>
                            
                            <p style="margin-top: 12px; color: #888; font-size: 0.85rem;">â€» éª°å­æ˜¯éš¨æ©ŸéŠæˆ²ï¼Œä»»ä½•ç­–ç•¥éƒ½ç„¡æ³•ä¿è­‰ç²åˆ©ã€‚è«‹è¨­å®šæ­¢æç·šï¼Œç†æ€§æŠ•æ³¨ã€‚</p>
                        </div>
                    </div>
                    
                    <!-- å‹ç‡çµ±è¨ˆ -->
                    <div id="winRateDisplay" style="display: flex; gap: 15px; margin-bottom: 15px; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 10px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 120px;">
                            <div style="color: #888; font-size: 0.85rem;">ç´¯è¨ˆå‹ç‡</div>
                            <div style="font-size: 1.3rem; font-weight: bold;" id="totalWinRate">-</div>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <div style="color: #888; font-size: 0.85rem;">è¿‘10æ¬¡å‹ç‡</div>
                            <div style="font-size: 1.3rem; font-weight: bold;" id="recentWinRate">-</div>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <div style="color: #888; font-size: 0.85rem;">ç­–ç•¥èª¿æ•´</div>
                            <div style="font-size: 1rem;" id="strategyAdjustment">æ•¸æ“šç´¯ç©ä¸­</div>
                        </div>
                    </div>
                    
                    <p style="color: #888; margin-bottom: 15px;">1æ³¨ = $5,000 | å–®æœŸæœ€é«˜60æ³¨ | å‰10æœŸæ¬Šé‡Ã—2</p>
                    
                    <!-- âš ï¸ è² æœŸæœ›å€¼è²æ˜ï¼ˆå›ºå®šé¡¯ç¤ºï¼‰ -->
                    <div id="negativeEVDisclaimer" style="margin-bottom: 15px; padding: 14px; background: linear-gradient(135deg, rgba(231, 76, 60, 0.2), rgba(192, 57, 43, 0.15)); border: 1px solid rgba(231, 76, 60, 0.4); border-radius: 10px;">
                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <span style="font-size: 1.75rem; line-height: 1;">âš ï¸</span>
                            <div>
                                <strong style="color: #e74c3c; font-size: 1rem; display: block; margin-bottom: 6px;">é‡è¦è²æ˜ï¼šè² æœŸæœ›å€¼éŠæˆ²</strong>
                                <div style="color: #ccc; font-size: 0.875rem; line-height: 1.6;">
                                    <p style="margin: 0 0 6px 0;">
                                        <strong style="color: #f5b7b1;">éª°å¯¶ç‚ºç´”éš¨æ©ŸéŠæˆ²ï¼Œæ¯å±€çµæœå®Œå…¨ç¨ç«‹ã€‚</strong>
                                    </p>
                                    <ul style="margin: 0; padding-left: 18px;">
                                        <li>æ‰€æœ‰æŠ•æ³¨é¸é …<strong style="color: #e74c3c;">é•·æœŸå¿…è¼¸</strong>ï¼ˆèŠå®¶å„ªå‹¢ 2.78%~16.67%ï¼‰</li>
                                        <li>æ­·å²çµæœ<strong>ä¸å½±éŸ¿</strong>æœªä¾†æ©Ÿç‡ï¼ˆç„¡ã€Œè©²å‡ºäº†ã€æˆ–ã€Œå¿…æ–·ã€ï¼‰</li>
                                        <li>æœ¬å·¥å…·åƒ…ä¾›è·¯å‹è§€å¯Ÿåƒè€ƒï¼Œ<strong>ç„¡æ³•é æ¸¬æˆ–æ”¹è®Šçµæœ</strong></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bet-suggestion" id="betSuggestion">
                        <p style="text-align: center; color: #888;">è«‹å…ˆè¼¸å…¥è‡³å°‘3ç­†é–‹çè¨˜éŒ„</p>
                    </div>

                    <div class="confidence-meter" onclick="toggleConfidenceDetail()" style="cursor: pointer;">
                        <label style="display: flex; justify-content: space-between; align-items: center;">è¨Šè™Ÿç¬¦åˆåº¦ <span style="font-size: 0.75rem; color: #888; font-weight: normal;">â“˜ é»æ“ŠæŸ¥çœ‹è©³æƒ…</span></label>
                        <div class="meter-bar">
                            <div class="meter-fill meter-low" id="confidenceFill" style="width: 0%"></div>
                        </div>
                        <p style="text-align: right; color: #888; margin-top: 5px;" id="confidenceText">0%</p>
                    </div>

                    <div class="confidence-detail" id="confidenceDetail" style="display: none;">
                        <div class="detail-title">ğŸ“Š è¨Šè™Ÿç¬¦åˆåº¦èªªæ˜</div>
                        <div class="detail-content">
                            <div style="background: rgba(231,76,60,0.2); padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #e74c3c;">
                                <strong style="color: #e74c3c; font-size: 0.9375rem;">âš ï¸ å°ˆæ¥­èªªæ˜ï¼ˆéå¸¸é‡è¦ï¼‰</strong>
                                <ul style="font-size: 0.875rem; margin: 8px 0 0 0; padding-left: 18px; color: #ccc; line-height: 1.6;">
                                    <li>æ­¤æ•¸å€¼åƒ…ä»£è¡¨<strong style="color: #f5b7b1;">è·¯å‹ç¬¦åˆç¨‹åº¦</strong>ï¼Œ<strong style="color: #e74c3c;">çµ•éå‘½ä¸­ç‡æˆ–ç²å‹æ©Ÿç‡</strong></li>
                                    <li>éª°å­æ¯å±€çµæœ<strong>å®Œå…¨ç¨ç«‹</strong>ï¼Œæ­·å²æ•¸æ“šä¸å½±éŸ¿æœªä¾†</li>
                                    <li>å³ä½¿ç¬¦åˆåº¦100%ï¼Œä¸‹ä¸€å±€çµæœä»æ˜¯<strong>éš¨æ©Ÿ</strong>çš„</li>
                                </ul>
                            </div>
                            <p style="font-size: 0.9375rem;"><strong>è¨Šè™Ÿç¬¦åˆåº¦</strong>ï¼šè¡¡é‡ç•¶å‰èµ°å‹¢èˆ‡å·²çŸ¥è·¯å‹çš„ç›¸ä¼¼ç¨‹åº¦</p>
                            <table class="detail-table" style="margin-top: 12px;">
                                <tr><th colspan="2" style="color: #9b59b6; text-align: left; font-size: 0.875rem;">ğŸ¯ è¨Šè™Ÿä¾†æºï¼ˆåƒ…ä¾›è§€å¯Ÿï¼‰</th></tr>
                                <tr><td style="font-size: 0.875rem;">è·¯å‹æ˜ç¢ºåº¦ï¼ˆå–®è·³/é›™è·³ï¼‰</td><td class="val" style="font-size: 0.875rem;">+15~30%</td></tr>
                                <tr><td style="font-size: 0.875rem;">é¾å‹¢ä¿¡è™Ÿï¼ˆè·Ÿé¾/æ–·é¾/å›é¾ï¼‰</td><td class="val" style="font-size: 0.875rem;">+10~20%</td></tr>
                                <tr><td style="font-size: 0.875rem;">æ¯”ä¾‹åé›¢ç¨‹åº¦</td><td class="val" style="font-size: 0.875rem;">+8~15%</td></tr>
                                <tr><td style="font-size: 0.875rem;">è¿‘æœŸè¶¨å‹¢å»¶çºŒ</td><td class="val" style="font-size: 0.875rem;">+5~10%</td></tr>
                            </table>
                            <div class="confidence-levels" style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 8px;">
                                <span style="padding: 6px 12px; border-radius: 5px; background: rgba(231, 76, 60, 0.3); font-size: 0.8125rem;">&lt; 40% è§€æœ›</span>
                                <span style="padding: 6px 12px; border-radius: 5px; background: rgba(243, 156, 18, 0.3); font-size: 0.8125rem;">40-60% å°æ³¨</span>
                                <span style="padding: 6px 12px; border-radius: 5px; background: rgba(46, 204, 113, 0.3); font-size: 0.8125rem;">&gt; 60% æ­£å¸¸æ³¨</span>
                            </div>
                            <p style="margin-top: 12px; color: #888; font-size: 0.8125rem;">â€» ä¸Šé™å›ºå®š85%ï¼Œå› ç‚º<strong>æ²’æœ‰ä»»ä½•è¨Šè™Ÿèƒ½ä¿è­‰çµæœ</strong></p>
                        </div>
                    </div>

                    <div class="warning-text" style="font-size: 0.875rem; line-height: 1.5;">
                        âš ï¸ <strong>é‡è¦æé†’</strong>ï¼šæ‰€æœ‰å»ºè­°åƒ…ä¾›è·¯å‹è§€å¯Ÿåƒè€ƒã€‚éª°å¯¶ç‚º<strong>è² æœŸæœ›å€¼éš¨æ©ŸéŠæˆ²</strong>ï¼Œæ¯å±€çµæœç¨ç«‹ï¼Œæ­·å²æ•¸æ“šç„¡æ³•é æ¸¬æœªä¾†ã€‚è«‹ç†æ€§å¨›æ¨‚ï¼Œåš´æ ¼æ§åˆ¶é ç®—ã€‚
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================================
        // å¸¸é‡èˆ‡è¨­å®š
        // ============================================================
        const MAX_RECORDS = 100;
        const BET_UNIT = 5000;
        const MAX_BETS = 60;
        const SCHEMA_VERSION = 3; // è³‡æ–™çµæ§‹ç‰ˆæœ¬ï¼ˆæ–°å¢å»ºè­°è¿½è¹¤ï¼‰
        const RECENT_WEIGHT = 2.0;  // å‰10æœŸæ¬Šé‡åŠ å€
        const RECENT_WINDOW = 10;   // è¿‘æœŸè¦–çª—

        // ç‹€æ…‹
        let records = [];
        let suggestionHistory = []; // æŠ•æ³¨å»ºè­°æ­·å²ï¼ˆå«å¯¦éš›çµæœï¼‰
        
        // æŠ•æ³¨å»ºè­°è¿½è¹¤çµæ§‹
        // { round, suggestions: [{type, bets, actualResult, isWin}], timestamp }
        
        // å…¨å±€è¨˜éŒ„è¨ˆæ•¸å™¨ï¼ˆç”¨æ–¼ç”Ÿæˆ roundNoï¼‰
        let recordNoCounter = 0;

        // ============================================================
        // Helper å‡½æ•¸ï¼ˆA1ï¼šæ˜ç¢ºæ‹†åˆ†å¤§å°/è±¹å­åˆ†æï¼‰
        // ============================================================
        
        // åˆ¤æ–·æ˜¯å¦ç‚ºå¤§å°ï¼ˆéè±¹å­ï¼‰
        function isBigSmall(record) {
            return record.type === 'big' || record.type === 'small';
        }

        // å–å¾—å¤§å°é¡å‹ï¼ˆè±¹å­å›å‚³ nullï¼‰
        function getBigSmallType(record) {
            if (record.type === 'big') return 'big';
            if (record.type === 'small') return 'small';
            return null;
        }

        // æ ¹æ“šéª°å­è¨ˆç®—çµæœï¼ˆç´”å‡½æ•¸ï¼‰
        // è¦å‰‡ï¼š10é»æˆ–ä»¥ä¸‹ç‚ºå°ï¼Œ11é»æˆ–ä»¥ä¸Šç‚ºå¤§ï¼Œè±¹å­é€šæ®º
        function getResultType(d1, d2, d3) {
            const sum = d1 + d2 + d3;
            if (d1 === d2 && d2 === d3) {
                return { type: 'triple', sum, tripleNumber: d1 };
            }
            return { type: sum >= 11 ? 'big' : 'small', sum };
        }

        // å¾åŸå§‹è³‡æ–™é‡æ–°è¨ˆç®— type/sumï¼ˆD8ï¼šé¿å…èˆŠè³‡æ–™å•é¡Œï¼‰
        // æ–°å¢ï¼šroundNo ç”¨æ–¼æ•¸å€¼è¨ˆç®—
        function recalculateRecord(raw, assignedRoundNo = null) {
            const [d1, d2, d3] = raw.dice;
            const result = getResultType(d1, d2, d3);
            // å¦‚æœå·²æœ‰ roundNo å°±ä¿ç•™ï¼Œå¦å‰‡ç”¨å‚³å…¥çš„æˆ–è¨ˆæ•¸å™¨
            const roundNo = raw.roundNo ?? assignedRoundNo ?? ++recordNoCounter;
            return { ...raw, ...result, roundNo };
        }

        // æœŸæ•¸ç™½åå–®éæ¿¾ï¼ˆE9ï¼‰
        function sanitizeRound(round) {
            return round.replace(/[^a-zA-Z0-9\-_]/g, '');
        }

        // HTML è½‰ç¾©
        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // ============================================================
        // é€£çºŒè¶¨å‹¢è¨ˆç®—ï¼ˆB3-B4ï¼šå–®ä¸€å‡½å¼ï¼Œæ¸…æ™°é‚è¼¯ï¼‰
        // ============================================================
        
        // è¨ˆç®—ç•¶å‰é€£çºŒï¼ˆå¾æœ€æ–°é–‹å§‹ï¼Œè±¹å­è¦–ç‚ºä¸­æ–·ï¼‰
        function calcCurrentStreak(records) {
            if (records.length === 0) return { count: 0, type: null };
            
            const first = records[0];
            if (!isBigSmall(first)) {
                return { count: 0, type: 'triple' }; // æœ€æ–°æ˜¯è±¹å­
            }
            
            let count = 1;
            const targetType = getBigSmallType(first);
            
            for (let i = 1; i < records.length; i++) {
                const r = records[i];
                if (!isBigSmall(r)) break; // è±¹å­ä¸­æ–·
                if (getBigSmallType(r) !== targetType) break;
                count++;
            }
            
            return { count, type: targetType };
        }

        // è¨ˆç®—æœ€é•·é€£çºŒï¼ˆå¤§/å°å„è‡ªï¼‰
        function calcMaxStreaks(records) {
            let maxBig = 0, maxSmall = 0;
            let currentBig = 0, currentSmall = 0;
            
            for (const r of records) {
                if (r.type === 'big') {
                    currentBig++;
                    currentSmall = 0;
                    maxBig = Math.max(maxBig, currentBig);
                } else if (r.type === 'small') {
                    currentSmall++;
                    currentBig = 0;
                    maxSmall = Math.max(maxSmall, currentSmall);
                } else {
                    // è±¹å­ï¼šéƒ½æ­¸é›¶
                    currentBig = 0;
                    currentSmall = 0;
                }
            }
            
            return { maxBig, maxSmall };
        }

        // è¨ˆç®—è±¹å­é–“éš”ï¼ˆè·é›¢ä¸Šæ¬¡è±¹å­å¤šå°‘æœŸï¼‰
        function calcTripleGap(records) {
            for (let i = 0; i < records.length; i++) {
                if (records[i].type === 'triple') return i;
            }
            return records.length;
        }

        // ============================================================
        // é¾å‹¢åˆ†æï¼ˆé•·é¾ã€æ–·é¾ã€å›é¾ï¼‰
        // ============================================================
        
        /**
         * åˆ†æé¾çš„ç‹€æ…‹
         * - é•·é¾ï¼šé€£çºŒ3æœŸä»¥ä¸ŠåŒçµæœï¼ˆè·Ÿé¾ï¼‰
         * - æ–·é¾ï¼šé€£7æœŸä»¥ä¸Šï¼Œå¯è€ƒæ…®åæŠ¼ï¼ˆæœ‰å†·å»æ©Ÿåˆ¶ï¼‰
         * - å›é¾ï¼šä¸Šä¸€æ¢é¾å‰›æ–·ï¼ˆ6æœŸä»¥ä¸Šï¼‰ï¼Œç•¶å‰é€£çºŒ1-2æœŸï¼Œå¯æŠ¼å›åŸé¾æ–¹å‘
         */
        function analyzeDragon(records, breakThreshold = 6) {
            if (records.length < 2) {
                return { status: 'none', currentStreak: null, prevDragon: null };
            }
            
            const currentStreak = calcCurrentStreak(records);
            
            // æ‰¾ä¸Šä¸€æ¢é¾ï¼ˆç•¶å‰é€£çºŒä¹‹å¾Œçš„é‚£æ¢ï¼‰
            let prevDragonType = null;
            let prevDragonLength = 0;
            
            if (currentStreak.count > 0 && records.length > currentStreak.count) {
                // å¾ç•¶å‰é€£çºŒçµæŸä½ç½®é–‹å§‹æ‰¾ä¸Šä¸€æ¢
                let startIdx = currentStreak.count;
                
                // è·³éå¯èƒ½çš„è±¹å­
                while (startIdx < records.length && records[startIdx].type === 'triple') {
                    startIdx++;
                }
                
                if (startIdx < records.length) {
                    prevDragonType = getBigSmallType(records[startIdx]);
                    if (prevDragonType) {
                        prevDragonLength = 1;
                        for (let i = startIdx + 1; i < records.length; i++) {
                            if (records[i].type === 'triple') break;
                            if (getBigSmallType(records[i]) !== prevDragonType) break;
                            prevDragonLength++;
                        }
                    }
                }
            }
            
            const prevDragon = prevDragonType ? { type: prevDragonType, length: prevDragonLength } : null;
            
            // åˆ¤æ–·é¾çš„ç‹€æ…‹
            let status = 'none';
            let strategyHint = null;
            
            if (currentStreak.type && currentStreak.type !== 'triple') {
                if (currentStreak.count >= breakThreshold) {
                    // é”åˆ°æ–·é¾é–€æª»ï¼šæ–·é¾æ™‚æ©Ÿ
                    status = 'breakable';
                    strategyHint = {
                        action: 'break',
                        target: currentStreak.type === 'big' ? 'small' : 'big',
                        reason: `${currentStreak.type === 'big' ? 'å¤§' : 'å°'}é¾å·²${currentStreak.count}æœŸï¼Œå¯è€ƒæ…®æ–·é¾`
                    };
                } else if (currentStreak.count >= 3) {
                    // é•·é¾3-5æœŸï¼šè·Ÿé¾
                    status = 'riding';
                    strategyHint = {
                        action: 'ride',
                        target: currentStreak.type,
                        reason: `${currentStreak.type === 'big' ? 'å¤§' : 'å°'}é¾é€²è¡Œä¸­ï¼ˆ${currentStreak.count}æœŸï¼‰ï¼Œå¯è·Ÿé¾`
                    };
                } else if (currentStreak.count <= 2 && prevDragon && prevDragon.length >= 6) {
                    // ä¸Šä¸€æ¢æ˜¯é•·é¾ï¼ˆ6æœŸä»¥ä¸Šï¼‰å‰›æ–·ï¼Œç•¶å‰1-2æœŸï¼šå›é¾æ™‚æ©Ÿ
                    status = 'returning';
                    strategyHint = {
                        action: 'return',
                        target: prevDragon.type,
                        reason: `${prevDragon.type === 'big' ? 'å¤§' : 'å°'}é¾ï¼ˆ${prevDragon.length}æœŸï¼‰å‰›æ–·ï¼Œå¯æŠ¼å›é¾`
                    };
                } else {
                    // çŸ­é€£çºŒï¼Œè§€æœ›
                    status = 'building';
                }
            } else if (currentStreak.type === 'triple') {
                // è±¹å­ä¸­æ–·
                if (prevDragon && prevDragon.length >= 6) {
                    status = 'returning';
                    strategyHint = {
                        action: 'return',
                        target: prevDragon.type,
                        reason: `${prevDragon.type === 'big' ? 'å¤§' : 'å°'}é¾ï¼ˆ${prevDragon.length}æœŸï¼‰è¢«è±¹å­ä¸­æ–·ï¼Œå¯æŠ¼å›é¾`
                    };
                }
            }
            
            return {
                status,
                currentStreak,
                prevDragon,
                strategyHint
            };
        }
        
        // å–å¾—é¾ç‹€æ…‹çš„é¡¯ç¤ºæ–‡å­—
        function getDragonStatusText(dragon) {
            switch (dragon.status) {
                case 'riding':
                    return `ğŸ‰ é•·é¾ä¸­`;
                case 'breakable':
                    return `âš”ï¸ å¯æ–·é¾`;
                case 'returning':
                    return `ğŸ”„ å›é¾æ™‚æ©Ÿ`;
                case 'building':
                    return `ğŸ“Š è§€æœ›ä¸­`;
                default:
                    return '-';
            }
        }
        
        // å–å¾—é¾ç‹€æ…‹çš„é¡è‰²
        function getDragonStatusColor(dragon) {
            switch (dragon.status) {
                case 'riding': return '#2ecc71';
                case 'breakable': return '#e74c3c';
                case 'returning': return '#f39c12';
                default: return '#888';
            }
        }

        // ============================================================
        // çµ±è¨ˆè¨ˆç®—æ ¸å¿ƒï¼ˆG13ï¼šåˆ†é›¢è¨ˆç®—èˆ‡æ¸²æŸ“ï¼‰
        // ============================================================
        
        function computeMetrics(records, windowSize) {
            const window = windowSize > 0 ? records.slice(0, windowSize) : records;
            const total = window.length;
            
            // ===== å„éª°å­ç¨ç«‹çµ±è¨ˆï¼ˆå‰10æœŸåŠ æ¬Šï¼‰=====
            const diceAnalysis = analyzeIndividualDice(records, windowSize);
            
            // å¤§å°è±¹å­çµ±è¨ˆï¼ˆåŠ æ¬Šè¨ˆç®—ï¼‰
            let bigCount = 0, smallCount = 0, tripleCount = 0;
            window.forEach((r, idx) => {
                const weight = idx < RECENT_WINDOW ? RECENT_WEIGHT : 1;
                if (r.type === 'big') bigCount += weight;
                else if (r.type === 'small') smallCount += weight;
                else if (r.type === 'triple') tripleCount += weight;
            });
            
            // å¤§å°æ¯”ä¾‹ï¼ˆæ’é™¤è±¹å­ï¼ŒåŠ æ¬Šï¼‰
            const bigSmallTotal = bigCount + smallCount;
            const bigRatio = bigSmallTotal > 0 ? bigCount / bigSmallTotal : 0.5;
            const deviation = Math.abs(bigRatio - 0.5);
            
            // é€£çºŒè¶¨å‹¢
            const currentStreak = calcCurrentStreak(records);
            const maxStreaks = calcMaxStreaks(records);
            const tripleGap = calcTripleGap(records);
            
            // ç¶œåˆå„é»æ•¸çµ±è¨ˆï¼ˆåˆä½µ3é¡†éª°å­ï¼‰
            const numberCounts = [0, 0, 0, 0, 0, 0];
            window.forEach((r, idx) => {
                const weight = idx < RECENT_WINDOW ? RECENT_WEIGHT : 1;
                r.dice.forEach(d => numberCounts[d - 1] += weight);
            });
            const totalDice = window.reduce((sum, r, idx) => 
                sum + 3 * (idx < RECENT_WINDOW ? RECENT_WEIGHT : 1), 0);
            
            // å†·ç†±è™Ÿ
            const coldNumbers = [];
            const hotNumbers = [];
            if (total >= 5) {
                numberCounts.forEach((count, i) => {
                    const threshold = totalDice / 6;
                    if (count >= threshold * 1.4) hotNumbers.push(i + 1);
                    if (count <= threshold * 0.6) coldNumbers.push(i + 1);
                });
            }
            
            // ç¸½å’Œåˆ†å¸ƒï¼ˆæ’é™¤è±¹å­ï¼‰
            const sumCounts = {};
            for (let i = 4; i <= 17; i++) sumCounts[i] = 0;
            window.forEach((r, idx) => {
                const weight = idx < RECENT_WINDOW ? RECENT_WEIGHT : 1;
                if (isBigSmall(r) && sumCounts[r.sum] !== undefined) {
                    sumCounts[r.sum] += weight;
                }
            });
            
            // è¿‘5æœŸçµ±è¨ˆ
            const recent5 = records.slice(0, 5);
            const recentBig = recent5.filter(r => r.type === 'big').length;
            const recentSmall = recent5.filter(r => r.type === 'small').length;
            
            // å…¨éƒ¨è¨˜éŒ„çµ±è¨ˆ
            const allBig = records.filter(r => r.type === 'big').length;
            const allSmall = records.filter(r => r.type === 'small').length;
            const allTriple = records.filter(r => r.type === 'triple').length;
            
            // é¾å‹¢åˆ†æ
            const dragon = analyzeDragon(records);
            
            // è±¹å­æ©Ÿæœƒåˆ†æ
            const tripleOpportunity = checkTripleOpportunity(diceAnalysis);
            
            // æŠ•æ³¨å‹ç‡çµ±è¨ˆ
            const winRateStats = calculateWinRate();
            
            return {
                window,
                total,
                bigCount: Math.round(bigCount),
                smallCount: Math.round(smallCount),
                tripleCount: Math.round(tripleCount),
                bigRatio,
                deviation,
                currentStreak,
                maxStreaks,
                tripleGap,
                numberCounts,
                coldNumbers,
                hotNumbers,
                sumCounts,
                recentBig,
                recentSmall,
                allBig,
                allSmall,
                allTriple,
                allTotal: records.length,
                dragon,
                diceAnalysis,
                tripleOpportunity,
                winRateStats
            };
        }
        
        // ============================================================
        // å„éª°å­ç¨ç«‹åˆ†æ
        // ============================================================
        
        function analyzeIndividualDice(records, windowSize) {
            const window = windowSize > 0 ? records.slice(0, windowSize) : records;
            if (window.length < 5) return null;
            
            // å„éª°å­é»æ•¸çµ±è¨ˆï¼ˆå‰10æœŸæ¬Šé‡åŠ å€ï¼‰
            const dice1Counts = [0, 0, 0, 0, 0, 0];
            const dice2Counts = [0, 0, 0, 0, 0, 0];
            const dice3Counts = [0, 0, 0, 0, 0, 0];
            
            let totalWeight = 0;
            window.forEach((r, idx) => {
                const weight = idx < RECENT_WINDOW ? RECENT_WEIGHT : 1;
                totalWeight += weight;
                dice1Counts[r.dice[0] - 1] += weight;
                dice2Counts[r.dice[1] - 1] += weight;
                dice3Counts[r.dice[2] - 1] += weight;
            });
            
            const avgCount = totalWeight / 6;
            
            // åˆ†æå„éª°å­å†·æº«ç†±
            const analyzeDice = (counts, name) => {
                const result = { name, counts: counts.map(c => Math.round(c)), hot: [], warm: [], cold: [] };
                counts.forEach((count, i) => {
                    const ratio = count / avgCount;
                    if (ratio >= 1.5) result.hot.push(i + 1);
                    else if (ratio <= 0.5) result.cold.push(i + 1);
                    else result.warm.push(i + 1);
                });
                return result;
            };
            
            return {
                dice1: analyzeDice(dice1Counts, 'éª°å­1'),
                dice2: analyzeDice(dice2Counts, 'éª°å­2'),
                dice3: analyzeDice(dice3Counts, 'éª°å­3'),
                totalPeriods: window.length,
                recentPeriods: Math.min(window.length, RECENT_WINDOW)
            };
        }
        
        // æª¢æŸ¥è±¹å­æ©Ÿæœƒï¼ˆä¸‰é¡†éª°å­æœ‰å…±åŒå†·/æº«/ç†±è™Ÿï¼‰
        // ç´”å¨›æ¨‚åƒè€ƒï¼šæ©Ÿç‡ä¸æœƒå› æ­·å²æ•¸æ“šæ”¹è®Š
        function checkTripleOpportunity(diceAnalysis) {
            if (!diceAnalysis) return null;
            
            const { dice1, dice2, dice3 } = diceAnalysis;
            
            // æ‰¾ä¸‰éª°å…±åŒç†±è™Ÿï¼ˆä¸‰é¡†éƒ½å¸¸é–‹ï¼‰
            const commonHot = dice1.hot.filter(n => 
                dice2.hot.includes(n) && dice3.hot.includes(n)
            );
            
            // æ‰¾ä¸‰éª°å…±åŒå†·è™Ÿï¼ˆä¸‰é¡†éƒ½å¾ˆå°‘é–‹ï¼Œã€Œè©²å›æ­¸äº†ã€å¿ƒç†ï¼‰
            const commonCold = dice1.cold.filter(n => 
                dice2.cold.includes(n) && dice3.cold.includes(n)
            );
            
            // æ‰¾ä¸‰éª°å…±åŒæº«è™Ÿ
            const commonWarm = dice1.warm.filter(n => 
                dice2.warm.includes(n) && dice3.warm.includes(n)
            );
            
            // æ‰¾2é¡†éª°å­å…±åŒç†±è™Ÿ
            const twoHot = [];
            for (let n = 1; n <= 6; n++) {
                let hotCount = 0;
                if (dice1.hot.includes(n)) hotCount++;
                if (dice2.hot.includes(n)) hotCount++;
                if (dice3.hot.includes(n)) hotCount++;
                if (hotCount === 2) twoHot.push(n);
            }
            
            // æ‰¾2é¡†éª°å­å…±åŒå†·è™Ÿ
            const twoCold = [];
            for (let n = 1; n <= 6; n++) {
                let coldCount = 0;
                if (dice1.cold.includes(n)) coldCount++;
                if (dice2.cold.includes(n)) coldCount++;
                if (dice3.cold.includes(n)) coldCount++;
                if (coldCount === 2) twoCold.push(n);
            }
            
            // å„ªå…ˆç´šï¼šä¸‰éª°å…±åŒ > å…©éª°å…±åŒï¼›ç†±è™Ÿ â‰ˆ å†·è™Ÿ > æº«è™Ÿ
            if (commonHot.length > 0) {
                return {
                    hasOpportunity: true,
                    level: 'high',
                    type: 'hot',
                    numbers: commonHot,
                    reason: `ä¸‰éª°å…±åŒç†±è™Ÿï¼š${commonHot.join(', ')}ï¼ˆéƒ½å¸¸é–‹ï¼‰`,
                    note: 'å¨›æ¨‚åƒè€ƒï¼šä¸‰é¡†éª°å­è¿‘æœŸéƒ½é »ç¹é–‹å‡ºæ­¤é»æ•¸'
                };
            } else if (commonCold.length > 0) {
                return {
                    hasOpportunity: true,
                    level: 'high',
                    type: 'cold',
                    numbers: commonCold,
                    reason: `ä¸‰éª°å…±åŒå†·è™Ÿï¼š${commonCold.join(', ')}ï¼ˆéƒ½å°‘é–‹ï¼‰`,
                    note: 'å¨›æ¨‚åƒè€ƒï¼šä¸‰é¡†éª°å­è¿‘æœŸéƒ½å¾ˆå°‘é–‹å‡ºæ­¤é»æ•¸ï¼Œå¿ƒç†ä¸Šã€Œè©²å›ä¾†äº†ã€'
                };
            } else if (twoHot.length > 0) {
                return {
                    hasOpportunity: true,
                    level: 'medium',
                    type: 'hot',
                    numbers: twoHot,
                    reason: `å…©éª°å…±åŒç†±è™Ÿï¼š${twoHot.join(', ')}`,
                    note: 'å¨›æ¨‚åƒè€ƒï¼šå…©é¡†éª°å­è¿‘æœŸå¸¸é–‹æ­¤é»æ•¸'
                };
            } else if (twoCold.length > 0) {
                return {
                    hasOpportunity: true,
                    level: 'medium',
                    type: 'cold',
                    numbers: twoCold,
                    reason: `å…©éª°å…±åŒå†·è™Ÿï¼š${twoCold.join(', ')}`,
                    note: 'å¨›æ¨‚åƒè€ƒï¼šå…©é¡†éª°å­è¿‘æœŸå°‘é–‹æ­¤é»æ•¸'
                };
            } else if (commonWarm.length > 0) {
                return {
                    hasOpportunity: true,
                    level: 'low',
                    type: 'warm',
                    numbers: commonWarm,
                    reason: `ä¸‰éª°å…±åŒæº«è™Ÿï¼š${commonWarm.join(', ')}`,
                    note: 'å¨›æ¨‚åƒè€ƒï¼šä¿¡è™Ÿè¼ƒå¼±'
                };
            }
            
            return { hasOpportunity: false, level: 'none', type: null, numbers: [], reason: 'ç„¡å…±åŒè™Ÿç¢¼' };
        }
        
        // ============================================================
        // æŠ•æ³¨å‹ç‡çµ±è¨ˆèˆ‡ç­–ç•¥èª¿æ•´
        // ============================================================
        
        function calculateWinRate() {
            if (suggestionHistory.length < 3) {
                return { total: 0, wins: 0, rate: 0, recentRate: 0, adjustment: 0 };
            }
            
            let total = 0, wins = 0;
            let recentTotal = 0, recentWins = 0;
            
            suggestionHistory.forEach((h, idx) => {
                if (h.actualResult) {
                    h.suggestions.forEach(s => {
                        if (s.actualResult !== undefined) {
                            total++;
                            if (s.isWin) wins++;
                            
                            // è¿‘10æ¬¡å»ºè­°
                            if (idx < 10) {
                                recentTotal++;
                                if (s.isWin) recentWins++;
                            }
                        }
                    });
                }
            });
            
            const rate = total > 0 ? (wins / total * 100) : 0;
            const recentRate = recentTotal > 0 ? (recentWins / recentTotal * 100) : 0;
            
            // ç­–ç•¥èª¿æ•´ä¿‚æ•¸ï¼ˆå‹ç‡é«˜å‰‡åŠ æ³¨ï¼Œä½å‰‡æ¸›æ³¨ï¼‰
            let adjustment = 0;
            if (total >= 10) {
                if (rate >= 60) adjustment = 1;      // å‹ç‡é«˜ï¼Œå¯åŠ æ³¨
                else if (rate >= 50) adjustment = 0; // æ­£å¸¸
                else if (rate >= 40) adjustment = -1; // å‹ç‡åä½ï¼Œæ¸›æ³¨
                else adjustment = -2;                 // å‹ç‡å¾ˆä½ï¼Œå¤§å¹…æ¸›æ³¨
            }
            
            return { total, wins, rate, recentRate, recentTotal, recentWins, adjustment };
        }
        
        // ============================================================
        // ç­–ç•¥è‡ªé©æ‡‰ç³»çµ±ï¼šæ ¹æ“šå„ç­–ç•¥å‹ç‡å‹•æ…‹èª¿æ•´
        // ============================================================
        
        // ä¸‹æ³¨ç›®æ¨™é¡å‹ï¼ˆçµæ§‹åŒ–ï¼Œç¦æ­¢ç”¨å­—ä¸²åˆ¤æ–·ï¼‰
        const BET_TARGET = {
            BIG: 'big',           // æŠ¼å¤§
            SMALL: 'small',       // æŠ¼å°
            TRIPLE: 'triple',     // æŒ‡å®šè±¹å­
            ANY_TRIPLE: 'anyTriple', // ä»»æ„è±¹å­
            OBSERVE: 'observe'    // è§€æœ›
        };
        
        // ç­–ç•¥é¡å‹å®šç¾©ï¼ˆç”¨æ–¼ç¸¾æ•ˆè¿½è¹¤ã€å†·å»æœŸè¨ˆç®—ï¼‰
        const STRATEGY_TYPES = {
            SINGLE_JUMP: 'singleJump',      // å–®è·³è·¯
            DOUBLE_JUMP: 'doubleJump',      // é›™è·³è·¯
            RIDE_DRAGON: 'rideDragon',      // è·Ÿé¾
            BREAK_DRAGON: 'breakDragon',    // æ–·é¾
            RETURN_DRAGON: 'returnDragon',  // å›é¾
            REGRESSION: 'regression',        // æ¯”ä¾‹å›æ­¸
            TREND: 'trend',                  // è¶¨å‹¢å»¶çºŒ
            EXTREME: 'extreme',              // çŸ­æœŸæ¥µç«¯
            RANDOM: 'random',                // äº‚è·¯å…œåº•
            TRIPLE: 'triple',                // è±¹å­å¨›æ¨‚
            OBSERVE: 'observe'               // è§€æœ›ï¼ˆä¸ä¸‹æ³¨ï¼‰
        };
        
        // ============================================================
        // é¢¨éšªç­‰ç´šå®šç¾©èˆ‡èªªæ˜
        // âš ï¸ å°ˆæ¥­èªªæ˜ï¼šæ‰€æœ‰ç­–ç•¥æœ¬è³ªä¸Šéƒ½æ˜¯è² æœŸæœ›å€¼
        // é¢¨éšªç­‰ç´šåƒ…åæ˜ ã€Œè·¯å‹ç¬¦åˆåº¦ã€ï¼Œéã€Œç²å‹æ©Ÿç‡ã€
        // ============================================================
        const RISK_LEVELS = {
            low: {
                label: 'ä½é¢¨éšª',
                color: '#2ecc71',
                icon: 'ğŸŸ¢',
                description: 'é †å‹¢æ“ä½œï¼Œç•¶å‰è·¯å‹ç›¸å°æ˜ç¢º'
            },
            medium: {
                label: 'ä¸­é¢¨éšª',
                color: '#f39c12',
                icon: 'ğŸŸ¡',
                description: 'è·¯å‹ä¸å¤ æ˜ç¢ºï¼Œè¨Šè™Ÿå¼·åº¦ä¸­ç­‰'
            },
            high: {
                label: 'âš ï¸ é«˜é¢¨éšª',
                color: '#e74c3c',
                icon: 'ğŸ”´',
                description: 'é€†å‹¢æ“ä½œï¼Œé•·æœŸè² æœŸæœ›å€¼æ›´é«˜'
            },
            entertainment: {
                label: 'å¨›æ¨‚',
                color: '#9b59b6',
                icon: 'ğŸ°',
                description: 'ç´”å¨›æ¨‚æç¤ºï¼Œæ©Ÿç‡å›ºå®šä¸è®Š'
            },
            observe: {
                label: 'è§€æœ›',
                color: '#888',
                icon: 'â¸ï¸',
                description: 'è¨Šè™Ÿä¸è¶³æˆ–è¡çªï¼Œå»ºè­°ä¸ä¸‹æ³¨'
            }
        };
        
        // ç­–ç•¥é¢¨éšªç­‰ç´šæ˜ å°„
        const STRATEGY_RISK_MAP = {
            [STRATEGY_TYPES.SINGLE_JUMP]: 'low',
            [STRATEGY_TYPES.DOUBLE_JUMP]: 'medium',
            [STRATEGY_TYPES.RIDE_DRAGON]: 'low',      // 3-5æœŸä½é¢¨éšªï¼Œè¶…éæœƒå‹•æ…‹èª¿æ•´
            [STRATEGY_TYPES.BREAK_DRAGON]: 'high',    // âš ï¸ æ–·é¾æ°¸é æ˜¯é«˜é¢¨éšª
            [STRATEGY_TYPES.RETURN_DRAGON]: 'medium',
            [STRATEGY_TYPES.REGRESSION]: 'medium',
            [STRATEGY_TYPES.TREND]: 'medium',
            [STRATEGY_TYPES.EXTREME]: 'medium',
            [STRATEGY_TYPES.RANDOM]: 'medium',
            [STRATEGY_TYPES.TRIPLE]: 'entertainment',
            [STRATEGY_TYPES.OBSERVE]: 'observe'
        };
        
        // ============================================================
        // çµ±ä¸€è¼¸è´åˆ¤æ–·é‚è¼¯ï¼ˆé›†ä¸­å–®ä¸€å‡½æ•¸ï¼Œé¿å…åˆ†æ•£ï¼‰
        // ============================================================
        
        /**
         * åˆ¤æ–·å»ºè­°æ˜¯å¦ç²å‹
         * @param {string} betTarget - ä¸‹æ³¨ç›®æ¨™ (BET_TARGET)
         * @param {string} actualResult - å¯¦éš›çµæœ ('big'/'small'/'triple')
         * @returns {boolean|null} - true=è´, false=è¼¸, null=è§€æœ›ä¸è¨ˆ
         */
        function determineWinLoss(betTarget, actualResult) {
            // è§€æœ›ä¸è¨ˆè¼¸è´
            if (betTarget === BET_TARGET.OBSERVE) return null;
            
            // è±¹å­é¡å‹åˆ¤æ–·
            if (betTarget === BET_TARGET.TRIPLE || betTarget === BET_TARGET.ANY_TRIPLE) {
                return actualResult === 'triple';
            }
            
            // å¤§å°é¡å‹åˆ¤æ–·ï¼šè±¹å­é€šæ®ºï¼Œä¸€å¾‹è¦–ç‚ºè¼¸
            if (betTarget === BET_TARGET.BIG) {
                return actualResult === 'big'; // é–‹å¤§è´ï¼Œé–‹å°æˆ–è±¹å­éƒ½è¼¸
            }
            if (betTarget === BET_TARGET.SMALL) {
                return actualResult === 'small'; // é–‹å°è´ï¼Œé–‹å¤§æˆ–è±¹å­éƒ½è¼¸
            }
            
            return null;
        }
        
        /**
         * è¨ˆç®—å„ç­–ç•¥çš„æ­·å²å‹ç‡ï¼ˆä½¿ç”¨çµæ§‹åŒ– strategyIdï¼‰
         * 
         * âš ï¸ çµ±è¨ˆè¦å‰‡ï¼š
         * 1. æ¶µè“‹æ‰€æœ‰å¯¦éš›ä¸‹æ³¨æœŸï¼ˆä¸æ’é™¤ä¸åˆ©çµæœï¼‰
         * 2. è§€æœ›å»ºè­°ï¼ˆbetTarget === OBSERVEï¼‰ä¸è¨ˆå…¥çµ±è¨ˆ
         * 3. å†·å»æœŸæœŸé–“çš„å»ºè­°ï¼š
         *    - è‹¥ä»æœ‰æ›¿ä»£å»ºè­°ï¼ˆå¦‚é †å‹¢è·Ÿé¾ï¼‰ï¼Œè¨ˆå…¥è©²ç­–ç•¥çµ±è¨ˆ
         *    - è‹¥ç´”è§€æœ›ï¼Œä¸è¨ˆå…¥ä»»ä½•ç­–ç•¥çµ±è¨ˆ
         * 4. isWin === null çš„å»ºè­°ä¸è¨ˆå…¥ï¼ˆå°šæœªé–‹çæˆ–è§€æœ›ï¼‰
         */
        function calculateStrategyPerformance() {
            const performance = {};
            
            // åˆå§‹åŒ–å„ç­–ç•¥çµ±è¨ˆ
            Object.values(STRATEGY_TYPES).forEach(type => {
                performance[type] = { 
                    total: 0,           // ç¸½ä¸‹æ³¨æ¬¡æ•¸
                    wins: 0,            // è´çš„æ¬¡æ•¸
                    losses: 0,          // è¼¸çš„æ¬¡æ•¸ï¼ˆå«è±¹å­é€šæ®ºï¼‰
                    rate: 0,            // ç¸½å‹ç‡
                    recent: [],         // è¿‘æœŸçµæœ
                    recentRate: 0       // è¿‘æœŸå‹ç‡
                };
            });
            
            // çµ±è¨ˆæ­·å²æ•¸æ“š
            suggestionHistory.forEach((history, idx) => {
                // è·³éå°šæœªé–‹ççš„
                if (!history.actualResult) return;
                
                history.suggestions.forEach(s => {
                    // è·³éè§€æœ›å»ºè­°ï¼ˆä¸è¨ˆå…¥çµ±è¨ˆï¼‰
                    if (s.betTarget === BET_TARGET.OBSERVE) return;
                    // è·³éå°šæœªåˆ¤å®šçµæœçš„
                    if (s.isWin === null || s.isWin === undefined) return;
                    
                    // ä½¿ç”¨çµæ§‹åŒ– strategyIdï¼ˆå„ªå…ˆï¼‰
                    let strategyType = s.strategyId || STRATEGY_TYPES.RANDOM;
                    
                    // èˆŠè³‡æ–™ç›¸å®¹ï¼šè‹¥ç„¡ strategyIdï¼Œå¾ shortReason è§£æ
                    if (!s.strategyId) {
                        const reason = s.shortReason || s.reason || '';
                        if (reason.includes('å–®è·³')) strategyType = STRATEGY_TYPES.SINGLE_JUMP;
                        else if (reason.includes('é›™è·³')) strategyType = STRATEGY_TYPES.DOUBLE_JUMP;
                        else if (reason.includes('è·Ÿé¾')) strategyType = STRATEGY_TYPES.RIDE_DRAGON;
                        else if (reason.includes('æ–·é¾') || reason.includes('æ–·')) strategyType = STRATEGY_TYPES.BREAK_DRAGON;
                        else if (reason.includes('å›é¾')) strategyType = STRATEGY_TYPES.RETURN_DRAGON;
                        else if (reason.includes('å›æ­¸')) strategyType = STRATEGY_TYPES.REGRESSION;
                        else if (reason.includes('è¶¨å‹¢')) strategyType = STRATEGY_TYPES.TREND;
                        else if (reason.includes('æ¥µç«¯')) strategyType = STRATEGY_TYPES.EXTREME;
                        else if (reason.includes('è±¹å­')) strategyType = STRATEGY_TYPES.TRIPLE;
                        else if (reason.includes('äº‚è·¯')) strategyType = STRATEGY_TYPES.RANDOM;
                    }
                    
                    // è¨ˆå…¥çµ±è¨ˆï¼ˆæ‰€æœ‰å¯¦éš›ä¸‹æ³¨éƒ½è¨ˆå…¥ï¼Œä¸æ’é™¤ä¸åˆ©çµæœï¼‰
                    performance[strategyType].total++;
                    if (s.isWin) {
                        performance[strategyType].wins++;
                    } else {
                        performance[strategyType].losses++;
                    }
                    
                    // è¨˜éŒ„è¿‘15æ¬¡ï¼ˆç”¨æ–¼è¿‘æœŸå‹ç‡ï¼‰
                    if (idx < 15) {
                        performance[strategyType].recent.push(s.isWin ? 1 : 0);
                    }
                });
            });
            
            // è¨ˆç®—å‹ç‡
            Object.keys(performance).forEach(type => {
                const p = performance[type];
                // å‹ç‡ = è´çš„æ¬¡æ•¸ / ç¸½æ¬¡æ•¸ï¼ˆåŒ…å«æ‰€æœ‰è¼¸çš„ï¼Œå«è±¹å­é€šæ®ºï¼‰
                p.rate = p.total > 0 ? (p.wins / p.total * 100) : 50;
                p.recentRate = p.recent.length > 0 
                    ? (p.recent.reduce((a, b) => a + b, 0) / p.recent.length * 100) 
                    : 50;
            });
            
            return performance;
        }
        
        // ============================================================
        // ç­–ç•¥èª¿æ•´å¸¸æ•¸å®šç¾©
        // ============================================================
        const MIN_SAMPLE_FOR_ADJUSTMENT = 20;  // æœ€å°æ¨£æœ¬æ•¸ï¼šè‡³å°‘20æœŸæ‰å•Ÿå‹•ç¸¾æ•ˆå›é¥‹
        const BASELINE_BET_MULTIPLIER = 1.0;   // åŸºæº–æ³¨ç¢¼ä¹˜æ•¸ï¼Œæ°¸ä¸è¶…éæ­¤å€¼
        
        // ============================================================
        // ç­–ç•¥é™åˆ¶å¸¸æ•¸
        // ============================================================
        // æ–·é¾ç­–ç•¥é™åˆ¶
        const BREAK_DRAGON_MAX_BETS = 2;              // æ–·é¾æœ€å¤§æ³¨ç¢¼ï¼ˆä¸å…è¨±åŠ ç¢¼ï¼‰
        const BREAK_DRAGON_COOLDOWN_AFTER_TRIPLE = 1; // è±¹å­å¾Œå†·å»æœŸæ•¸
        
        // é•·é¾è·Ÿéš¨ç­–ç•¥é™åˆ¶
        const RIDE_DRAGON_MAX_STREAK = 8;             // è·Ÿé¾æœ€å¤§å®¹å¿é•·åº¦ï¼Œè¶…éå‰‡è§€æœ›
        const RIDE_DRAGON_DEGRADE_STREAK = 6;         // é–‹å§‹é™ç´šçš„é€£çºŒæœŸæ•¸
        
        // æ¯”ä¾‹å›æ­¸ç­–ç•¥é™åˆ¶
        const REGRESSION_MIN_DEVIATION = 3;           // æœ€å°åå·®ç­‰ç´š
        const REGRESSION_MIN_PERIODS = 10;            // æœ€å°æœŸæ•¸
        const REGRESSION_NO_DRAGON_THRESHOLD = 4;     // ä¸å¯å­˜åœ¨é•·é¾ï¼ˆé€£çºŒæœŸæ•¸é–€æª»ï¼‰
        
        // æ ¹æ“šç­–ç•¥è¡¨ç¾è¨ˆç®—èª¿æ•´ä¿‚æ•¸
        // âš ï¸ é‡è¦è¦å‰‡ï¼š
        // 1. æ¨£æœ¬æ•¸ä¸è¶³æ™‚ä¸èª¿æ•´
        // 2. çŸ­æœŸå‹ç‡ä¸Šå‡ä¸åŠ ç¢¼ï¼Œåªèƒ½å›åˆ°åŸºæº–
        // 3. å‹ç‡èª¿æ•´åƒ…ç”¨æ–¼é¢¨éšªé™ä½æˆ–ç­–ç•¥åœç”¨
        function getStrategyAdjustment(strategyType, performance) {
            const p = performance[strategyType];
            
            // è¦å‰‡1ï¼šæœ€å°æ¨£æœ¬æ•¸é™åˆ¶ï¼ˆ20æœŸä»¥ä¸Šæ‰å•Ÿå‹•ç¸¾æ•ˆå›é¥‹ï¼‰
            if (!p || p.total < MIN_SAMPLE_FOR_ADJUSTMENT) {
                return { 
                    thresholdAdjust: 0,      // é–€æª»èª¿æ•´ï¼ˆè² æ•¸=æ”¾å¯¬ï¼Œæ­£æ•¸=æ”¶ç·Šï¼‰
                    betMultiplier: BASELINE_BET_MULTIPLIER,  // å›ºå®šåŸºæº–æ³¨ç¢¼
                    enabled: true,           // æ˜¯å¦å•Ÿç”¨
                    status: 'normal',        // ç‹€æ…‹ï¼šhot/normal/cold/disabled
                    reason: `æ•¸æ“šç´¯ç©ä¸­ï¼ˆ${p?.total || 0}/${MIN_SAMPLE_FOR_ADJUSTMENT}æœŸï¼‰`,
                    sampleInsufficient: true // æ¨™è¨˜æ¨£æœ¬ä¸è¶³
                };
            }
            
            // æ ¹æ“šå‹ç‡æ±ºå®šèª¿æ•´
            const rate = p.rate;
            const recentRate = p.recentRate;
            
            // è¿‘æœŸè¡¨ç¾æ¬Šé‡æ›´é«˜ï¼ˆç”¨æ–¼åˆ¤æ–·é¢¨éšªï¼ŒéåŠ ç¢¼ï¼‰
            const weightedRate = (rate * 0.4 + recentRate * 0.6);
            
            // è¦å‰‡2 & 3ï¼šå‹ç‡èª¿æ•´åƒ…ç”¨æ–¼ã€Œé¢¨éšªé™ä½ã€æˆ–ã€Œç­–ç•¥åœç”¨ã€
            // âš ï¸ å³ä½¿è¡¨ç¾å„ªç§€ï¼Œæ³¨ç¢¼ä¹˜æ•¸ä¹Ÿä¸è¶…éåŸºæº–å€¼1.0
            
            if (weightedRate >= 55) {
                // è¡¨ç¾è‰¯å¥½/å„ªç§€ï¼šå›åˆ°åŸºæº–æ³¨ç¢¼ï¼Œå¯å°å¹…æ”¾å¯¬é–€æª»
                // âš ï¸ æ³¨æ„ï¼šä¸åŠ ç¢¼ï¼åªæ˜¯å›åˆ°æ­£å¸¸æ°´æº–
                return {
                    thresholdAdjust: weightedRate >= 65 ? -3 : -1,  // å°å¹…æ”¾å¯¬é–€æª»
                    betMultiplier: BASELINE_BET_MULTIPLIER,         // ç¶­æŒåŸºæº–ï¼Œä¸åŠ ç¢¼
                    enabled: true,
                    status: weightedRate >= 65 ? 'hot' : 'warm',
                    reason: `å‹ç‡${weightedRate.toFixed(0)}%ï¼Œç¶­æŒåŸºæº–æ³¨ç¢¼`
                };
            } else if (weightedRate >= 45) {
                // è¡¨ç¾æ­£å¸¸ï¼šç¶­æŒåŸºæº–
                return {
                    thresholdAdjust: 0,
                    betMultiplier: BASELINE_BET_MULTIPLIER,
                    enabled: true,
                    status: 'normal',
                    reason: `å‹ç‡${weightedRate.toFixed(0)}%ï¼Œç¶­æŒæ­£å¸¸`
                };
            } else if (weightedRate >= 35) {
                // è¡¨ç¾ä¸ä½³ï¼šæ”¶ç·Šé–€æª»ï¼Œæ¸›æ³¨ï¼ˆé¢¨éšªæ§åˆ¶ï¼‰
                return {
                    thresholdAdjust: 5,      // é–€æª»æé«˜5%
                    betMultiplier: 0.7,      // æ³¨ç¢¼Ã—0.7ï¼ˆæ¸›æ³¨ï¼‰
                    enabled: true,
                    status: 'cold',
                    reason: `å‹ç‡${weightedRate.toFixed(0)}%ï¼Œæ¸›æ³¨è§€å¯Ÿ`
                };
            } else {
                // è¡¨ç¾å¾ˆå·®ï¼šæš«æ™‚åœç”¨ç­–ç•¥
                return {
                    thresholdAdjust: 10,
                    betMultiplier: 0.5,      // å¤§å¹…æ¸›æ³¨
                    enabled: false,          // åœç”¨ç­–ç•¥
                    status: 'disabled',
                    reason: `å‹ç‡${weightedRate.toFixed(0)}%ï¼Œç­–ç•¥æš«åœ`
                };
            }
        }
        
        // æª¢æŸ¥æ–·é¾æ˜¯å¦è™•æ–¼å†·å»æœŸï¼ˆé€£çºŒå¤±æ•—å¾Œæš«åœï¼‰
        // ä½¿ç”¨çµæ§‹åŒ– strategyId åˆ¤æ–·
        /**
         * æª¢æŸ¥æ–·é¾ç­–ç•¥æ˜¯å¦è™•æ–¼å†·å»æœŸ
         * å†·å»æ¢ä»¶ï¼š
         * 1. é€£çºŒå¤±æ•—é”é–€æª»ï¼ˆ2æ¬¡ä»¥ä¸Šï¼‰
         * 2. è±¹å­å‡ºç¾å¾Œè‡³å°‘1æœŸå…§ä¸å¾—ä½¿ç”¨æ–·é¾
         */
        function checkBreakDragonCooldown() {
            // ===== æ¢ä»¶1ï¼šæª¢æŸ¥æœ€è¿‘æ˜¯å¦å‡ºç¾è±¹å­ =====
            if (records.length > 0) {
                const lastRecord = records[0];
                if (lastRecord.type === 'triple') {
                    return {
                        inCooldown: true,
                        consecutiveFails: 0,
                        cooldownRemaining: BREAK_DRAGON_COOLDOWN_AFTER_TRIPLE,
                        reason: `ä¸ŠæœŸé–‹è±¹å­ï¼Œæ–·é¾å†·å»${BREAK_DRAGON_COOLDOWN_AFTER_TRIPLE}æœŸ`,
                        tripleTriggered: true
                    };
                }
            }
            
            // ===== æ¢ä»¶2ï¼šæª¢æŸ¥é€£çºŒå¤±æ•— =====
            let consecutiveFails = 0;
            let lastBreakRoundNo = null;
            
            for (const history of suggestionHistory) {
                if (!history.actualResult) continue;
                
                // ä½¿ç”¨ strategyId åˆ¤æ–·ï¼ˆçµæ§‹åŒ–ï¼‰
                const breakSuggestion = history.suggestions.find(s => 
                    s.strategyId === STRATEGY_TYPES.BREAK_DRAGON);
                
                if (breakSuggestion) {
                    if (breakSuggestion.isWin === false) {
                        consecutiveFails++;
                        if (lastBreakRoundNo === null) lastBreakRoundNo = history.roundNo;
                    } else if (breakSuggestion.isWin === true) {
                        // æ–·é¾æˆåŠŸï¼Œé‡ç½®è¨ˆæ•¸
                        break;
                    }
                }
                
                // åªæª¢æŸ¥æœ€è¿‘10ç­†
                if (consecutiveFails >= 3 || suggestionHistory.indexOf(history) >= 10) break;
            }
            
            // é€£çºŒå¤±æ•—2æ¬¡ä»¥ä¸Šï¼Œé€²å…¥å†·å»æœŸ
            if (consecutiveFails >= 2 && lastBreakRoundNo !== null) {
                // å†·å»æœŸï¼šå¤±æ•—æ¬¡æ•¸Ã—2 æœŸ
                const cooldownPeriods = consecutiveFails * 2;
                const currentRoundNo = records.length > 0 ? records[0].roundNo : 0;
                const roundsSinceLastBreak = currentRoundNo - lastBreakRoundNo;
                
                if (roundsSinceLastBreak < cooldownPeriods) {
                    return {
                        inCooldown: true,
                        consecutiveFails,
                        cooldownRemaining: cooldownPeriods - roundsSinceLastBreak,
                        reason: `æ–·é¾é€£çºŒå¤±æ•—${consecutiveFails}æ¬¡ï¼Œå†·å»ä¸­ï¼ˆå‰©${cooldownPeriods - roundsSinceLastBreak}æœŸï¼‰`
                    };
                }
            }
            
            return { inCooldown: false, consecutiveFails: 0 };
        }
        
        // è¨˜éŒ„æŠ•æ³¨å»ºè­°ï¼ˆä½¿ç”¨çµæ§‹åŒ–æ¬„ä½ï¼‰
        function recordSuggestion(roundNo, suggestions) {
            suggestionHistory.unshift({
                roundNo,  // æ•¸å€¼å‹åˆ¥ï¼Œç”¨æ–¼è¨ˆç®—
                suggestions: suggestions.map(s => ({
                    // çµæ§‹åŒ–æ¬„ä½ï¼ˆå¿…è¦ï¼‰
                    betTarget: s.betTarget,       // ä¸‹æ³¨ç›®æ¨™ï¼šbig/small/triple/anyTriple/observe
                    strategyId: s.strategyId,     // ç­–ç•¥è­˜åˆ¥ï¼šsingleJump/rideDragon/...
                    // é¡¯ç¤ºæ¬„ä½
                    displayType: s.type,          // é¡¯ç¤ºç”¨æ–‡å­—ï¼ˆå¦‚ã€ŒæŠ¼å¤§ã€ï¼‰
                    bets: s.bets,
                    reason: s.reason,
                    shortReason: s.shortReason || '',
                    // çµæœæ¬„ä½
                    actualResult: null,
                    isWin: null
                })),
                timestamp: Date.now(),
                actualResult: null
            });
            
            // ä¿ç•™æœ€è¿‘50ç­†
            if (suggestionHistory.length > 50) {
                suggestionHistory = suggestionHistory.slice(0, 50);
            }
            
            saveSuggestionHistory();
        }
        
        // æ›´æ–°å»ºè­°çµæœï¼ˆä½¿ç”¨çµ±ä¸€åˆ¤æ–·é‚è¼¯ï¼‰
        function updateSuggestionResult(roundNo, actualType) {
            const history = suggestionHistory.find(h => h.roundNo === roundNo);
            if (history && !history.actualResult) {
                history.actualResult = actualType;
                history.suggestions.forEach(s => {
                    // ä½¿ç”¨çµ±ä¸€åˆ¤æ–·å‡½æ•¸ï¼ˆé›†ä¸­é‚è¼¯ï¼‰
                    s.isWin = determineWinLoss(s.betTarget, actualType);
                    s.actualResult = actualType;
                });
                saveSuggestionHistory();
            }
        }
        
        function saveSuggestionHistory() {
            localStorage.setItem('sicBoSuggestionHistory', JSON.stringify(suggestionHistory));
        }
        
        function loadSuggestionHistory() {
            const saved = localStorage.getItem('sicBoSuggestionHistory');
            if (saved) {
                try {
                    suggestionHistory = JSON.parse(saved);
                } catch (e) {
                    suggestionHistory = [];
                }
            }
        }

        // ============================================================
        // è·¯å‹åˆ†æï¼ˆå–®è·³ã€é›™è·³ã€é•·é¾ï¼‰
        // ============================================================
        
        /**
         * åˆ†æè·¯å‹æ¨¡å¼ï¼ˆå‰10æœŸæ¬Šé‡Ã—2ï¼‰
         * - å–®è·³ï¼šå¤§å°å¤§å°å¤§å°ï¼ˆäº¤æ›¿å‡ºç¾ï¼‰
         * - é›™è·³ï¼šå¤§å¤§å°å°å¤§å¤§ï¼ˆæˆå°äº¤æ›¿ï¼‰
         * - é•·é¾ï¼šé€£çºŒåŒçµæœ
         * - äº‚è·¯ï¼šç„¡è¦å¾‹
         */
        function analyzePattern(records) {
            if (records.length < 4) return { type: 'insufficient', confidence: 0, sampleSize: 0 };
            
            // åªå–å¤§å°çµæœï¼ˆæ’é™¤è±¹å­ï¼‰ï¼Œæœ€å¤š20æœŸ
            const results = [];
            const weights = []; // å°æ‡‰æ¯å€‹çµæœçš„æ¬Šé‡
            for (let i = 0; i < Math.min(records.length, 20); i++) {
                if (isBigSmall(records[i])) {
                    results.push(records[i].type);
                    // å‰10æœŸæ¬Šé‡Ã—2ï¼Œä¹‹å¾Œæ¬Šé‡Ã—1
                    weights.push(i < 10 ? 2 : 1);
                }
            }
            
            if (results.length < 4) return { type: 'insufficient', confidence: 0, sampleSize: results.length };
            
            // è¨ˆç®—ç¸½æ¬Šé‡
            const totalWeight = weights.reduce((sum, w) => sum + w, 0);
            
            // æª¢æ¸¬å–®è·³ï¼šABAB...ï¼ˆåŠ æ¬Šè¨ˆç®—ï¼‰
            let singleJumpWeight = 0;
            let transitionTotalWeight = 0;
            for (let i = 0; i < results.length - 1; i++) {
                // ä½¿ç”¨ç›¸é„°å…©æœŸä¸­è¼ƒé«˜çš„æ¬Šé‡
                const pairWeight = Math.max(weights[i], weights[i + 1]);
                transitionTotalWeight += pairWeight;
                if (results[i] !== results[i + 1]) {
                    singleJumpWeight += pairWeight;
                }
            }
            const singleJumpRatio = transitionTotalWeight > 0 ? singleJumpWeight / transitionTotalWeight : 0;
            
            // æª¢æ¸¬é›™è·³ï¼šAABB...ï¼ˆåŠ æ¬Šè¨ˆç®—ï¼‰
            let doubleJumpWeight = 0;
            let pairTotalWeight = 0;
            for (let i = 0; i < results.length - 2; i += 2) {
                const pairWeight = Math.max(weights[i], weights[i + 1]);
                pairTotalWeight += pairWeight;
                if (results[i] === results[i + 1] && 
                    (i + 2 >= results.length || results[i + 1] !== results[i + 2])) {
                    doubleJumpWeight += pairWeight;
                }
            }
            const doubleJumpRatio = pairTotalWeight > 0 ? doubleJumpWeight / pairTotalWeight : 0;
            
            // è¨ˆç®—å‰10æœŸçš„ç¨ç«‹äº¤æ›¿ç‡ï¼ˆç”¨æ–¼é¡¯ç¤ºï¼‰
            const recent10 = results.slice(0, Math.min(10, results.length));
            let recent10Jumps = 0;
            for (let i = 0; i < recent10.length - 1; i++) {
                if (recent10[i] !== recent10[i + 1]) recent10Jumps++;
            }
            const recent10JumpRatio = recent10.length > 1 ? recent10Jumps / (recent10.length - 1) : 0;
            
            // åˆ¤æ–·è·¯å‹ï¼ˆé™ä½é–€æª»ï¼Œå› ç‚ºåŠ æ¬Šå¾Œæ›´ç²¾ç¢ºï¼‰
            if (singleJumpRatio >= 0.65) {
                return { 
                    type: 'singleJump', 
                    confidence: Math.min(singleJumpRatio * 100, 85),
                    nextPredict: results[0] === 'big' ? 'small' : 'big',
                    description: 'å–®è·³è·¯ï¼ˆå¤§å°äº¤æ›¿ï¼‰',
                    sampleSize: results.length,
                    recentRatio: recent10JumpRatio,
                    weightedRatio: singleJumpRatio
                };
            }
            
            if (doubleJumpRatio >= 0.55 && results.length >= 6) {
                // åˆ¤æ–·é›™è·³çš„ä¸‹ä¸€æœŸ
                const lastPair = results.slice(0, 2);
                const isCompletePair = lastPair[0] === lastPair[1];
                return {
                    type: 'doubleJump',
                    confidence: Math.min(doubleJumpRatio * 95, 75),
                    nextPredict: isCompletePair ? (lastPair[0] === 'big' ? 'small' : 'big') : lastPair[0],
                    description: 'é›™è·³è·¯ï¼ˆæˆå°äº¤æ›¿ï¼‰',
                    sampleSize: results.length,
                    weightedRatio: doubleJumpRatio
                };
            }
            
            // æª¢æŸ¥æ˜¯å¦ç‚ºé•·é¾
            const currentStreak = calcCurrentStreak(records);
            if (currentStreak.count >= 3 && currentStreak.type !== 'triple') {
                return {
                    type: 'dragon',
                    confidence: Math.min(40 + currentStreak.count * 8, 80),
                    currentType: currentStreak.type,
                    length: currentStreak.count,
                    description: `${currentStreak.type === 'big' ? 'å¤§' : 'å°'}é¾ï¼ˆ${currentStreak.count}æœŸï¼‰`,
                    sampleSize: results.length
                };
            }
            
            return { 
                type: 'random', 
                confidence: 30, 
                description: 'äº‚è·¯ï¼ˆç„¡æ˜é¡¯è¦å¾‹ï¼‰',
                sampleSize: results.length,
                singleJumpRatio: singleJumpRatio,
                doubleJumpRatio: doubleJumpRatio
            };
        }
        
        /**
         * è¨ˆç®—ç¸½å’Œå€é–“ç†±åº¦
         * æ ¹æ“šæ–°è¦å‰‡ï¼š3-10å°ï¼Œ11-18å¤§
         * é—œæ³¨è‡¨ç•Œå€é–“ 9-12 çš„å‡ºç¾é »ç‡
         */
        function analyzeSumZones(records) {
            if (records.length < 10) return null;
            
            const window = records.slice(0, 20).filter(r => isBigSmall(r));
            if (window.length < 8) return null;
            
            // å€é–“å®šç¾©
            const zones = {
                lowSmall: { range: '4-7', count: 0 },     // ç©©å°å€
                midSmall: { range: '8-10', count: 0 },    // è‡¨ç•Œå°å€
                midBig: { range: '11-13', count: 0 },     // è‡¨ç•Œå¤§å€
                highBig: { range: '14-17', count: 0 }     // ç©©å¤§å€
            };
            
            window.forEach(r => {
                if (r.sum >= 4 && r.sum <= 7) zones.lowSmall.count++;
                else if (r.sum >= 8 && r.sum <= 10) zones.midSmall.count++;
                else if (r.sum >= 11 && r.sum <= 13) zones.midBig.count++;
                else if (r.sum >= 14 && r.sum <= 17) zones.highBig.count++;
            });
            
            const total = window.length;
            const midRatio = (zones.midSmall.count + zones.midBig.count) / total;
            const extremeRatio = (zones.lowSmall.count + zones.highBig.count) / total;
            
            return {
                zones,
                total,
                midRatio,      // è‡¨ç•Œå€æ¯”ä¾‹
                extremeRatio,  // æ¥µç«¯å€æ¯”ä¾‹
                hotZone: Object.entries(zones).reduce((a, b) => b[1].count > a[1].count ? b : a)[0]
            };
        }

        // ============================================================
        // è¨Šè™Ÿæ——æ¨™ç³»çµ±ï¼ˆå„ªåŒ–ç‰ˆï¼šåŠ å…¥è·¯å‹ã€å€é–“åˆ†æï¼‰
        // ============================================================
        
        function computeSignals(metrics) {
            const pattern = analyzePattern(records);
            const sumZones = analyzeSumZones(records);
            
            const signals = {
                // é€£çºŒè¶¨å‹¢ç­‰ç´š
                streakLevel: 0,
                streakType: null,
                // é¾å‹¢ç‹€æ…‹
                dragon: metrics.dragon,
                // è·¯å‹åˆ†æ
                pattern,
                // ç¸½å’Œå€é–“
                sumZones,
                // æ¯”ä¾‹åé›¢ç­‰ç´š
                deviationLevel: 0,
                // è¿‘5æœŸæ¥µç«¯
                extreme5: null,
                // è±¹å­é–“éš”ç­‰ç´š
                tripleGapLevel: 0,
                // åŸå§‹æ•¸æ“š
                raw: metrics
            };
            
            // é€£çºŒè¶¨å‹¢ï¼ˆå„ªåŒ–ï¼šæ›´è¬¹æ…çš„åˆ¤å®šï¼‰
            if (metrics.currentStreak.type && metrics.currentStreak.type !== 'triple') {
                const streak = metrics.currentStreak.count;
                if (streak >= 7) signals.streakLevel = 4;      // è¶…é•·é¾ï¼ˆé«˜é¢¨éšªå€ï¼‰
                else if (streak >= 5) signals.streakLevel = 3; // é•·é¾å¯æ–·
                else if (streak >= 4) signals.streakLevel = 2; // é¾å‹¢ç¢ºèª
                else if (streak >= 3) signals.streakLevel = 1; // é¾æˆå½¢ï¼ˆè§€å¯Ÿï¼‰
                signals.streakType = metrics.currentStreak.type;
            }
            
            // æ¯”ä¾‹åé›¢ï¼ˆå„ªåŒ–é–€æª»ï¼‰
            if (metrics.total >= 5) {
                if (metrics.deviation > 0.35) signals.deviationLevel = 3;      // åš´é‡å¤±è¡¡
                else if (metrics.deviation > 0.25) signals.deviationLevel = 2; // æ˜é¡¯åé›¢
                else if (metrics.deviation > 0.15) signals.deviationLevel = 1; // è¼•å¾®åé›¢
            }
            
            // è¿‘5æœŸæ¥µç«¯ï¼ˆå„ªåŒ–ï¼šè€ƒæ…®è·¯å‹ï¼‰
            if (metrics.recentBig >= 4) signals.extreme5 = 'big';
            else if (metrics.recentSmall >= 4) signals.extreme5 = 'small';
            
            // è±¹å­é–“éš”ï¼ˆå„ªåŒ–ï¼šæ›´ä¿å®ˆï¼‰
            if (metrics.tripleGap >= 25) signals.tripleGapLevel = 2;
            else if (metrics.tripleGap >= 15) signals.tripleGapLevel = 1;
            
            return signals;
        }

        // æ ¹æ“šè¨Šè™Ÿè¨ˆç®—ä¿¡å¿ƒæŒ‡æ•¸ï¼ˆå„ªåŒ–ç‰ˆï¼‰
        function computeConfidence(signals) {
            let confidence = 25; // åŸºç¤å€¼é™ä½ï¼Œæ›´ä¿å®ˆ
            const reasons = [];
            const metrics = signals.raw;
            const dragon = signals.dragon;
            const pattern = signals.pattern;
            
            // ========== è·¯å‹åˆ†æï¼ˆæœ€é«˜æ¬Šé‡ï¼‰ ==========
            if (pattern && pattern.type !== 'insufficient' && pattern.type !== 'random') {
                if (pattern.type === 'singleJump') {
                    confidence += Math.min(pattern.confidence * 0.35, 30);
                    reasons.push(`ğŸ”€ å–®è·³è·¯å‹ï¼ˆä¿¡å¿ƒ${pattern.confidence.toFixed(0)}%ï¼‰`);
                } else if (pattern.type === 'doubleJump') {
                    confidence += Math.min(pattern.confidence * 0.3, 25);
                    reasons.push(`ğŸ”„ é›™è·³è·¯å‹ï¼ˆä¿¡å¿ƒ${pattern.confidence.toFixed(0)}%ï¼‰`);
                } else if (pattern.type === 'dragon') {
                    confidence += Math.min(pattern.confidence * 0.25, 20);
                    reasons.push(`ğŸ‰ ${pattern.description}`);
                }
            }
            
            // ========== é¾å‹¢åˆ†æ ==========
            if (dragon && dragon.strategyHint) {
                const hint = dragon.strategyHint;
                const streak = metrics.currentStreak.count;
                
                if (dragon.status === 'breakable') {
                    // æ–·é¾ä¿¡å¿ƒè¦æ‰“æŠ˜ï¼ˆé€†å‹¢æ“ä½œï¼‰
                    const breakBonus = streak >= 8 ? 18 : streak >= 7 ? 12 : 8;
                    confidence += breakBonus;
                    reasons.push(`âš”ï¸ ${hint.reason}ï¼ˆé€†å‹¢é¢¨éšªï¼‰`);
                } else if (dragon.status === 'returning') {
                    confidence += 15;
                    reasons.push(`ğŸ”„ ${hint.reason}`);
                } else if (dragon.status === 'riding') {
                    confidence += streak >= 5 ? 18 : streak >= 4 ? 12 : 8;
                    reasons.push(`ğŸ‰ ${hint.reason}`);
                }
            }
            
            // ========== æ¯”ä¾‹åé›¢ ==========
            if (signals.deviationLevel >= 3) {
                confidence += 15;
                reasons.push(`ğŸ“Š åš´é‡å¤±è¡¡ï¼šå¤§${(metrics.bigRatio * 100).toFixed(0)}%`);
            } else if (signals.deviationLevel >= 2) {
                confidence += 10;
                reasons.push(`ğŸ“Š æ¯”ä¾‹åé›¢ï¼šå¤§${(metrics.bigRatio * 100).toFixed(0)}%`);
            } else if (signals.deviationLevel === 1) {
                confidence += 5;
            }
            
            // ========== è¿‘5æœŸæ¥µç«¯ ==========
            if (signals.extreme5) {
                confidence += 8;
                const count = signals.extreme5 === 'big' ? metrics.recentBig : metrics.recentSmall;
                reasons.push(`è¿‘5æœŸ${signals.extreme5 === 'big' ? 'å¤§' : 'å°'}å‡º${count}æ¬¡`);
            }
            
            // ========== å¤šé‡ä¿¡è™ŸåŠ æˆ ==========
            let signalCount = 0;
            if (pattern && pattern.type !== 'random' && pattern.type !== 'insufficient') signalCount++;
            if (dragon && dragon.strategyHint) signalCount++;
            if (signals.deviationLevel >= 2) signalCount++;
            if (signals.extreme5) signalCount++;
            
            if (signalCount >= 3) {
                confidence += 10;
                reasons.push(`ğŸ¯ ${signalCount}é‡ä¿¡è™Ÿå…±æŒ¯`);
            } else if (signalCount >= 2) {
                confidence += 5;
            }
            
            // ========== è±¹å­é–“éš”ï¼ˆå¼±åŒ–ï¼Œé¿å…èª¤å°ï¼‰==========
            if (signals.tripleGapLevel === 2) {
                reasons.push(`ğŸ² ${metrics.tripleGap}æœŸæœªå‡ºè±¹å­ï¼ˆåƒ…ä¾›åƒè€ƒï¼‰`);
            }
            
            // ========== å†·ç†±è™Ÿ ==========
            if (metrics.coldNumbers.length > 0) {
                reasons.push(`â„ï¸ å†·è™Ÿ: ${metrics.coldNumbers.join(', ')}`);
            }
            if (metrics.hotNumbers.length > 0) {
                reasons.push(`ğŸ”¥ ç†±è™Ÿ: ${metrics.hotNumbers.join(', ')}`);
            }
            
            // ========== ä¿¡å¿ƒä¸Šé™ï¼ˆéª°å­æ˜¯éš¨æ©ŸéŠæˆ²ï¼‰==========
            return {
                confidence: Math.min(confidence, 85), // é™ä½ä¸Šé™
                reasons
            };
        }

        // ============================================================
        // æŠ•æ³¨å»ºè­°ç”Ÿæˆï¼ˆçµ±ä¸€ç­–ç•¥ç‰ˆï¼šæ™ºèƒ½åˆ†æ + å‹ç‡èª¿æ•´ï¼‰
        // ============================================================
        
        // è¨Šè™Ÿå¼·åº¦ä¸Šé™ï¼ˆéª°å­æ˜¯éš¨æ©ŸéŠæˆ²ï¼Œä¸å¯èƒ½100%ç¢ºå®šï¼‰
        const SIGNAL_STRENGTH_CAP = 85;
        
        // å¼·åˆ¶æˆªæ–·è¨Šè™Ÿå¼·åº¦
        function capSignalStrength(value) {
            return Math.min(value, SIGNAL_STRENGTH_CAP);
        }
        
        // ç”Ÿæˆåœæ‰‹æ¢ä»¶æ–‡å­—
        function generateStopCondition(strategyType) {
            const conditions = {
                singleJump: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡æˆ–é‡è±¹å­å¾Œè§€æœ›2æœŸ',
                doubleJump: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡æˆ–é‡è±¹å­å¾Œè§€æœ›2æœŸ',
                rideDragon: 'ğŸ›‘ åœæ‰‹ï¼šé¾æ–·å³åœï¼Œä¸è¿½ï¼›é‡è±¹å­è§€æœ›1æœŸ',
                breakDragon: 'ğŸ›‘ åœæ‰‹ï¼šå¤±æ•—1æ¬¡å³åœï¼Œé€²å…¥å†·å»æœŸ',
                returnDragon: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡æˆ–é‡è±¹å­å¾Œè§€æœ›2æœŸ',
                regression: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—3æ¬¡å³åœï¼Œä¸è¿½å›æ­¸',
                trend: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡æˆ–é‡è±¹å­å¾Œè§€æœ›2æœŸ',
                extreme: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡å³åœï¼Œä¸è¿½æ¥µç«¯',
                random: 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡å³åœï¼›é‡è±¹å­è§€æœ›2æœŸ',
                triple: 'ğŸ›‘ åœæ‰‹ï¼šæœ€å¤šé€£æŠ¼3æœŸï¼Œä¹‹å¾Œå¿…é ˆåœ'
            };
            return conditions[strategyType] || 'ğŸ›‘ åœæ‰‹ï¼šé€£æ•—2æ¬¡å³åœï¼Œé‡åŠ›è€Œç‚º';
        }
        
        function generateSuggestions(signals) {
            const suggestions = [];
            const metrics = signals.raw;
            const pattern = signals.pattern;
            const winStats = metrics.winRateStats || { adjustment: 0, total: 0, recentWins: 0, recentTotal: 0 };
            const tripleOpp = metrics.tripleOpportunity;
            const diceAnalysis = metrics.diceAnalysis;
            
            const streak = metrics.currentStreak.count;
            const streakType = metrics.currentStreak.type;
            const dragon = analyzeDragon(records, 7);
            
            // ========== ç­–ç•¥è‡ªé©æ‡‰ï¼šè¨ˆç®—å„ç­–ç•¥è¡¨ç¾ ==========
            const strategyPerf = calculateStrategyPerformance();
            
            // ç²å–å„ç­–ç•¥çš„èª¿æ•´ä¿‚æ•¸
            const singleJumpAdj = getStrategyAdjustment(STRATEGY_TYPES.SINGLE_JUMP, strategyPerf);
            const doubleJumpAdj = getStrategyAdjustment(STRATEGY_TYPES.DOUBLE_JUMP, strategyPerf);
            const rideDragonAdj = getStrategyAdjustment(STRATEGY_TYPES.RIDE_DRAGON, strategyPerf);
            const breakDragonAdj = getStrategyAdjustment(STRATEGY_TYPES.BREAK_DRAGON, strategyPerf);
            const returnDragonAdj = getStrategyAdjustment(STRATEGY_TYPES.RETURN_DRAGON, strategyPerf);
            const regressionAdj = getStrategyAdjustment(STRATEGY_TYPES.REGRESSION, strategyPerf);
            const trendAdj = getStrategyAdjustment(STRATEGY_TYPES.TREND, strategyPerf);
            const extremeAdj = getStrategyAdjustment(STRATEGY_TYPES.EXTREME, strategyPerf);
            
            // ========== æ­¢ææª¢æŸ¥ ==========
            const recentLossRate = winStats.recentTotal >= 5 ? 
                (winStats.recentTotal - winStats.recentWins) / winStats.recentTotal : 0;
            const isLosingStreak = recentLossRate >= 0.7;
            
            // ========== æ ¹æ“šå‹ç‡å’Œç­–ç•¥è¡¨ç¾èª¿æ•´æ³¨ç¢¼ ==========
            // âš ï¸ é‡è¦è¦å‰‡ï¼š
            // 1. betMultiplier ä¸Šé™ç‚º 1.0ï¼ˆåŸºæº–ï¼‰ï¼Œä¸æœƒå› çŸ­æœŸå‹ç‡ä¸Šå‡è€ŒåŠ ç¢¼
            // 2. ç­–ç•¥è¡¨ç¾å¥½åªèƒ½ã€Œå›åˆ°åŸºæº–ã€ï¼Œä¸èƒ½ã€Œè¶…é¡ä¸‹æ³¨ã€
            // 3. é€£è™§æ™‚å¼·åˆ¶æ¸›æ³¨
            const adjustBets = (baseBets, strategyAdj = { betMultiplier: BASELINE_BET_MULTIPLIER }) => {
                // ç¢ºä¿ betMultiplier ä¸è¶…éåŸºæº–å€¼ï¼ˆç¦æ­¢åŠ ç¢¼ï¼‰
                const safeMult = Math.min(strategyAdj.betMultiplier, BASELINE_BET_MULTIPLIER);
                let adjusted = Math.round(baseBets * safeMult) + winStats.adjustment;
                if (isLosingStreak) adjusted = Math.max(1, adjusted - 2);
                return Math.max(1, Math.min(adjusted, MAX_BETS));
            };
            
            // ========== å»ºç«‹è©³ç´°ç†ç”±ï¼ˆæ¢åˆ—å¼ï¼Œå«è·¯å‹ã€åˆ†å¸ƒã€é¢¨éšªï¼‰==========
            const buildDetailedReason = (mainReason, details, strategyAdj) => {
                // å°‡æ¯å€‹ç´°ç¯€è½‰ç‚ºç¨ç«‹è¡Œï¼Œä¾¿æ–¼æ¢åˆ—é¡¯ç¤º
                const formattedDetails = details.map(d => `â€¢ ${d}`).join('\n');
                const adjText = strategyAdj && strategyAdj.status !== 'normal' 
                    ? `\nâ€¢ ğŸ“Š ç­–ç•¥èª¿æ•´ï¼š${strategyAdj.reason}` 
                    : '';
                return `${mainReason}\n${formattedDetails}${adjText}`;
            };
            
            // ===== å„ªå…ˆç´š1ï¼šæ˜ç¢ºè·¯å‹ï¼ˆæ ¸å¿ƒç­–ç•¥ï¼‰=====
            if (pattern && pattern.type !== 'random' && pattern.type !== 'insufficient') {
                // å–®è·³è·¯ï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´é–€æª»ï¼‰
                const singleJumpThreshold = 60 + singleJumpAdj.thresholdAdjust;
                if (pattern.type === 'singleJump' && pattern.confidence >= singleJumpThreshold && singleJumpAdj.enabled) {
                    const recentRatioText = pattern.recentRatio 
                        ? `å‰10æœŸäº¤æ›¿ç‡${(pattern.recentRatio * 100).toFixed(0)}%` 
                        : '';
                    const statusIcon = singleJumpAdj.status === 'hot' ? 'ğŸ”¥' : 
                                       singleJumpAdj.status === 'cold' ? 'â„ï¸' : '';
                    const details = [
                        `åˆ†æè¿‘${pattern.sampleSize || 20}æœŸï¼ˆå‰10æœŸæ¬Šé‡Ã—2ï¼‰`,
                        `åŠ æ¬Šäº¤æ›¿ç‡${(pattern.weightedRatio * 100).toFixed(0)}%`,
                        recentRatioText,
                        `ä¸ŠæœŸé–‹${records[0]?.type === 'big' ? 'å¤§' : 'å°'}ï¼Œé æ¸¬è·³${pattern.nextPredict === 'big' ? 'å¤§' : 'å°'}`
                    ].filter(d => d);
                    const strength = capSignalStrength(pattern.confidence);
                    const targetBet = pattern.nextPredict === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                    suggestions.push({
                        // çµæ§‹åŒ–æ¬„ä½ï¼ˆå¿…è¦ï¼‰
                        betTarget: targetBet,
                        strategyId: STRATEGY_TYPES.SINGLE_JUMP,
                        // é¡¯ç¤ºæ¬„ä½
                        type: `æŠ¼${targetBet === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                        reason: buildDetailedReason(`ğŸ”€ å–®è·³è·¯å‹ ${statusIcon}`, details, singleJumpAdj),
                        shortReason: `å–®è·³è·¯ï¼ˆ${strength.toFixed(0)}%ï¼‰${statusIcon}`,
                        bets: adjustBets(strength >= 75 ? 5 : strength >= 68 ? 4 : 3, singleJumpAdj),
                        odds: 2,
                        priority: 1,
                        signalStrength: strength,
                        riskLevel: strength >= 70 ? 'low' : 'medium',
                        strategyStatus: singleJumpAdj.status,
                        stopCondition: generateStopCondition('singleJump')
                    });
                // é›™è·³è·¯ï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´é–€æª»ï¼‰
                const doubleJumpThreshold = 55 + doubleJumpAdj.thresholdAdjust;
                } else if (pattern.type === 'doubleJump' && pattern.confidence >= doubleJumpThreshold && doubleJumpAdj.enabled) {
                    const statusIcon = doubleJumpAdj.status === 'hot' ? 'ğŸ”¥' : 
                                       doubleJumpAdj.status === 'cold' ? 'â„ï¸' : '';
                    const details = [
                        `åˆ†æè¿‘${pattern.sampleSize || 20}æœŸï¼ˆå‰10æœŸæ¬Šé‡Ã—2ï¼‰`,
                        `åŠ æ¬Šæˆå°ç‡${(pattern.weightedRatio * 100).toFixed(0)}%`,
                        `å‘ˆç¾é›™è·³è¦å¾‹ï¼ˆå¤§å¤§å°å°ï¼‰`,
                        `é æ¸¬ä¸‹æœŸï¼š${pattern.nextPredict === 'big' ? 'å¤§' : 'å°'}`
                    ];
                    const djStrength = capSignalStrength(pattern.confidence);
                    const djTargetBet = pattern.nextPredict === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                    suggestions.push({
                        betTarget: djTargetBet,
                        strategyId: STRATEGY_TYPES.DOUBLE_JUMP,
                        type: `æŠ¼${djTargetBet === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                        reason: buildDetailedReason(`ğŸ”„ é›™è·³è·¯å‹ ${statusIcon}`, details, doubleJumpAdj),
                        shortReason: `é›™è·³è·¯ï¼ˆ${djStrength.toFixed(0)}%ï¼‰${statusIcon}`,
                        bets: adjustBets(djStrength >= 70 ? 4 : 3, doubleJumpAdj),
                        odds: 2,
                        priority: 1,
                        signalStrength: djStrength,
                        riskLevel: 'medium',
                        strategyStatus: doubleJumpAdj.status,
                        stopCondition: generateStopCondition('doubleJump')
                    });
                }
            }
            
            // ===== å„ªå…ˆç´š2ï¼šé¾å‹¢ç­–ç•¥ï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´ï¼‰=====
            // æª¢æŸ¥æ–·é¾å†·å»ç‹€æ…‹
            const breakCooldown = checkBreakDragonCooldown();
            
            if (dragon && dragon.strategyHint) {
                const hint = dragon.strategyHint;
                // ä½¿ç”¨çµæ§‹åŒ– betTarget åˆ¤æ–·è¡çª
                const existingConflict = suggestions.length > 0 && 
                    suggestions[0].betTarget === (hint.target === 'big' ? BET_TARGET.SMALL : BET_TARGET.BIG);
                
                if (!existingConflict) {
                    // æ–·é¾ï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´é–€æª»ï¼Œé è¨­7æœŸï¼‰
                    const breakThreshold = 7 + Math.floor(breakDragonAdj.thresholdAdjust / 2);
                    
                    // æª¢æŸ¥æ˜¯å¦æ‡‰è©²æ–·é¾ï¼ˆè€ƒæ…®å†·å»æœŸï¼‰
                    if (dragon.status === 'breakable' && streak >= breakThreshold && breakDragonAdj.enabled) {
                        
                        // å¦‚æœæ–·é¾è™•æ–¼å†·å»æœŸï¼Œæ”¹ç‚ºå»ºè­°è·Ÿé¾æˆ–è§€æœ›
                        if (breakCooldown.inCooldown) {
                            const details = [
                                `å·²é€£çºŒ${streak}æœŸé–‹${streakType === 'big' ? 'å¤§' : 'å°'}`,
                                `âš ï¸ æ–·é¾é€£çºŒå¤±æ•—${breakCooldown.consecutiveFails}æ¬¡ï¼Œé€²å…¥å†·å»æœŸ`,
                                `å†·å»å‰©é¤˜ï¼š${breakCooldown.cooldownRemaining}æœŸ`,
                                `å»ºè­°ï¼šé †å‹¢å°æ³¨è·Ÿé¾ï¼Œæˆ–è§€æœ›ç­‰å¾…`
                            ];
                            
                            // é•·é¾è¶…é6æœŸæ™‚ï¼Œæ”¹å»ºè­°å°æ³¨è·Ÿé¾ï¼ˆé †å‹¢ï¼‰
                            if (streak >= 6) {
                                const cooldownTarget = streakType === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                                suggestions.push({
                                    betTarget: cooldownTarget,
                                    strategyId: STRATEGY_TYPES.RIDE_DRAGON,
                                    type: `æŠ¼${cooldownTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                                    reason: buildDetailedReason(`ğŸ‰ é †å‹¢è·Ÿé¾ï¼ˆæ–·é¾å†·å»ä¸­ï¼‰`, details),
                                    shortReason: `è·Ÿé¾ï¼ˆæ–·é¾å†·å»${breakCooldown.cooldownRemaining}æœŸï¼‰`,
                                    bets: adjustBets(2), // å°æ³¨
                                    odds: 2,
                                    priority: 2,
                                    signalStrength: capSignalStrength(45),
                                    riskLevel: 'medium',
                                    warning: `é•·é¾${streak}æœŸï¼Œæ–·é¾å¤±æ•—${breakCooldown.consecutiveFails}æ¬¡ï¼Œæš«æ™‚é †å‹¢`,
                                    stopCondition: generateStopCondition('rideDragon')
                                });
                            }
                            // ä¸å»ºè­°æ–·é¾
                        } else {
                            // æ­£å¸¸æ–·é¾å»ºè­°
                            const statusIcon = breakDragonAdj.status === 'hot' ? 'ğŸ”¥' : 
                                               breakDragonAdj.status === 'cold' ? 'â„ï¸' : '';
                            const details = [
                                `å·²é€£çºŒ${streak}æœŸé–‹${streakType === 'big' ? 'å¤§' : 'å°'}`,
                                `é•·é¾çµ‚æœƒçµæŸï¼Œä½†æ™‚æ©Ÿé›£æ¸¬`,
                                `âš ï¸ é«˜é¢¨éšªé€†å‹¢æ“ä½œ`,
                                `å»ºè­°ï¼šæœ€å°æ³¨è©¦æ¢ï¼Œåˆ‡å‹¿è¿½åŠ `
                            ];
                            const breakTarget = hint.target === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                            // âš ï¸ å°ˆæ¥­ä¿®æ­£ï¼šæ–·é¾è¨Šè™Ÿå¼·åº¦ä¸æ‡‰éš¨é€£çºŒæœŸæ•¸å¢åŠ 
                            // é€™æ˜¯è³­å¾’è¬¬èª¤ - æ¯å±€éª°å­çµæœéƒ½æ˜¯ç¨ç«‹çš„
                            // é€£çºŒ10æœŸå¤§ä¸¦ä¸ä»£è¡¨ä¸‹æœŸé–‹å°çš„æ©Ÿç‡æ›´é«˜
                            const breakSignalStrength = 45; // å›ºå®šä½è¨Šè™Ÿï¼Œåæ˜ é«˜é¢¨éšªæœ¬è³ª
                            suggestions.push({
                                betTarget: breakTarget,
                                strategyId: STRATEGY_TYPES.BREAK_DRAGON,
                                type: `æŠ¼${breakTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                                reason: buildDetailedReason(`âš”ï¸ æ–·é¾ç­–ç•¥ ${statusIcon}`, details, breakDragonAdj),
                                shortReason: `æ–·${streak}æœŸ${streakType === 'big' ? 'å¤§' : 'å°'}é¾ ${statusIcon}`,
                                // âš ï¸ æ–·é¾ç­–ç•¥ä¸å…è¨±åŠ ç¢¼ï¼Œå›ºå®šæœ€å¤§æ³¨ç¢¼
                                bets: Math.min(BREAK_DRAGON_MAX_BETS, adjustBets(2, breakDragonAdj)),
                                odds: 2,
                                priority: 2,
                                signalStrength: capSignalStrength(breakSignalStrength),
                                riskLevel: 'high',
                                warning: 'âš ï¸ é«˜é¢¨éšªé€†å‹¢æ“ä½œï¼æ¯å±€çµæœç¨ç«‹ï¼Œé•·é¾ä¸ä»£è¡¨å¿…æ–·ã€‚åš´ç¦åŠ ç¢¼ï¼',
                                strategyStatus: breakDragonAdj.status,
                                stopCondition: generateStopCondition('breakDragon'),
                                noIncrease: true  // æ¨™è¨˜ï¼šç¦æ­¢åŠ ç¢¼
                            });
                        }
                    } 
                    // å›é¾ï¼šé•·é¾å‰›æ–·å¾Œçš„å›å½ˆï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´ï¼‰
                    else if (dragon.status === 'returning' && returnDragonAdj.enabled) {
                        const prevLen = dragon.prevDragon?.length || 6;
                        const statusIcon = returnDragonAdj.status === 'hot' ? 'ğŸ”¥' : 
                                           returnDragonAdj.status === 'cold' ? 'â„ï¸' : '';
                        const details = [
                            `ä¸Šä¸€æ¢${prevLen}æœŸé•·é¾å‰›æ–·`,
                            `éƒ¨åˆ†ç©å®¶åå¥½æŠ¼å›åŸæ–¹å‘ï¼ˆå¿ƒç†å› ç´ ï¼‰`,
                            `âš ï¸ æ³¨æ„ï¼šæ¯å±€çµæœä»ç‚ºç¨ç«‹äº‹ä»¶`,
                            `æŠ¼å›åŸé¾æ–¹å‘ï¼š${hint.target === 'big' ? 'å¤§' : 'å°'}`
                        ];
                        const returnTarget = hint.target === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                        suggestions.push({
                            betTarget: returnTarget,
                            strategyId: STRATEGY_TYPES.RETURN_DRAGON,
                            type: `æŠ¼${returnTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                            reason: buildDetailedReason(`ğŸ”„ å›é¾ç­–ç•¥ ${statusIcon}`, details, returnDragonAdj),
                            shortReason: `å›é¾ï¼ˆåŸ${prevLen}æœŸé¾ï¼‰${statusIcon}`,
                            bets: adjustBets(prevLen >= 8 ? 4 : 3, returnDragonAdj),
                            odds: 2,
                            priority: 2,
                            signalStrength: capSignalStrength(Math.min(55 + prevLen * 2, 70)),
                            riskLevel: 'medium',
                            strategyStatus: returnDragonAdj.status,
                            stopCondition: generateStopCondition('returnDragon')
                        });
                    } 
                    // è·Ÿé¾ï¼šé †å‹¢æ“ä½œï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´ï¼‰
                    // âš ï¸ é•·é¾æœ€å¤§å®¹å¿é•·åº¦é™åˆ¶
                    else if (dragon.status === 'riding' && streak >= 3 && rideDragonAdj.enabled) {
                        const rideTarget = streakType === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                        // ä½¿ç”¨ betTarget åˆ¤æ–·æ˜¯å¦å·²æœ‰ç›¸åŒç›®æ¨™
                        const existingSame = suggestions.find(s => s.betTarget === rideTarget);
                        
                        const isGoldenPeriod = streak >= 3 && streak <= 5;
                        const shouldDegrade = streak >= RIDE_DRAGON_DEGRADE_STREAK;
                        const exceedsMaxTolerance = streak >= RIDE_DRAGON_MAX_STREAK;
                        const statusIcon = rideDragonAdj.status === 'hot' ? 'ğŸ”¥' : 
                                           rideDragonAdj.status === 'cold' ? 'â„ï¸' : '';
                        
                        // ===== è¶…éæœ€å¤§å®¹å¿é•·åº¦ï¼Œæ”¹ç‚ºè§€æœ› =====
                        if (exceedsMaxTolerance) {
                            const observeDetails = [
                                `âš ï¸ é€£çºŒ${streak}æœŸå·²è¶…éæœ€å¤§å®¹å¿é•·åº¦ï¼ˆ${RIDE_DRAGON_MAX_STREAK}æœŸï¼‰`,
                                `æ¥µç«¯è·¯å‹é¢¨éšªæ¥µé«˜ï¼Œä¸å®œç¹¼çºŒè¿½å–®`,
                                `å»ºè­°ï¼šæš«åœè§€æœ›ï¼Œç­‰å¾…é¾æ–·å¾Œå†è¡Œå‹•`
                            ];
                            suggestions.push({
                                betTarget: BET_TARGET.OBSERVE,
                                strategyId: STRATEGY_TYPES.OBSERVE,
                                type: 'è§€æœ›',
                                reason: buildDetailedReason(`ğŸ›‘ é•·é¾è¶…é™è§€æœ›`, observeDetails),
                                shortReason: `é•·é¾${streak}æœŸï¼Œè¶…é™è§€æœ›`,
                                bets: 0,
                                odds: 0,
                                priority: 2,
                                signalStrength: 0,
                                riskLevel: 'observe',
                                warning: `é€£çºŒ${streak}æœŸæ¥µç«¯è·¯å‹ï¼Œå¼·åˆ¶è§€æœ›`,
                                stopCondition: 'ç­‰å¾…é•·é¾çµæŸå¾Œå†è¡Œå‹•'
                            });
                        } else {
                            // æ­£å¸¸è·Ÿé¾ï¼ˆæœªè¶…é™ï¼‰
                            const details = [
                                `ç›®å‰é€£çºŒ${streak}æœŸé–‹${streakType === 'big' ? 'å¤§' : 'å°'}`,
                                isGoldenPeriod ? `3-5æœŸæ˜¯è·Ÿé¾é»ƒé‡‘æœŸ` : 
                                    shouldDegrade ? `âš ï¸ å·²é”${RIDE_DRAGON_DEGRADE_STREAK}æœŸï¼Œé™ç´šæ¸›æ³¨` : `è¶…é5æœŸï¼Œéš¨æ™‚å¯èƒ½çµæŸ`,
                                `é †å‹¢è€Œç‚ºï¼Œä½†è¨­å¥½æ­¢æ`
                            ];
                            
                            // é™ç´šæ™‚é™ä½ä¿¡å¿ƒåº¦å’Œæ³¨ç¢¼
                            const baseConf = isGoldenPeriod ? 65 : 
                                shouldDegrade ? Math.max(40, 60 - (streak - RIDE_DRAGON_DEGRADE_STREAK) * 5) :
                                Math.max(50, 70 - (streak - 5) * 5);
                            const baseBets = isGoldenPeriod ? (streak >= 4 ? 4 : 3) : 
                                shouldDegrade ? 2 : 3;  // é™ç´šæ™‚æ¸›æ³¨
                            
                            if (existingSame) {
                                // é™ç´šæ™‚ä¸åŠ ç¢¼
                                if (!shouldDegrade) {
                                    existingSame.bets = Math.min(existingSame.bets + (isGoldenPeriod ? 2 : 1), MAX_BETS);
                                }
                                existingSame.reason += `\nğŸ‰ é¾å‹¢åŠ æŒï¼šé€£${streak}æœŸ`;
                                if (shouldDegrade) {
                                    existingSame.warning = (existingSame.warning || '') + `ï¼›âš ï¸ é•·é¾${streak}æœŸï¼Œé™ç´šæ¸›æ³¨`;
                                }
                            } else {
                                suggestions.push({
                                    betTarget: rideTarget,
                                    strategyId: STRATEGY_TYPES.RIDE_DRAGON,
                                    type: `æŠ¼${rideTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                                    reason: buildDetailedReason(`ğŸ‰ è·Ÿé¾ç­–ç•¥ ${statusIcon}`, details, rideDragonAdj),
                                    shortReason: `è·Ÿé¾ï¼ˆé€£${streak}æœŸ${streakType === 'big' ? 'å¤§' : 'å°'}ï¼‰${statusIcon}`,
                                    bets: adjustBets(baseBets, rideDragonAdj),
                                    odds: 2,
                                    priority: 2,
                                    signalStrength: capSignalStrength(baseConf),
                                    riskLevel: shouldDegrade ? 'high' : (streak > 5 ? 'medium' : 'low'),
                                    warning: shouldDegrade ? `âš ï¸ é•·é¾${streak}æœŸï¼Œé¢¨éšªå‡é«˜ï¼Œé™ç´šæ¸›æ³¨` : 
                                        (streak > 5 ? `é€£${streak}æœŸï¼Œæ³¨æ„éš¨æ™‚å¯èƒ½æ–·é¾` : null),
                                    strategyStatus: rideDragonAdj.status,
                                    stopCondition: generateStopCondition('rideDragon')
                                });
                            }
                        }
                    }
                }
            }
            
            // ===== å„ªå…ˆç´š3ï¼šæ¯”ä¾‹å›æ­¸ï¼ˆæ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´ï¼‰=====
            // âš ï¸ æ¯”ä¾‹å›æ­¸éœ€åŒæ™‚æ»¿è¶³å¤šé …æ¢ä»¶ï¼š
            // 1. åå·®ç­‰ç´šé”é–€æª»
            // 2. æœŸæ•¸é”æœ€å°è¦æ±‚
            // 3. ä¸å­˜åœ¨æ˜é¡¯é•·é¾
            const regressionThreshold = REGRESSION_MIN_DEVIATION + Math.floor(regressionAdj.thresholdAdjust / 3);
            const hasLongDragon = streak >= REGRESSION_NO_DRAGON_THRESHOLD;
            const meetsRegressionCriteria = 
                signals.deviationLevel >= regressionThreshold && 
                metrics.total >= REGRESSION_MIN_PERIODS && 
                !hasLongDragon &&  // âš ï¸ ä¸å¯å­˜åœ¨é•·é¾
                regressionAdj.enabled;
            
            if (meetsRegressionCriteria) {
                const regTarget = metrics.bigRatio > 0.5 ? BET_TARGET.SMALL : BET_TARGET.BIG;
                const existingSame = suggestions.find(s => s.betTarget === regTarget);
                const statusIcon = regressionAdj.status === 'hot' ? 'ğŸ”¥' : 
                                   regressionAdj.status === 'cold' ? 'â„ï¸' : '';
                const details = [
                    `è¿‘${metrics.total}æœŸå¤§å°æ¯”ä¾‹ï¼šå¤§${(metrics.bigRatio * 100).toFixed(0)}% / å°${((1-metrics.bigRatio) * 100).toFixed(0)}%`,
                    `åé›¢å‡è¡¡å€¼${(metrics.deviation * 100).toFixed(0)}%`,
                    `âœ“ ç›®å‰ç„¡æ˜é¡¯é•·é¾ï¼ˆé€£çºŒ<${REGRESSION_NO_DRAGON_THRESHOLD}æœŸï¼‰`,
                    `âš ï¸ å›æ­¸å‡å€¼æ˜¯é•·æœŸçµ±è¨ˆç¾è±¡ï¼Œéä¸‹æœŸé æ¸¬`,
                    `âš ï¸ çŸ­æœŸåé›¢å¯èƒ½æŒçºŒï¼Œæ™‚æ©Ÿä¸å¯é æ¸¬`
                ];
                
                if (existingSame) {
                    existingSame.bets = Math.min(existingSame.bets + 1, MAX_BETS);
                    existingSame.reason += `\nğŸ“Š æ¯”ä¾‹å›æ­¸è¼”åŠ©`;
                } else if (suggestions.length === 0 && signals.deviationLevel >= regressionThreshold) {
                    suggestions.push({
                        betTarget: regTarget,
                        strategyId: STRATEGY_TYPES.REGRESSION,
                        type: `æŠ¼${regTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                        reason: buildDetailedReason(`ğŸ“Š æ¯”ä¾‹å›æ­¸ ${statusIcon}`, details, regressionAdj),
                        shortReason: `è¿½å›æ­¸ï¼ˆå¤§${(metrics.bigRatio * 100).toFixed(0)}%ï¼‰${statusIcon}`,
                        bets: adjustBets(3, regressionAdj),
                        odds: 2,
                        priority: 3,
                        strategyStatus: regressionAdj.status,
                        signalStrength: capSignalStrength(45 + signals.deviationLevel * 5),
                        riskLevel: 'medium',
                        warning: 'å›æ­¸æ™‚æ©Ÿé›£ä»¥é æ¸¬ï¼Œå»ºè­°å°æ³¨é•·æœŸæ“ä½œ',
                        stopCondition: generateStopCondition('regression')
                    });
                }
            }
            
            // ===== å„ªå…ˆç´š4ï¼šè±¹å­å¨›æ¨‚åƒè€ƒï¼ˆå®Œå…¨ç¨ç«‹ï¼Œåƒ…ç‚ºæç¤ºï¼‰=====
            // âš ï¸ é‡è¦é™åˆ¶ï¼š
            // 1. è±¹å­æ©Ÿç‡å›ºå®š2.78%ï¼Œæ­·å²æ•¸æ“šä¸å½±éŸ¿æœªä¾†
            // 2. æ­¤åŠŸèƒ½åƒ…ç‚ºå¨›æ¨‚åƒè€ƒï¼Œå¹«åŠ©ç©å®¶åœ¨æƒ³æŠ¼è±¹å­æ™‚æœ‰å€‹é¸æ“‡ä¾æ“š
            // 3. ä¸å¾—èˆ‡å¤§å°ç­–ç•¥ä¿¡è™Ÿç–ŠåŠ 
            // 4. ä¸å¾—ç”¨æ–¼æé«˜ä¿¡å¿ƒåº¦æˆ–ä¸‹æ³¨å¼·åº¦
            // 5. å›ºå®š1æ³¨ï¼Œç¦æ­¢åŠ ç¢¼
            if (tripleOpp && tripleOpp.hasOpportunity && metrics.tripleGap >= 15) {
                const typeLabel = tripleOpp.type === 'hot' ? 'ç†±è™Ÿ' : 
                                  tripleOpp.type === 'cold' ? 'å†·è™Ÿ' : 'æº«è™Ÿ';
                const typeEmoji = tripleOpp.type === 'hot' ? 'ğŸ”¥' : 
                                  tripleOpp.type === 'cold' ? 'â„ï¸' : 'ğŸŒ¡ï¸';
                
                const details = [
                    tripleOpp.reason,
                    tripleOpp.note,
                    `å·²${metrics.tripleGap}æœŸæœªå‡ºè±¹å­`,
                    `âš ï¸ è±¹å­æ©Ÿç‡å›ºå®š2.78%ï¼Œæ­¤åˆ†æåƒ…ä¾›å¨›æ¨‚åƒè€ƒ`,
                    `âš ï¸ æ­¤å»ºè­°ç¨ç«‹æ–¼å¤§å°ç­–ç•¥ï¼Œä¸å½±éŸ¿å…¶ä»–å»ºè­°`
                ];
                
                if (tripleOpp.level === 'high') {
                    // ä¸‰éª°å…±åŒè™Ÿç¢¼
                    suggestions.push({
                        betTarget: BET_TARGET.TRIPLE,
                        strategyId: STRATEGY_TYPES.TRIPLE,
                        tripleNumber: tripleOpp.numbers[0],
                        type: `æŒ‡å®šè±¹å­ ${tripleOpp.numbers[0]}`,
                        reason: buildDetailedReason(`ğŸ² è±¹å­å¨›æ¨‚ï¼ˆ${typeEmoji}${typeLabel}ï¼‰`, details),
                        shortReason: `ä¸‰éª°${typeLabel}${tripleOpp.numbers[0]}`,
                        bets: 1,           // âš ï¸ å›ºå®š1æ³¨ï¼Œç¦æ­¢åŠ ç¢¼
                        odds: 150,
                        priority: 99,      // âš ï¸ æœ€ä½å„ªå…ˆç´šï¼Œä¸å½±éŸ¿å…¶ä»–å»ºè­°æ’åº
                        signalStrength: 0, // âš ï¸ ä¿¡è™Ÿå¼·åº¦ç‚º0ï¼Œä¸è¨ˆå…¥å¹³å‡
                        riskLevel: 'entertainment',
                        warning: 'ğŸ° ç´”å¨›æ¨‚æç¤ºï¼Œæ©Ÿç‡ä¸è®Šï¼Œåˆ‡å‹¿é‡æ³¨',
                        stopCondition: generateStopCondition('triple'),
                        isEntertainmentOnly: true,  // æ¨™è¨˜ï¼šç´”å¨›æ¨‚
                        noStackWithBigSmall: true   // æ¨™è¨˜ï¼šä¸èˆ‡å¤§å°ç–ŠåŠ 
                    });
                } else if (tripleOpp.level === 'medium' && metrics.tripleGap >= 20) {
                    // å…©éª°å…±åŒè™Ÿç¢¼ï¼Œé–€æª»æ›´é«˜
                    suggestions.push({
                        betTarget: BET_TARGET.TRIPLE,
                        strategyId: STRATEGY_TYPES.TRIPLE,
                        tripleNumber: tripleOpp.numbers[0],
                        type: `æŒ‡å®šè±¹å­ ${tripleOpp.numbers[0]}`,
                        reason: buildDetailedReason(`ğŸ² è±¹å­å¨›æ¨‚ï¼ˆ${typeEmoji}å…©éª°${typeLabel}ï¼‰`, details),
                        shortReason: `å…©éª°${typeLabel}${tripleOpp.numbers[0]}`,
                        bets: 1,           // âš ï¸ å›ºå®š1æ³¨ï¼Œç¦æ­¢åŠ ç¢¼
                        odds: 150,
                        priority: 99,      // âš ï¸ æœ€ä½å„ªå…ˆç´š
                        signalStrength: 0, // âš ï¸ ä¿¡è™Ÿå¼·åº¦ç‚º0ï¼Œä¸è¨ˆå…¥å¹³å‡
                        riskLevel: 'entertainment',
                        warning: 'ğŸ° ç´”å¨›æ¨‚æç¤ºï¼Œæ©Ÿç‡ä¸è®Šï¼Œåˆ‡å‹¿é‡æ³¨',
                        stopCondition: generateStopCondition('triple'),
                        isEntertainmentOnly: true,
                        noStackWithBigSmall: true
                    });
                }
            } 
            // é•·æ™‚é–“æœªå‡ºè±¹å­æ™‚ï¼Œä¹Ÿæä¾›ä»»æ„è±¹å­é¸é …ï¼ˆç´”å¨›æ¨‚æç¤ºï¼‰
            else if (metrics.tripleGap >= 25) {
                const details = [
                    `å·²${metrics.tripleGap}æœŸæœªå‡ºè±¹å­`,
                    `ç†è«–ä¸Šæ¯36æœŸå¹³å‡å‡ºç¾1æ¬¡`,
                    `âš ï¸ è±¹å­æ©Ÿç‡å›ºå®š2.78%ï¼Œæ­·å²ä¸å½±éŸ¿æœªä¾†`,
                    `ç´”å¨›æ¨‚æ€§è³ªï¼Œåˆ‡å‹¿é‡æ³¨`,
                    `âš ï¸ æ­¤å»ºè­°ç¨ç«‹æ–¼å¤§å°ç­–ç•¥`
                ];
                
                suggestions.push({
                    betTarget: BET_TARGET.ANY_TRIPLE,
                    strategyId: STRATEGY_TYPES.TRIPLE,
                    type: 'ä»»æ„è±¹å­',
                    reason: buildDetailedReason(`ğŸ² è±¹å­å¨›æ¨‚`, details),
                    shortReason: `${metrics.tripleGap}æœŸæœªå‡ºè±¹å­`,
                    bets: 1,           // âš ï¸ å›ºå®š1æ³¨ï¼Œç¦æ­¢åŠ ç¢¼
                    odds: 30,
                    priority: 99,      // âš ï¸ æœ€ä½å„ªå…ˆç´š
                    signalStrength: 0, // âš ï¸ ä¿¡è™Ÿå¼·åº¦ç‚º0ï¼Œä¸è¨ˆå…¥å¹³å‡
                    riskLevel: 'entertainment',
                    warning: 'ğŸ° ç´”å¨›æ¨‚æç¤ºï¼Œæ©Ÿç‡å›ºå®šï¼Œä¸å»ºè­°è¿½åŠ ',
                    stopCondition: generateStopCondition('triple'),
                    isEntertainmentOnly: true,  // æ¨™è¨˜ï¼šç´”å¨›æ¨‚
                    noStackWithBigSmall: true   // æ¨™è¨˜ï¼šä¸èˆ‡å¤§å°ç–ŠåŠ 
                });
            }
            
            // ===== å„ªå…ˆç´š5ï¼šè¶¨å‹¢å»¶çºŒï¼ˆçŸ­é€£çºŒï¼‰=====
            if (suggestions.length === 0 && streak >= 2 && streakType && streakType !== 'triple') {
                const trendTarget = streakType === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                const details = [
                    `é€£çºŒ${streak}æœŸé–‹${streakType === 'big' ? 'å¤§' : 'å°'}`,
                    `è¶¨å‹¢å°šçŸ­ï¼Œä¿¡è™Ÿè¼ƒå¼±`,
                    `å»ºè­°æœ€å°æ³¨è§€å¯Ÿï¼Œç­‰å¾…æ›´æ˜ç¢ºä¿¡è™Ÿ`
                ];
                suggestions.push({
                    betTarget: trendTarget,
                    strategyId: STRATEGY_TYPES.TREND,
                    type: `æŠ¼${trendTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                    reason: buildDetailedReason(`ğŸ“ˆ è¶¨å‹¢å»¶çºŒ`, details),
                    shortReason: `é€£${streak}æœŸ${streakType === 'big' ? 'å¤§' : 'å°'}`,
                    bets: adjustBets(2),
                    odds: 2,
                    priority: 5,
                    signalStrength: capSignalStrength(42),
                    riskLevel: 'medium',
                    stopCondition: generateStopCondition('trend')
                });
            }
            
            // ===== å„ªå…ˆç´š6ï¼šè¿‘5æœŸæ¥µç«¯ =====
            if (suggestions.length === 0 && signals.extreme5) {
                const extremeTarget = signals.extreme5 === 'big' ? BET_TARGET.SMALL : BET_TARGET.BIG;
                const count = signals.extreme5 === 'big' ? metrics.recentBig : metrics.recentSmall;
                const details = [
                    `è¿‘5æœŸ${signals.extreme5 === 'big' ? 'å¤§' : 'å°'}å‡ºç¾${count}æ¬¡`,
                    `çŸ­æœŸæ¥µç«¯å¯èƒ½åè½‰`,
                    `ä½†ä¹Ÿå¯èƒ½å»¶çºŒï¼Œè¬¹æ…æ“ä½œ`
                ];
                suggestions.push({
                    betTarget: extremeTarget,
                    strategyId: STRATEGY_TYPES.EXTREME,
                    type: `æŠ¼${extremeTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                    reason: buildDetailedReason(`ğŸ¯ çŸ­æœŸæ¥µç«¯`, details),
                    shortReason: `è¿‘5æœŸ${signals.extreme5 === 'big' ? 'å¤§' : 'å°'}${count}æ¬¡`,
                    bets: adjustBets(2),
                    odds: 2,
                    priority: 6,
                    signalStrength: capSignalStrength(45),
                    riskLevel: 'medium',
                    stopCondition: generateStopCondition('extreme')
                });
            }
            
            // ===== å„ªå…ˆç´š7ï¼šäº‚è·¯åˆ†æï¼ˆæ”¹é€²ç‰ˆï¼‰=====
            if (suggestions.length === 0 && records.length >= 5) {
                // åˆ†æè¿‘5æœŸçš„è®ŠåŒ–ç¯€å¥
                const recent5 = records.slice(0, 5).filter(r => isBigSmall(r));
                const recent5Big = recent5.filter(r => r.type === 'big').length;
                const lastType = records[0]?.type;
                
                // è¨ˆç®—è®ŠåŒ–æ¬¡æ•¸ï¼ˆç”¨æ–¼åˆ¤æ–·æ˜¯å¦çœŸçš„äº‚ï¼‰
                let changes = 0;
                for (let i = 0; i < recent5.length - 1; i++) {
                    if (recent5[i].type !== recent5[i+1].type) changes++;
                }
                const changeRate = changes / (recent5.length - 1);
                
                let randomTarget, reason, details;
                
                if (lastType === 'triple') {
                    // è±¹å­å¾Œï¼Œåƒè€ƒå‰ä¸€æœŸä½†æ¸›æ³¨
                    const prevType = records[1]?.type;
                    randomTarget = prevType === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                    reason = 'äº‚è·¯ - è±¹å­å¾Œè§€æœ›';
                    details = ['ä¸ŠæœŸé–‹è±¹å­', 'åƒè€ƒå‰æœŸä½†ä¿¡è™Ÿå¼±', 'å»ºè­°æœ€å°æ³¨æˆ–è§€æœ›'];
                } else if (changeRate >= 0.6) {
                    // è®ŠåŒ–é »ç¹ï¼Œåå‘è·³
                    randomTarget = lastType === 'big' ? BET_TARGET.SMALL : BET_TARGET.BIG;
                    reason = 'äº‚è·¯ - é »ç¹è®ŠåŒ–å‚¾å‘è·³';
                    details = [`è¿‘æœŸè®ŠåŒ–ç‡${(changeRate*100).toFixed(0)}%`, 'å‚¾å‘è·³è½‰', 'ä¿¡è™Ÿå¼±ï¼Œæœ€å°æ³¨'];
                } else if (recent5Big >= 3) {
                    randomTarget = BET_TARGET.BIG;
                    reason = 'äº‚è·¯ - è¿‘æœŸåå¤§';
                    details = ['è¿‘5æœŸå¤§å¤šæ–¼å°', 'ç„¡æ˜é¡¯è·¯å‹', 'é †å‹¢æœ€å°æ³¨'];
                } else if (recent5Big <= 2) {
                    randomTarget = BET_TARGET.SMALL;
                    reason = 'äº‚è·¯ - è¿‘æœŸåå°';
                    details = ['è¿‘5æœŸå°å¤šæ–¼å¤§', 'ç„¡æ˜é¡¯è·¯å‹', 'é †å‹¢æœ€å°æ³¨'];
                } else {
                    randomTarget = lastType === 'big' ? BET_TARGET.BIG : BET_TARGET.SMALL;
                    reason = 'äº‚è·¯ - è·Ÿéš¨æœ€æ–°';
                    details = ['è¿‘æœŸå‡å‹¢', 'ç„¡æ˜é¡¯è¦å¾‹', 'è·Ÿéš¨æœ€æ–°çµæœ'];
                }
                
                suggestions.push({
                    betTarget: randomTarget,
                    strategyId: STRATEGY_TYPES.RANDOM,
                    type: `æŠ¼${randomTarget === BET_TARGET.BIG ? 'å¤§' : 'å°'}`,
                    reason: buildDetailedReason(`ğŸ’¡ ${reason}`, details),
                    shortReason: reason,
                    bets: adjustBets(2), // äº‚è·¯å›ºå®šæœ€å°æ³¨
                    odds: 2,
                    priority: 7,
                    signalStrength: capSignalStrength(40),
                    riskLevel: 'low',
                    betAdvice: 'ä¿¡è™Ÿè¼ƒå¼±ï¼Œå»ºè­°æœ€å°æ³¨',
                    stopCondition: generateStopCondition('random')
                });
            }
            
            // ========== æ­¢æè­¦å‘Šï¼ˆé€£çºŒè™§ææ™‚ï¼‰==========
            if (isLosingStreak && suggestions.length > 0) {
                suggestions.forEach(s => {
                    s.warning = s.warning 
                        ? s.warning + 'ï¼›ğŸ›‘ é€£çºŒè™§æä¸­ï¼Œå¼·çƒˆå»ºè­°æ¸›æ³¨æˆ–æš«åœ'
                        : 'ğŸ›‘ è¿‘æœŸé€£çºŒè™§æï¼Œå»ºè­°æ¸›æ³¨æˆ–æš«åœè§€æœ›';
                    s.riskLevel = 'high';
                });
            }
            
            // ========== å‹ç‡èª¿æ•´æç¤º ==========
            if (winStats.total >= 10 && suggestions.length > 0) {
                if (winStats.adjustment > 0) {
                    suggestions[0].betAdvice = `ğŸ“ˆ ç´¯è¨ˆå‹ç‡${winStats.rate.toFixed(0)}%ä½³ï¼Œå¯é©åº¦åŠ æ³¨`;
                } else if (winStats.adjustment < -1) {
                    suggestions[0].betAdvice = `ğŸ“‰ ç´¯è¨ˆå‹ç‡${winStats.rate.toFixed(0)}%åä½ï¼Œå»ºè­°æ¸›æ³¨`;
                    suggestions.forEach(s => s.bets = Math.max(1, s.bets - 1));
                }
            }
            
            // ========== è¡çªæª¢æ¸¬èˆ‡è§€æœ›å»ºè­° ==========
            // ä½¿ç”¨çµæ§‹åŒ– betTarget æª¢æ¸¬ç­–ç•¥è¡çª
            // âš ï¸ æ’é™¤å¨›æ¨‚å»ºè­°ï¼ˆè±¹å­ï¼‰ï¼Œä¸åƒèˆ‡è¡çªæª¢æ¸¬å’Œè¨Šè™Ÿè¨ˆç®—
            const mainSuggestions = suggestions.filter(s => !s.isEntertainmentOnly);
            const entertainmentSuggestions = suggestions.filter(s => s.isEntertainmentOnly);
            
            const bigSuggestions = mainSuggestions.filter(s => s.betTarget === BET_TARGET.BIG);
            const smallSuggestions = mainSuggestions.filter(s => s.betTarget === BET_TARGET.SMALL);
            const hasConflict = bigSuggestions.length > 0 && smallSuggestions.length > 0;
            
            // æª¢æ¸¬è¨Šè™Ÿå¼·åº¦ä¸è¶³ï¼ˆåªè¨ˆç®—ä¸»å»ºè­°ï¼Œæ’é™¤å¨›æ¨‚å»ºè­°ï¼‰
            const maxSignal = mainSuggestions.length > 0 
                ? Math.max(...mainSuggestions.map(s => s.signalStrength || 0)) 
                : 0;
            const weakSignal = maxSignal < 50 && mainSuggestions.length > 0;
            
            // ç­–ç•¥è¡çªæ™‚ï¼šåªä¿ç•™è¨Šè™Ÿæœ€å¼·çš„ï¼Œå…¶é¤˜é™ç´šç‚ºè§€æœ›
            if (hasConflict) {
                const strongest = suggestions.reduce((best, s) => 
                    (s.signalStrength || 0) > (best.signalStrength || 0) ? s : best
                );
                
                // å¦‚æœæœ€å¼·è¨Šè™Ÿä¹Ÿå¾ˆå¼±ï¼Œå…¨éƒ¨æ”¹ç‚ºè§€æœ›
                if ((strongest.signalStrength || 0) < 55) {
                    suggestions.length = 0; // æ¸…ç©º
                    suggestions.push({
                        betTarget: BET_TARGET.OBSERVE,
                        strategyId: STRATEGY_TYPES.OBSERVE,
                        type: 'è§€æœ›',
                        reason: 'âš ï¸ ç­–ç•¥è¨Šè™Ÿè¡çª\nğŸ“‹ å¤šå€‹ç­–ç•¥æŒ‡å‘ä¸åŒæ–¹å‘ï¼ˆå¤§/å°ï¼‰ï¼Œä¸”è¨Šè™Ÿå¼·åº¦å‡ä¸è¶³55%\nå»ºè­°ï¼šæš«æ™‚è§€æœ›ï¼Œç­‰å¾…æ›´æ˜ç¢ºä¿¡è™Ÿ',
                        shortReason: 'è¨Šè™Ÿè¡çªï¼Œå»ºè­°è§€æœ›',
                        bets: 0,
                        odds: 0,
                        priority: 0,
                        signalStrength: 0,
                        riskLevel: 'observe',
                        stopCondition: 'ç­‰å¾…è¨Šè™Ÿæ˜ç¢ºå¾Œå†è¡Œå‹•'
                    });
                } else {
                    // ä½¿ç”¨ betTarget åˆ¤æ–·è¡çªç›®æ¨™ï¼Œç§»é™¤è¡çªé …
                    const conflictTarget = strongest.betTarget === BET_TARGET.BIG ? BET_TARGET.SMALL : BET_TARGET.BIG;
                    for (let i = suggestions.length - 1; i >= 0; i--) {
                        if (suggestions[i].betTarget === conflictTarget) {
                            suggestions.splice(i, 1);
                        }
                    }
                    // åŠ è­¦å‘Š
                    suggestions[0].warning = (suggestions[0].warning || '') + 
                        `ï¼›âš ï¸ æœ‰è¡çªè¨Šè™Ÿï¼Œåƒ…ä¿ç•™æœ€å¼·è¨Šè™Ÿ`;
                }
            }
            
            // è¨Šè™Ÿå…¨éƒ¨å¾ˆå¼±æ™‚ï¼šæ”¹ç‚ºå°æ³¨è©¦æ¢æˆ–è§€æœ›
            if (weakSignal && !hasConflict && suggestions.length > 0) {
                // å°‡æ‰€æœ‰å»ºè­°æ”¹ç‚ºæœ€å°æ³¨
                suggestions.forEach(s => {
                    s.bets = 1;
                    s.warning = (s.warning || '') + 'ï¼›âš ï¸ è¨Šè™Ÿå¼·åº¦ä¸è¶³ï¼Œå»ºè­°å°æ³¨è©¦æ¢æˆ–è§€æœ›';
                    s.riskLevel = 'medium';
                });
                
                // æœ€é«˜è¨Šè™Ÿä½æ–¼40%æ™‚ï¼Œé¡å¤–åŠ è§€æœ›é¸é …
                if (maxSignal < 40) {
                    suggestions.unshift({
                        betTarget: BET_TARGET.OBSERVE,
                        strategyId: STRATEGY_TYPES.OBSERVE,
                        type: 'è§€æœ›ç‚ºä¸»',
                        reason: `âš ï¸ è¨Šè™Ÿå¼·åº¦åå¼±ï¼ˆæœ€é«˜${maxSignal.toFixed(0)}%ï¼‰\nğŸ“‹ ç›®å‰ç„¡æ˜ç¢ºè·¯å‹æˆ–è¶¨å‹¢\nå»ºè­°ï¼šè§€æœ›æˆ–æ¥µå°æ³¨è©¦æ¢ï¼Œä¸è¿½å–®`,
                        shortReason: `è¨Šè™Ÿå¼±ï¼ˆ${maxSignal.toFixed(0)}%ï¼‰ï¼Œå®œè§€æœ›`,
                        bets: 0,
                        odds: 0,
                        priority: 0,
                        signalStrength: maxSignal,
                        riskLevel: 'observe',
                        stopCondition: 'è§€æœ›æ™‚ä¸ä¸‹æ³¨ï¼Œç­‰å¾…è¨Šè™Ÿ'
                    });
                }
            }
            
            // å„ªå…ˆç´šæ’åº
            suggestions.sort((a, b) => a.priority - b.priority);
            
            // è¶…éä¸Šé™è™•ç†
            let totalBets = suggestions.reduce((sum, s) => sum + s.bets, 0);
            while (totalBets > MAX_BETS && suggestions.length > 0) {
                const lowest = suggestions[suggestions.length - 1];
                if (lowest.bets > 1) {
                    lowest.bets--;
                    totalBets--;
                } else {
                    suggestions.pop();
                    totalBets -= 1;
                }
            }
            
            return suggestions;
        }

        // ============================================================
        // è³‡æ–™å­˜å–ï¼ˆD8ï¼šåªå­˜åŸºæœ¬è³‡æ–™ï¼Œè®€å–æ™‚é‡æ–°è¨ˆç®—ï¼‰
        // ============================================================
        
        function loadRecords() {
            const saved = localStorage.getItem('sicBoRecords_v3');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    // é‡æ–°è¨ˆç®—æ¯ç­†è¨˜éŒ„ï¼Œä¿ç•™ roundNo
                    records = data.map(r => recalculateRecord(r));
                    // æ›´æ–°è¨ˆæ•¸å™¨ç‚ºæœ€å¤§ roundNo
                    if (records.length > 0) {
                        recordNoCounter = Math.max(...records.map(r => r.roundNo || 0));
                    }
                } catch (e) {
                    console.error('è¼‰å…¥è³‡æ–™å¤±æ•—:', e);
                    records = [];
                }
            }
            
            // å˜—è©¦é·ç§» v2 è³‡æ–™
            const v2Saved = localStorage.getItem('sicBoRecords_v2');
            if (v2Saved && records.length === 0) {
                try {
                    const v2Data = JSON.parse(v2Saved);
                    // v2 æ²’æœ‰ roundNoï¼Œéœ€è¦ç”Ÿæˆï¼ˆå¾èˆŠåˆ°æ–°æ’åºå¾Œä¾åºåˆ†é…ï¼‰
                    const sortedData = [...v2Data].reverse(); // èˆŠçš„åœ¨å‰
                    records = sortedData.map((r, idx) => recalculateRecord({
                        round: r.round,
                        dice: r.dice,
                        timestamp: r.timestamp
                    }, idx + 1)).reverse(); // æ¢å¾©æ–°çš„åœ¨å‰
                    recordNoCounter = records.length > 0 ? Math.max(...records.map(r => r.roundNo)) : 0;
                    saveRecords();
                    localStorage.removeItem('sicBoRecords_v2');
                } catch (e) {
                    console.error('é·ç§»v2è³‡æ–™å¤±æ•—:', e);
                }
            }
            
            // å˜—è©¦é·ç§»èˆŠç‰ˆè³‡æ–™
            const oldSaved = localStorage.getItem('sicBoRecords');
            if (oldSaved && records.length === 0) {
                try {
                    const oldData = JSON.parse(oldSaved);
                    const sortedData = [...oldData].reverse();
                    records = sortedData.map((r, idx) => recalculateRecord({
                        round: r.round,
                        dice: r.dice,
                        timestamp: r.timestamp
                    }, idx + 1)).reverse();
                    recordNoCounter = records.length > 0 ? Math.max(...records.map(r => r.roundNo)) : 0;
                    saveRecords();
                    localStorage.removeItem('sicBoRecords');
                } catch (e) {
                    console.error('é·ç§»èˆŠè³‡æ–™å¤±æ•—:', e);
                }
            }
            
            updateDisplay();
        }

        function saveRecords() {
            // å­˜åŸºæœ¬è³‡æ–™ï¼ŒåŒ…å« roundNo
            const toSave = records.map(r => ({
                round: r.round,
                roundNo: r.roundNo,
                dice: r.dice,
                timestamp: r.timestamp
            }));
            localStorage.setItem('sicBoRecords_v3', JSON.stringify(toSave));
        }

        // ============================================================
        // è¼¸å…¥è™•ç†ï¼ˆE9ã€E10ï¼‰
        // ============================================================
        
        function addRecord() {
            let roundNum = document.getElementById('roundNum').value.trim();
            const d1 = parseInt(document.getElementById('dice1').value);
            const d2 = parseInt(document.getElementById('dice2').value);
            const d3 = parseInt(document.getElementById('dice3').value);

            // E9ï¼šæœŸæ•¸ç™½åå–®éæ¿¾
            roundNum = sanitizeRound(roundNum);
            
            if (!roundNum) {
                alert('è«‹è¼¸å…¥æœŸæ•¸ï¼ˆåƒ…å…è¨±è‹±æ•¸å­—ã€-ã€_ï¼‰');
                return;
            }

            if (isNaN(d1) || isNaN(d2) || isNaN(d3) ||
                d1 < 1 || d1 > 6 || d2 < 1 || d2 > 6 || d3 < 1 || d3 > 6) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„éª°å­é»æ•¸ (1-6)');
                return;
            }

            // E10ï¼šæª¢æŸ¥æœŸæ•¸é‡è¤‡
            const existing = records.find(r => r.round === roundNum);
            let useRoundNo;
            if (existing) {
                if (!confirm(`æœŸæ•¸ ${roundNum} å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†è“‹ï¼Ÿ`)) {
                    return;
                }
                // ä¿ç•™èˆŠçš„ roundNo
                useRoundNo = existing.roundNo;
                // ç§»é™¤èˆŠçš„
                records = records.filter(r => r.round !== roundNum);
            } else {
                // æ–°è¨˜éŒ„ï¼Œåˆ†é…æ–°çš„ roundNo
                useRoundNo = ++recordNoCounter;
            }

            const result = getResultType(d1, d2, d3);
            records.unshift({
                round: roundNum,
                roundNo: useRoundNo,
                dice: [d1, d2, d3],
                ...result,
                timestamp: Date.now()
            });

            if (records.length > MAX_RECORDS) {
                records = records.slice(0, MAX_RECORDS);
            }
            
            // æ›´æ–°ä¹‹å‰çš„å»ºè­°çµæœï¼ˆç”¨ roundNo åŒ¹é…ï¼‰
            updateSuggestionResult(useRoundNo, result.type);

            saveRecords();
            updateDisplay();

            const nextRound = autoIncrementRound(roundNum);
            document.getElementById('roundNum').value = nextRound;
            document.getElementById('dice1').value = '';
            document.getElementById('dice2').value = '';
            document.getElementById('dice3').value = '';
            document.getElementById('dice1').focus();
        }

        function autoIncrementRound(currentRound) {
            const match = currentRound.match(/^(.*?)(\d+)$/);
            if (match) {
                const prefix = match[1];
                const num = parseInt(match[2]);
                const padLength = match[2].length;
                return prefix + String(num + 1).padStart(padLength, '0');
            }
            return currentRound;
        }

        function deleteRecord(index) {
            records.splice(index, 1);
            saveRecords();
            updateDisplay();
        }

        function clearRecords() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è¨˜éŒ„å—ï¼Ÿ')) {
                records = [];
                saveRecords();
                updateDisplay();
            }
        }

        // ============================================================
        // åŒ¯å…¥åŒ¯å‡ºåŠŸèƒ½ï¼ˆF11ï¼‰
        // ============================================================
        
        function toggleImport() {
            const area = document.getElementById('importArea');
            area.style.display = area.style.display === 'none' ? 'block' : 'none';
        }

        function exportData() {
            if (records.length === 0) {
                alert('æ²’æœ‰è³‡æ–™å¯åŒ¯å‡º');
                return;
            }
            
            const lines = records.map(r => `${r.round} ${r.dice.join(' ')}`).reverse();
            const text = lines.join('\n');
            
            navigator.clipboard.writeText(text).then(() => {
                alert(`å·²è¤‡è£½ ${records.length} ç­†è³‡æ–™åˆ°å‰ªè²¼ç°¿ï¼\n\næ ¼å¼ï¼šæœŸæ•¸ éª°1 éª°2 éª°3`);
            }).catch(() => {
                // Fallback
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert(`å·²è¤‡è£½ ${records.length} ç­†è³‡æ–™ï¼`);
            });
        }

        function importData() {
            const text = document.getElementById('importText').value.trim();
            if (!text) {
                alert('è«‹è¼¸å…¥è¦åŒ¯å…¥çš„è³‡æ–™');
                return;
            }
            
            const lines = text.split('\n').filter(line => line.trim());
            const newRecords = [];
            const errors = [];
            
            lines.forEach((line, i) => {
                const parts = line.trim().split(/[\s,]+/);
                if (parts.length >= 4) {
                    const round = sanitizeRound(parts[0]);
                    const d1 = parseInt(parts[1]);
                    const d2 = parseInt(parts[2]);
                    const d3 = parseInt(parts[3]);
                    
                    if (round && !isNaN(d1) && !isNaN(d2) && !isNaN(d3) &&
                        d1 >= 1 && d1 <= 6 && d2 >= 1 && d2 <= 6 && d3 >= 1 && d3 <= 6) {
                        const result = getResultType(d1, d2, d3);
                        newRecords.push({
                            round,
                            dice: [d1, d2, d3],
                            ...result,
                            timestamp: Date.now() - (lines.length - i) * 1000
                        });
                    } else {
                        errors.push(`ç¬¬ ${i + 1} è¡Œæ ¼å¼éŒ¯èª¤`);
                    }
                } else {
                    errors.push(`ç¬¬ ${i + 1} è¡Œæ ¼å¼éŒ¯èª¤`);
                }
            });
            
            if (newRecords.length > 0) {
                // åˆä½µï¼šæ–°è³‡æ–™æ”¾å‰é¢ï¼Œå»é‡
                const existingRounds = new Set(records.map(r => r.round));
                const uniqueNew = newRecords.filter(r => !existingRounds.has(r.round));
                
                records = [...uniqueNew.reverse(), ...records].slice(0, MAX_RECORDS);
                saveRecords();
                updateDisplay();
                
                document.getElementById('importText').value = '';
                document.getElementById('importArea').style.display = 'none';
                
                let msg = `æˆåŠŸåŒ¯å…¥ ${uniqueNew.length} ç­†è³‡æ–™ï¼`;
                if (errors.length > 0) {
                    msg += `\n\nä»¥ä¸‹è¡Œæ•¸æœ‰éŒ¯èª¤ï¼š\n${errors.slice(0, 5).join('\n')}`;
                    if (errors.length > 5) msg += `\n...åŠå…¶ä»– ${errors.length - 5} è¡Œ`;
                }
                alert(msg);
            } else {
                alert('æ²’æœ‰æœ‰æ•ˆçš„è³‡æ–™å¯åŒ¯å…¥\n\n' + errors.slice(0, 5).join('\n'));
            }
        }

        // ============================================================
        // æ¸²æŸ“å‡½æ•¸ï¼ˆG13ï¼šåˆ†é›¢æ¸²æŸ“é‚è¼¯ï¼‰
        // ============================================================
        
        function getAnalysisWindow() {
            // çµ±ä¸€åˆ†æå…¨éƒ¨è¨˜éŒ„ï¼ˆå‰10æœŸæ¬Šé‡å·²åŠ é‡ï¼‰
            return 0;
        }

        function updateDisplay() {
            // çµ±ä¸€åˆ†æå…¨éƒ¨è¨˜éŒ„
            const metrics = computeMetrics(records, records.length);
            const signals = records.length >= 3 ? computeSignals(metrics) : null;
            
            renderCurrentResult();
            renderHistory();
            renderStats(metrics);
            renderTrends(metrics);
            renderRoadmap();
            renderBetSuggestion(signals, metrics);
        }

        function renderCurrentResult() {
            const container = document.getElementById('currentResult');
            if (records.length === 0) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'flex';
            const latest = records[0];

            document.getElementById('displayRound').textContent = escapeHtml(latest.round || '-');
            document.getElementById('display1').textContent = latest.dice[0];
            document.getElementById('display2').textContent = latest.dice[1];
            document.getElementById('display3').textContent = latest.dice[2];
            document.getElementById('displaySum').textContent = latest.sum;

            const typeEl = document.getElementById('resultType');
            typeEl.className = 'result-type';

            if (latest.type === 'triple') {
                typeEl.textContent = `è±¹å­ ${latest.tripleNumber}`;
                typeEl.classList.add('result-triple');
            } else if (latest.type === 'big') {
                typeEl.textContent = 'å¤§';
                typeEl.classList.add('result-big');
            } else {
                typeEl.textContent = 'å°';
                typeEl.classList.add('result-small');
            }
        }

        function renderHistory() {
            const tbody = document.getElementById('historyBody');
            tbody.innerHTML = records.map((r, i) => {
                let badge = '';
                if (r.type === 'triple') {
                    badge = `<span class="badge badge-triple">è±¹${r.tripleNumber}</span>`;
                } else if (r.type === 'big') {
                    badge = '<span class="badge badge-big">å¤§</span>';
                } else {
                    badge = '<span class="badge badge-small">å°</span>';
                }

                return `
                    <tr${i === 0 ? ' style="background: rgba(255, 215, 0, 0.1);"' : ''}>
                        <td style="color: #ffd700; font-weight: bold;">${escapeHtml(r.round || '-')}</td>
                        <td>${r.dice[0]}</td>
                        <td>${r.dice[1]}</td>
                        <td>${r.dice[2]}</td>
                        <td>${r.sum}</td>
                        <td>${badge}</td>
                        <td><button onclick="deleteRecord(${i})" style="background:none;border:none;color:#ff4757;cursor:pointer;font-size:1.1rem;">âœ•</button></td>
                    </tr>
                `;
            }).join('');

            document.getElementById('recordCount').textContent = `ç›®å‰ ${records.length} ç­†è¨˜éŒ„`;
        }

        function renderStats(metrics) {
            document.getElementById('bigCount').textContent = metrics.bigCount;
            document.getElementById('smallCount').textContent = metrics.smallCount;
            document.getElementById('tripleCount').textContent = metrics.tripleCount;

            const total = metrics.total;
            document.getElementById('bigPercent').textContent = total ? `${(metrics.bigCount / total * 100).toFixed(0)}%` : '0%';
            document.getElementById('smallPercent').textContent = total ? `${(metrics.smallCount / total * 100).toFixed(0)}%` : '0%';
            document.getElementById('triplePercent').textContent = total ? `${(metrics.tripleCount / total * 100).toFixed(0)}%` : '0%';

            document.getElementById('bigCountAll').textContent = `å…¨${metrics.allTotal}æœŸ: ${metrics.allBig}`;
            document.getElementById('smallCountAll').textContent = `å…¨${metrics.allTotal}æœŸ: ${metrics.allSmall}`;
            document.getElementById('tripleCountAll').textContent = `å…¨${metrics.allTotal}æœŸ: ${metrics.allTriple}`;

            // åˆ†æç¯„åœ
            if (records.length > 0) {
                const windowSize = getAnalysisWindow();
                const displayWindow = windowSize > 0 ? Math.min(windowSize, records.length) : records.length;
                document.getElementById('analysisRange').textContent = `(åˆ†æ ${displayWindow} æœŸ)`;
            } else {
                document.getElementById('analysisRange').textContent = '';
            }

            // è·¯å‹åˆ†æ
            const pattern = analyzePattern(records);
            renderPattern(pattern);

            // é€£çºŒè¶¨å‹¢èˆ‡é¾å‹¢
            const streak = metrics.currentStreak;
            const dragon = metrics.dragon;
            
            document.getElementById('currentStreak').textContent = streak.count || '-';
            document.getElementById('streakType').textContent = 
                streak.type === 'big' ? 'é€£å¤§' : 
                streak.type === 'small' ? 'é€£å°' : 
                streak.type === 'triple' ? '(è±¹å­)' : '-';
            
            // é¾å‹¢ç‹€æ…‹
            const dragonStatusEl = document.getElementById('dragonStatus');
            if (dragon && dragon.status !== 'none') {
                dragonStatusEl.textContent = getDragonStatusText(dragon);
                dragonStatusEl.style.color = getDragonStatusColor(dragon);
            } else {
                dragonStatusEl.textContent = '-';
                dragonStatusEl.style.color = '#888';
            }
            
            document.getElementById('maxBigStreak').textContent = metrics.maxStreaks.maxBig;
            document.getElementById('maxSmallStreak').textContent = metrics.maxStreaks.maxSmall;
        }
        
        // æ¸²æŸ“è·¯å‹åˆ†æ
        function renderPattern(pattern) {
            const typeEl = document.getElementById('patternType');
            const descEl = document.getElementById('patternDesc');
            const confEl = document.getElementById('patternConfidence');
            const predictEl = document.getElementById('patternPredict');
            
            if (!pattern || pattern.type === 'insufficient') {
                typeEl.textContent = 'ğŸ“Š';
                typeEl.style.color = '#888';
                descEl.textContent = 'éœ€è¦æ›´å¤šæ•¸æ“šï¼ˆè‡³å°‘4æœŸï¼‰';
                confEl.textContent = '-';
                predictEl.textContent = '-';
                predictEl.style.color = '#888';
                return;
            }
            
            // è·¯å‹é¡å‹èˆ‡é¡è‰²
            const typeConfig = {
                singleJump: { icon: 'ğŸ”€ å–®è·³', color: '#9b59b6' },
                doubleJump: { icon: 'ğŸ”„ é›™è·³', color: '#3498db' },
                dragon: { icon: 'ğŸ‰ é•·é¾', color: '#2ecc71' },
                random: { icon: 'ğŸ“Š äº‚è·¯', color: '#888' }
            };
            
            const config = typeConfig[pattern.type] || typeConfig.random;
            typeEl.textContent = config.icon;
            typeEl.style.color = config.color;
            descEl.textContent = pattern.description || '-';
            
            // ä¿¡å¿ƒåº¦
            if (pattern.confidence) {
                confEl.textContent = `${pattern.confidence.toFixed(0)}%`;
                confEl.style.color = pattern.confidence >= 70 ? '#2ecc71' : 
                                     pattern.confidence >= 50 ? '#f39c12' : '#888';
            } else {
                confEl.textContent = '-';
            }
            
            // é æ¸¬
            if (pattern.nextPredict) {
                predictEl.textContent = pattern.nextPredict === 'big' ? 'å¤§' : 'å°';
                predictEl.style.color = pattern.nextPredict === 'big' ? '#e74c3c' : '#3498db';
            } else if (pattern.currentType) {
                // é•·é¾æ™‚é¡¯ç¤ºç•¶å‰æ–¹å‘
                predictEl.textContent = `çºŒ${pattern.currentType === 'big' ? 'å¤§' : 'å°'}?`;
                predictEl.style.color = pattern.currentType === 'big' ? '#e74c3c' : '#3498db';
            } else {
                predictEl.textContent = '-';
                predictEl.style.color = '#888';
            }
        }

        function renderTrends(metrics) {
        }

        function renderRoadmap() {
            // è¨ˆç®—ç•¶å‰å„éª°å­çš„å†·æº«ç†±ç‹€æ…‹
            const diceAnalysis = analyzeIndividualDice(records, 0); // åˆ†æå…¨éƒ¨è¨˜éŒ„
            
            // å–å¾—é»æ•¸ç‹€æ…‹çš„å‡½æ•¸
            const getDiceStatus = (diceIndex, value) => {
                if (!diceAnalysis) return 'warm';
                const dice = diceIndex === 0 ? diceAnalysis.dice1 : 
                             diceIndex === 1 ? diceAnalysis.dice2 : diceAnalysis.dice3;
                if (dice.hot.includes(value)) return 'hot';
                if (dice.cold.includes(value)) return 'cold';
                return 'warm';
            };
            
            document.getElementById('roadmap').innerHTML = [...records].reverse().map(r => {
                let cls = 'roadmap-';
                let text = '';
                if (r.type === 'triple') {
                    cls += 'triple';
                    text = r.tripleNumber;
                } else if (r.type === 'big') {
                    cls += 'big';
                    text = 'å¤§';
                } else {
                    cls += 'small';
                    text = 'å°';
                }
                
                // ä¸‰é¡†éª°å­çš„å†·æº«ç†±ç‹€æ…‹
                const statusLabel = { hot: 'ç†±', warm: 'æº«', cold: 'å†·' };
                const diceDotsHtml = r.dice.map((d, i) => {
                    const status = getDiceStatus(i, d);
                    const label = statusLabel[status];
                    return `<div class="roadmap-dice-dot dice-${status}" title="éª°${i+1}=${d}ï¼ˆ${label}è™Ÿï¼‰">${d}</div>`;
                }).join('');
                
                const tooltip = `ç¬¬${escapeHtml(r.round || '?')}æœŸ: ${r.dice.join(',')}=${r.sum}`;
                return `
                    <div class="roadmap-cell">
                        <div class="roadmap-main ${cls}" title="${tooltip}">${text}</div>
                        <div class="roadmap-dice">${diceDotsHtml}</div>
                    </div>
                `;
            }).join('');
        }

        function renderBetSuggestion(signals, metrics) {
            const container = document.getElementById('betSuggestion');
            const nextRoundHint = document.getElementById('nextRoundHint');
            
            // æ¸²æŸ“å„éª°å­åˆ†æ
            renderIndividualDice(metrics);
            
            // æ¸²æŸ“å‹ç‡çµ±è¨ˆ
            renderWinRate(metrics);
            
            if (records.length > 0) {
                const latestRound = records[0].round || '?';
                const nextRound = autoIncrementRound(latestRound);
                nextRoundHint.textContent = `(åŸºæ–¼ç¬¬${escapeHtml(latestRound)}æœŸï¼Œå»ºè­°ç¬¬${escapeHtml(nextRound)}æœŸ)`;
            } else {
                nextRoundHint.textContent = '';
            }
            
            if (!signals) {
                container.innerHTML = '<p style="text-align: center; color: #888;">è«‹å…ˆè¼¸å…¥è‡³å°‘3ç­†é–‹çè¨˜éŒ„</p>';
                document.getElementById('confidenceFill').style.width = '0%';
                document.getElementById('confidenceText').textContent = '0%';
                return;
            }

            const { confidence, reasons } = computeConfidence(signals);
            const suggestions = generateSuggestions(signals); // çµ±ä¸€ç­–ç•¥ï¼Œä¸å†å‚³ strategy
            
            // è¨˜éŒ„æœ¬æ¬¡å»ºè­°ï¼ˆä¾›ä¸‹æœŸé©—è­‰ï¼Œä½¿ç”¨æ•¸å€¼ roundNoï¼‰
            if (suggestions.length > 0 && records.length > 0) {
                // ä¸‹ä¸€æœŸçš„ roundNo = ç•¶å‰æœ€å¤§ roundNo + 1
                const nextRoundNo = recordNoCounter + 1;
                recordSuggestion(nextRoundNo, suggestions);
            }
            
            let html = '';
            let totalBets = 0;

            suggestions.forEach(s => {
                totalBets += s.bets;
                
                // ä½¿ç”¨çµæ§‹åŒ–é¢¨éšªç­‰ç´š
                const riskInfo = RISK_LEVELS[s.riskLevel] || RISK_LEVELS.medium;
                const signalStrength = s.signalStrength || 0;
                const signalColor = signalStrength >= 60 ? '#2ecc71' : signalStrength >= 45 ? '#f39c12' : '#888';
                
                // è™•ç†å¤šè¡Œç†ç”±
                const reasonLines = (s.reason || '').split('\n');
                const mainReason = reasonLines[0];
                const detailReasons = reasonLines.slice(1);
                
                // è§€æœ›é¡å‹ç‰¹æ®Šè™•ç†
                const isObserve = s.betTarget === BET_TARGET.OBSERVE;
                const isHighRisk = s.riskLevel === 'high';
                const isEntertainment = s.riskLevel === 'entertainment';
                
                // å»ºç«‹çµæ§‹åŒ–åŸå› åˆ—è¡¨
                let structuredReasonHtml = '';
                if (detailReasons.length > 0) {
                    structuredReasonHtml = `
                        <div style="margin-top: 12px; padding: 12px; background: rgba(0,0,0,0.25); border-radius: 8px; border-left: 3px solid ${riskInfo.color};">
                            <div style="font-size: 0.8125rem; color: #999; margin-bottom: 8px; font-weight: bold;">ğŸ“‹ å»ºè­°ä¾æ“šï¼š</div>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.875rem; color: #ccc; line-height: 1.6;">
                                ${detailReasons.map(r => `<li style="margin: 5px 0;">${r.replace(/^[â€¢\-ğŸ“Šâœ“âš ï¸ğŸ‰ğŸ“ˆğŸ”€ğŸ”„âš”ï¸ğŸ’¡ğŸ²ğŸ“‹ğŸ›¡ï¸ğŸ¯]+\s*/, '')}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
                
                // é«˜é¢¨éšªè­¦å‘Šæ¡†
                const highRiskWarningHtml = isHighRisk ? `
                    <div style="margin-top: 10px; padding: 12px; background: linear-gradient(135deg, rgba(231, 76, 60, 0.25), rgba(192, 57, 43, 0.2)); border: 1px solid rgba(231, 76, 60, 0.5); border-radius: 8px;">
                        <strong style="color: #e74c3c; font-size: 0.9375rem;">ğŸ”´ é«˜é¢¨éšªè­¦å‘Š</strong>
                        <p style="color: #f5b7b1; font-size: 0.8125rem; margin: 6px 0 0 0; line-height: 1.5;">
                            æ­¤ç‚ºé€†å‹¢æ“ä½œã€‚<strong>æ¯å±€çµæœç¨ç«‹</strong>ï¼Œé•·é¾ä¸ä»£è¡¨ã€Œè©²æ–·äº†ã€ã€‚<br>
                            å»ºè­°æœ€å°æ³¨è©¦æ¢ï¼Œ<strong style="color: #e74c3c;">åš´ç¦è¿½åŠ æˆ–å€æŠ•</strong>ã€‚
                        </p>
                    </div>
                ` : '';
                
                html += `
                    <div class="bet-item" style="flex-direction: column; align-items: stretch; ${isObserve ? 'border-left: 3px solid #f39c12;' : isHighRisk ? 'border-left: 3px solid #e74c3c;' : ''}">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; width: 100%;">
                            <div style="flex: 1;">
                                <div class="bet-type" style="display: flex; flex-wrap: wrap; align-items: center; gap: 8px;">
                                    <span style="font-size: 1.125rem;">${escapeHtml(s.type)}</span>
                                    <span style="font-size: 0.8125rem; padding: 4px 10px; border-radius: 5px; background: ${riskInfo.color}22; color: ${riskInfo.color}; border: 1px solid ${riskInfo.color}44; font-weight: bold;">
                                        ${riskInfo.icon} ${riskInfo.label}
                                    </span>
                                    ${!isObserve && !isEntertainment ? `
                                        <span style="font-size: 0.8125rem; padding: 4px 10px; border-radius: 5px; background: ${signalColor}22; color: ${signalColor};" title="è¨Šè™Ÿç¬¦åˆåº¦ï¼ˆéé æ¸¬å‘½ä¸­ç‡ï¼‰">
                                            ç¬¦åˆåº¦ ${signalStrength?.toFixed(0) || '-'}%
                                        </span>
                                    ` : ''}
                                </div>
                                <div class="bet-odds" style="font-weight: bold; margin-top: 10px; color: #ddd; font-size: 1rem;">${escapeHtml(mainReason)}</div>
                            </div>
                            ${!isObserve ? `<div style="text-align: right; min-width: 110px;">
                                <div class="bet-amount" style="font-size: 1.25rem; font-weight: bold;">${s.bets}æ³¨</div>
                                <div style="color: #888; font-size: 0.875rem;">$${(s.bets * BET_UNIT).toLocaleString()}</div>
                                <div style="color: #666; font-size: 0.8125rem;">è³ ç‡ 1:${s.odds}</div>
                            </div>` : ''}
                        </div>
                        
                        <!-- é¢¨éšªèªªæ˜ -->
                        <div style="margin-top: 8px; font-size: 0.8125rem; color: ${riskInfo.color};">
                            ${riskInfo.icon} ${riskInfo.description}
                        </div>
                        
                        ${highRiskWarningHtml}
                        ${structuredReasonHtml}
                        ${s.stopCondition ? `<div style="color: #e74c3c; font-size: 0.8125rem; margin-top: 10px; padding: 10px; background: rgba(231,76,60,0.1); border-radius: 6px;">${escapeHtml(s.stopCondition)}</div>` : ''}
                        ${s.warning && !isHighRisk ? `<div style="color: #f39c12; font-size: 0.8125rem; margin-top: 8px; padding: 8px; background: rgba(243,156,18,0.1); border-radius: 5px;">âš ï¸ ${escapeHtml(s.warning)}</div>` : ''}
                        ${s.betAdvice ? `<div style="color: #3498db; font-size: 0.8125rem; margin-top: 6px;">ğŸ’¡ ${escapeHtml(s.betAdvice)}</div>` : ''}
                    </div>
                `;
            });

            if (suggestions.length === 0) {
                html = '<p style="text-align: center; color: #888;">æ•¸æ“šä¸è¶³ï¼Œè«‹ç¹¼çºŒè¼¸å…¥é–‹çè¨˜éŒ„</p>';
            } else {
                html += `
                    <div class="total-bet">
                        <span>ç¸½æŠ•æ³¨</span>
                        <span class="amount">${totalBets}æ³¨ ($${(totalBets * BET_UNIT).toLocaleString()})</span>
                    </div>
                `;
            }

            container.innerHTML = html;

            // æ›´æ–°è¨Šè™Ÿå¼·åº¦æŒ‡æ¨™ï¼ˆåŸä¿¡å¿ƒæŒ‡æ•¸ï¼‰
            // æ’é™¤è§€æœ›å’Œå¨›æ¨‚å»ºè­°
            const validSuggestions = suggestions.filter(s => 
                s.betTarget !== BET_TARGET.OBSERVE && !s.isEntertainmentOnly);
            const avgSignalStrength = validSuggestions.length > 0 
                ? validSuggestions.reduce((sum, s) => sum + (s.signalStrength || 40), 0) / validSuggestions.length 
                : confidence;
            const fillEl = document.getElementById('confidenceFill');
            fillEl.style.width = `${avgSignalStrength}%`;
            fillEl.className = 'meter-fill ' + 
                (avgSignalStrength < 40 ? 'meter-low' : avgSignalStrength < 60 ? 'meter-medium' : 'meter-high');
            document.getElementById('confidenceText').textContent = `${avgSignalStrength.toFixed(0)}%`;
        }
        
        // æ¸²æŸ“å„éª°å­ç¨ç«‹åˆ†æï¼ˆè©³ç´°é¡¯ç¤ºæ¯å€‹é»æ•¸çš„å‡ºç¾æ¬¡æ•¸èˆ‡å†·æº«ç†±ï¼‰
        function renderIndividualDice(metrics) {
            const container = document.getElementById('individualDiceAnalysis');
            const tripleContainer = document.getElementById('tripleOpportunity');
            
            if (!metrics || !metrics.diceAnalysis) {
                container.innerHTML = '<p style="color: #888; text-align: center;">éœ€è¦è‡³å°‘5ç­†è¨˜éŒ„</p>';
                tripleContainer.style.display = 'none';
                return;
            }
            
            const { dice1, dice2, dice3, totalPeriods } = metrics.diceAnalysis;
            
            // æ¸²æŸ“å–®é¡†éª°å­çš„è©³ç´°çµ±è¨ˆ
            const renderDiceDetail = (dice, index) => {
                let numbersHtml = '';
                for (let n = 1; n <= 6; n++) {
                    const count = dice.counts[n - 1];
                    let status, statusColor, statusBg;
                    
                    if (dice.hot.includes(n)) {
                        status = 'ç†±';
                        statusColor = '#fff';
                        statusBg = '#e74c3c';
                    } else if (dice.cold.includes(n)) {
                        status = 'å†·';
                        statusColor = '#fff';
                        statusBg = '#3498db';
                    } else {
                        status = 'æº«';
                        statusColor = '#333';
                        statusBg = '#f39c12';
                    }
                    
                    numbersHtml += `
                        <div style="flex: 1; min-width: 45px; padding: 8px 4px; background: rgba(0,0,0,0.3); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: bold; color: #fff;">${n}</div>
                            <div style="font-size: 0.85rem; color: #aaa; margin: 4px 0;">${count}æ¬¡</div>
                            <div style="display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; background: ${statusBg}; color: ${statusColor};">${status}</div>
                        </div>
                    `;
                }
                
                return `
                    <div style="margin-bottom: 15px; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <div style="font-weight: bold; color: #ffd700; margin-bottom: 10px; font-size: 1rem;">ğŸ² éª°å­${index}</div>
                        <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                            ${numbersHtml}
                        </div>
                    </div>
                `;
            };
            
            container.innerHTML = `
                <div style="font-size: 0.85rem; color: #888; margin-bottom: 10px;">çµ±è¨ˆæœŸæ•¸ï¼š${totalPeriods}æœŸï¼ˆå‰10æœŸæ¬Šé‡Ã—2ï¼‰</div>
                ${renderDiceDetail(dice1, 1)}
                ${renderDiceDetail(dice2, 2)}
                ${renderDiceDetail(dice3, 3)}
            `;
            
            // è±¹å­æ©Ÿæœƒæç¤ºï¼ˆæ”¯æ´å†·/æº«/ç†±è™Ÿï¼‰
            const tripleOpp = metrics.tripleOpportunity;
            if (tripleOpp && tripleOpp.hasOpportunity) {
                // æ ¹æ“šé¡å‹é¸æ“‡é¡è‰²
                let bgColor, borderColor, emoji;
                if (tripleOpp.type === 'hot') {
                    bgColor = 'rgba(231, 76, 60, 0.2)';
                    borderColor = '#e74c3c';
                    emoji = 'ğŸ”¥';
                } else if (tripleOpp.type === 'cold') {
                    bgColor = 'rgba(52, 152, 219, 0.2)';
                    borderColor = '#3498db';
                    emoji = 'â„ï¸';
                } else {
                    bgColor = 'rgba(243, 156, 18, 0.2)';
                    borderColor = '#f39c12';
                    emoji = 'ğŸŒ¡ï¸';
                }
                
                // æ ¹æ“šç­‰ç´šèª¿æ•´é€æ˜åº¦
                if (tripleOpp.level === 'medium') {
                    bgColor = bgColor.replace('0.2', '0.15');
                } else if (tripleOpp.level === 'low') {
                    bgColor = bgColor.replace('0.2', '0.1');
                }
                
                tripleContainer.style.display = 'block';
                tripleContainer.innerHTML = `
                    <div style="padding: 12px; background: ${bgColor}; border-left: 3px solid ${borderColor}; border-radius: 8px;">
                        <strong style="color: ${borderColor};">${emoji} è±¹å­å¨›æ¨‚åƒè€ƒï¼š${tripleOpp.reason}</strong>
                        <div style="font-size: 0.85rem; color: #888; margin-top: 5px;">
                            å»ºè­°è™Ÿç¢¼ï¼š${tripleOpp.numbers.join(', ')} | å·²${metrics.tripleGap}æœŸæœªå‡ºè±¹å­
                        </div>
                        <div style="font-size: 0.8rem; color: #666; margin-top: 8px; padding: 6px; background: rgba(0,0,0,0.2); border-radius: 4px;">
                            âš ï¸ ç´”å¨›æ¨‚åƒè€ƒï¼šè±¹å­æ©Ÿç‡å›ºå®š2.78%ï¼Œæ­·å²æ•¸æ“šä¸å½±éŸ¿æœªä¾†æ©Ÿç‡
                        </div>
                    </div>
                `;
            } else {
                tripleContainer.style.display = 'none';
            }
        }
        
        // æ¸²æŸ“å‹ç‡çµ±è¨ˆèˆ‡ç­–ç•¥è¡¨ç¾
        function renderWinRate(metrics) {
            const stats = metrics?.winRateStats || { total: 0, wins: 0, rate: 0, recentRate: 0, adjustment: 0 };
            
            const totalEl = document.getElementById('totalWinRate');
            const recentEl = document.getElementById('recentWinRate');
            const adjustEl = document.getElementById('strategyAdjustment');
            
            if (stats.total >= 3) {
                const rateColor = stats.rate >= 55 ? '#2ecc71' : stats.rate >= 45 ? '#f39c12' : '#e74c3c';
                totalEl.innerHTML = `<span style="color: ${rateColor}">${stats.rate.toFixed(1)}%</span> <span style="font-size: 0.8rem; color: #888;">(${stats.wins}/${stats.total})</span>`;
                
                if (stats.recentTotal >= 3) {
                    const recentColor = stats.recentRate >= 55 ? '#2ecc71' : stats.recentRate >= 45 ? '#f39c12' : '#e74c3c';
                    recentEl.innerHTML = `<span style="color: ${recentColor}">${stats.recentRate.toFixed(1)}%</span> <span style="font-size: 0.8rem; color: #888;">(${stats.recentWins}/${stats.recentTotal})</span>`;
                } else {
                    recentEl.textContent = 'ç´¯ç©ä¸­...';
                }
                
                // æ¸²æŸ“ç­–ç•¥è‡ªé©æ‡‰ç‹€æ…‹
                renderStrategyPerformance(adjustEl);
            } else {
                totalEl.textContent = '-';
                recentEl.textContent = '-';
                adjustEl.textContent = 'ç´¯ç©æ•¸æ“šä¸­...';
            }
        }
        
        // æ¸²æŸ“å„ç­–ç•¥è¡¨ç¾
        function renderStrategyPerformance(containerEl) {
            const perf = calculateStrategyPerformance();
            
            // è¨ˆç®—ç¸½æ¨£æœ¬æ•¸
            const totalSamples = Object.values(perf).reduce((sum, p) => sum + p.total, 0);
            
            // æ‰¾å‡ºè¡¨ç¾æœ€å¥½å’Œæœ€å·®çš„ç­–ç•¥ï¼ˆéœ€é”æœ€å°æ¨£æœ¬æ•¸ï¼‰
            const strategies = [
                { key: STRATEGY_TYPES.SINGLE_JUMP, name: 'å–®è·³', perf: perf[STRATEGY_TYPES.SINGLE_JUMP] },
                { key: STRATEGY_TYPES.DOUBLE_JUMP, name: 'é›™è·³', perf: perf[STRATEGY_TYPES.DOUBLE_JUMP] },
                { key: STRATEGY_TYPES.RIDE_DRAGON, name: 'è·Ÿé¾', perf: perf[STRATEGY_TYPES.RIDE_DRAGON] },
                { key: STRATEGY_TYPES.BREAK_DRAGON, name: 'æ–·é¾', perf: perf[STRATEGY_TYPES.BREAK_DRAGON] },
                { key: STRATEGY_TYPES.RETURN_DRAGON, name: 'å›é¾', perf: perf[STRATEGY_TYPES.RETURN_DRAGON] },
                { key: STRATEGY_TYPES.REGRESSION, name: 'å›æ­¸', perf: perf[STRATEGY_TYPES.REGRESSION] }
            ];
            
            // åˆ†é¡ï¼šé”åˆ°æœ€å°æ¨£æœ¬æ•¸çš„ç­–ç•¥ vs å°šæœªé”åˆ°çš„
            const qualified = strategies.filter(s => s.perf.total >= MIN_SAMPLE_FOR_ADJUSTMENT);
            const pending = strategies.filter(s => s.perf.total > 0 && s.perf.total < MIN_SAMPLE_FOR_ADJUSTMENT);
            
            let html = '';
            
            if (qualified.length === 0) {
                // å°šç„¡ç­–ç•¥é”åˆ°æœ€å°æ¨£æœ¬æ•¸
                const maxPending = pending.length > 0 
                    ? Math.max(...pending.map(s => s.perf.total)) 
                    : 0;
                html = `<span style="color: #f39c12;">â³ æ•¸æ“šç´¯ç©ä¸­ï¼ˆ${maxPending}/${MIN_SAMPLE_FOR_ADJUSTMENT}æœŸï¼‰</span>`;
            } else {
                // æœ‰ç­–ç•¥é”åˆ°æœ€å°æ¨£æœ¬æ•¸ï¼Œé¡¯ç¤ºè¡¨ç¾
                qualified.sort((a, b) => b.perf.rate - a.perf.rate);
                
                const best = qualified[0];
                const worst = qualified[qualified.length - 1];
                
                if (best.perf.rate >= 55) {
                    html += `<span style="color: #2ecc71;">ğŸ”¥ ${best.name}${best.perf.rate.toFixed(0)}%</span>`;
                }
                if (worst.perf.rate < 45 && worst !== best) {
                    html += html ? ' ' : '';
                    html += `<span style="color: #e74c3c;">â„ï¸ ${worst.name}${worst.perf.rate.toFixed(0)}%</span>`;
                }
                if (!html) {
                    html = `<span style="color: #888;">âš–ï¸ å„ç­–ç•¥å‡è¡¡</span>`;
                }
                
                // é¡¯ç¤ºå¾…è©•ä¼°ç­–ç•¥æ•¸é‡
                if (pending.length > 0) {
                    html += `<span style="color: #888; font-size: 0.8em;"> +${pending.length}å¾…è©•ä¼°</span>`;
                }
            }
            
            containerEl.innerHTML = html;
        }

        // ============================================================
        // UI äº’å‹•
        // ============================================================

        function toggleConfidenceDetail() {
            const detailEl = document.getElementById('confidenceDetail');
            detailEl.style.display = detailEl.style.display === 'none' ? 'block' : 'none';
        }
        
        function toggleDiceDetail() {
            const detailEl = document.getElementById('diceAnalysisDetail');
            detailEl.style.display = detailEl.style.display === 'none' ? 'block' : 'none';
        }
        
        function toggleStrategyDetail() {
            const detailEl = document.getElementById('strategyDetail');
            detailEl.style.display = detailEl.style.display === 'none' ? 'block' : 'none';
        }

        // Enter éµå¿«é€Ÿè¼¸å…¥
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const active = document.activeElement;
                if (active.id === 'roundNum') document.getElementById('dice1').focus();
                else if (active.id === 'dice1') document.getElementById('dice2').focus();
                else if (active.id === 'dice2') document.getElementById('dice3').focus();
                else if (active.id === 'dice3') addRecord();
            }
        });

        // éª°å­è¼¸å…¥è‡ªå‹•è·³ä¸‹ä¸€æ ¼
        function setupAutoJump() {
            ['dice1', 'dice2', 'dice3'].forEach((id, i) => {
                document.getElementById(id).addEventListener('input', (e) => {
                    const val = e.target.value;
                    if (val >= 1 && val <= 6) {
                        if (i < 2) {
                            const next = document.getElementById(['dice1', 'dice2', 'dice3'][i + 1]);
                            next.focus();
                            next.select();
                        } else {
                            setTimeout(() => addRecord(), 100);
                        }
                    }
                });
            });
        }

        // ============================================================
        // åˆå§‹åŒ–
        // ============================================================
        loadRecords();
        loadSuggestionHistory();
        setupAutoJump();
        updateDisplay();
    </script>
    
    <!-- å›ºå®šåº•éƒ¨è² æœŸæœ›å€¼è²æ˜ -->
    <footer style="
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(180deg, rgba(26,26,26,0.97) 0%, rgba(20,20,20,1) 100%);
        border-top: 2px solid rgba(231, 76, 60, 0.5);
        padding: 12px 20px;
        font-size: 0.8125rem;
        color: #aaa;
        text-align: center;
        z-index: 1000;
        backdrop-filter: blur(10px);
    ">
        <div style="max-width: 1200px; margin: 0 auto; line-height: 1.5;">
            <strong style="color: #e74c3c;">âš ï¸ è² æœŸæœ›å€¼éŠæˆ²ï¼š</strong>
            <span>éª°å¯¶æ¯å±€çµæœç¨ç«‹ï¼Œæ‰€æœ‰æŠ•æ³¨é¸é …<strong style="color: #e74c3c;">é•·æœŸå¿…è¼¸</strong>ã€‚èŠå®¶å„ªå‹¢ï¼šå¤§å° 2.78% | è±¹å­ 13.89%~16.67%ã€‚æœ¬å·¥å…·åƒ…ä¾›å¨›æ¨‚åƒè€ƒã€‚</span>
        </div>
    </footer>
    
    <!-- ç‚ºåº•éƒ¨ç•™ç©ºé–“ -->
    <div style="height: 60px;"></div>
</body>
</html>
